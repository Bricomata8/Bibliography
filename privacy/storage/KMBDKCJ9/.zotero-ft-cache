Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

Journal of Complex Networks (2015) 3, 584–605 doi:10.1093/comnet/cnv006 Advance Access publication on 31 March 2015
Role of subgraphs in epidemics over ﬁnite-size networks under the scaled SIS process
June Zhang∗ and José M. F. Moura† Electrical and Computer Engineering Department, Carnegie Mellon University, USA
Corresponding author. Email: junez@andrew.cmu.edu
Edited by: Matt Keeling
[Received on 9 October 2014; accepted on 27 January 2015]
In previous work, we developed the scaled SIS process, which models the dynamics of SIS epidemics over networks. We derived for the scaled SIS process a closed-form expression for the time-asymptotic probability distribution of the conﬁgurations of all the agents in the network, which explicitly exhibits the underlying network topology through its adjacency matrix. This is accomplished for networks that are of ﬁnite-size and of arbitrary topology. This paper determines which network conﬁguration is the most probable. We prove that, for a range of epidemic parameters, this combinatorial inference problem leads to a submodular optimization problem, which can be solved in polynomial time. We relate the most-probable conﬁguration to the network structure, and in particular to the existence of high-density subgraphs. Depending on the model parameters, subset of agents may be more likely to be infected than others; these more vulnerable agents form subgraphs that are denser than the overall network. We illustrate our results with a 193 node social network of drug users and with the 4941 node Western US power grid under different model parameters.
Keywords: SIS epidemics; network processes; dense subgraphs; submodular optimization; most-probable conﬁguration; network topology; graph density.
1. Introduction
A network is a graph; it is a collection of nodes connected by edges. Networks have been used in science and engineering to represent systems of multiple interconnected, interdependent components. As a result, the network structure has a large impact on the behaviour of the system. Quantifying how network structure impacts network function, that is, the behaviour of dynamical processes over networks, is a difﬁcult problem since the system components do not behave independently.
In this paper, we focus on analysing the behaviour of network processes that are like epidemics. Analytical results for epidemics over networks have been obtained under particular conditions: full-mixing models (i.e. the underlying network is a complete graph); inﬁnite-size network models using mean-ﬁeld approximation; or for scaled-free networks [1–6]. These approaches approximate the underlying network topology with mathematically simpler structures, because accounting for the exact graph topology is a combinatorial problem that is difﬁcult to analyse and computationally expensive
†José M.F. Moura was a visiting professor with New York University and the Center for Urban Science and Policy (CUSP) in 2013–2014; E-mail: moura@andrew.cmu.edu
c The authors 2015. Published by Oxford University Press. All rights reserved.

ROLE OF SUBGRAPHS IN EPIDEMICS OVER FINITE-SIZE NETWORKS

585

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

to compute. In previous work, we proposed a dynamic network epidemics model over any arbitrary, ﬁnite-size network with N agents [7,8]. We call this the scaled SIS (susceptible-infected-susceptible) process. For this process, it is possible to characterize its time-asymptotic behavior (i.e., equilibrium distribution) without having to approximate the network structure.
The scaled SIS process is Markov. It accounts for (1) exogenous (i.e. spontaneous) infection at rate λ; (2) endogenous (i.e. neighbour dependent) infection at rate β; and (3) healing at rate μ. The time-asymptotic behaviour of the process is described by its equilibrium distribution, which is a PMF (probability mass function) over 2N possible network conﬁgurations. Our approach preserves the full microscopic states of all the agents in contrast to previous approaches that only provide results for aggregate or macroscopic states (e.g. fraction of infected agents) [9]. However, retaining the exact network conﬁguration means that the computational complexity of solving for the equilibrium distribution, an eigenvalue–eigenvector problem, scales exponentially with the size of the network, N.
We have shown that, under speciﬁc assumptions on the form of the endogenous infection, the scaled SIS process is a reversible Markov process for which we can ﬁnd its equilibrium distribution in closed form, avoiding solving a large eigenvalue–eigenvector problem. Further, the equilibrium distribution that we derived exhibits explicitly the underlying network structure through the network adjacency matrix. The equilibrium distribution is parametrized by two parameters: (λ/μ, β). Parameter λ/μ controls the exogenous, or the topology-independent behaviour of the scaled SIS process, whereas parameter β controls the endogenous or the topology-dependent behaviour of the process.
We used the equilibrium distribution to address the question of which 2N possible conﬁgurations is the most likely to occur in the long run. We refer to this as the most-probable conﬁguration, which is found by maximizing the equilibrium distribution. This inference problem (called the MostProbable Conﬁguration Problem) is difﬁcult because: (1) it is combinatorial; (2) it depends on the healing/infection parameters of the scaled SIS process; and (3) it depends on the underlying network topology. Previously in Zhang & Moura [7], we partitioned the space of (λ/μ, β) values into four regimes and were able to ﬁnd the most-probable conﬁguration in Regime II Endogenous Infection Dominant, for which 0 < λ/μ 1, β > 1, for only speciﬁc types of networks: k-regular, complete multipartite and complete multipartite with k-regular islands. We showed for these speciﬁc networks that the mostprobable conﬁguration solution space exhibits phase transition behaviour, depending on the network structure and epidemic parameters.
This paper considers the Most-Probable Conﬁguration Problem in Regime II Endogenous Infection Dominant for arbitrary networks. We are able to prove that this leads to the minimization of a submodular function, which can be solved in polynomial time. Further, we show the connection between the most-probable conﬁguration and subgraphs in the network that are more vulnerable to epidemics. These are relevant questions in different applications. For example, these are the clusters to focus on in marketing campaigns or when combating epidemics.
We review the scaled SIS process in Section 2 and set up the Most-Probable Conﬁguration Problem in Section 3. In Section 4, we show that, in Regime II, the Most-Probable Conﬁguration Problem can be transformed into an equivalent submodular problem, and that it is possible to solve for its exact solution in polynomial time. We apply this to solve the most-probable conﬁguration for two example networks: the 193 node acquaintance network of drug users in Hartford, CT [10] and the 4941 node network of the Western US power grid [11]. Section 5 shows how the solution space of the Most-Probable Conﬁguration Problem in Regime II relates to the density of subgraphs in the network. Section 6 concludes the paper.

586

J. ZHANG AND J. M. F. MOURA

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

2. Scaled SIS process
Consider a population of N agents whose interconnections are represented by a static, simple, unweighted, undirected, connected graph, G(V , E), where V (G) is the set of vertices and E(G) is the set of edges. For background on graphs, see West et al. [12]. The topology of G is captured by the symmetric N × N adjacency matrix, A. The state of the ith agent is denoted by xi. Agents can be in one of two states: susceptible (xi = 0) or infected (xi = 1). Let
x = [x1, x2, . . . , xN ] .
We will refer to xi as the agent state and x as either the network state or the conﬁguration. The conﬁguration state space is X = {x}, with cardinality |X | = 2N .
The scaled SIS process models the evolution of the network state, x, over time according to the stochastic microscopic interaction rules of the SIS epidemics. The SIS framework assumes that infected agents can heal and become reinfected so it does not account for immunization [4,13]. Let X (t) = x be the state of the network at time t, t 0. The scaled SIS process accounts for (1) exogenous infection (i.e. susceptibles spontaneously develop infection); (2) endogenous infection (i.e. susceptibles become infected due to infection from infective neighbours); and (3) healing events. Infection and healing processes are independent and can not occur simultaneously. We also assume that only one agent in the network can heal or become infected at any given time instant. By including both exogenous infection and healing, the scaled SIS process does not have an absorbing state at equilibrium.
The scaled SIS process is Markov; each conﬁguration is a state of the Markov process. On the conﬁguration, x = [x1, x2, . . . , xi, . . . , xj, . . . , xN ] , we deﬁne two operators. We use the following notation [16]:

Hix = [x1, x2, . . . , xi = 1, . . . , xN ] , Hj•x = [x1, x2, . . . , xj = 0, . . . , xN ] .

The operator Hi deﬁnes the operation that agent i becomes infected. If agent i is already infected, the operator does nothing. The operator Hj• deﬁnes the operation that agent j is healed. If agent j is already uninfected, the operator does nothing.
The time the process spends in a particular state is random and exponentially distributed, with the following transition rates corresponding to infection and healing events, respectively:

(1) X (t) transitions to the conﬁguration where the ith agent, which was healthy, becomes infected with transition rate

q(x, Hix) = λβdi , x =| Hix,

(1)

where di =

N j=1

1(xj

=

1)Aij

is

the

number

of

infected

neighbours

of

node

i.

The

symbol

1(·)

is the indicator function, and A = [Aij] is the adjacency matrix of the arbitrary network G that

captures the interactions among the agents. There are two components to the infection rate. If the

ith agent has no infected neighbours, di = 0, then the transition rate reduces to λ > 0. We interpret λ as the exogenous infection rate, the rate a susceptible agent spontaneously becomes infected;

it is the same for all the agents in the network. If the ith agent has di infected neighbours, the infective rate is λβdi ; it is the product of λ and the endogenous infection rate, β > 0, scaled by di,

ROLE OF SUBGRAPHS IN EPIDEMICS OVER FINITE-SIZE NETWORKS

587

the number of infected neighbours of agent i. Because of this factor, the infective rate depends on the network topology.

(2) X (t) transitions to the conﬁguration where the jth agent, which was infected, heals with transition rate:

q(x, Hj•x) = μ, x =| Hj•x.

(2)

The healing rate, μ > 0, is the same for all the agents in the system.

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

2.1 Scaled SIS process vs. contact process
We note the main differences between the scaled SIS process and the basic contact process [15], which has been used to study SIS epidemics on networks [17,18]. First, the dynamics of the basic contact process do not consider exogenous infection. Therefore, the conﬁguration where all the agents are healthy is an absorbing state of the Markov process; in this case, the equilibrium distribution is trivial. Secondly, and more importantly, the form of the infection rate of the scaled SIS process differs from the basic contact process. Using our notation and including exogenous infection, the infection rate of the basic contact process is
q(x, Hix) = λ + diβ, x =| Hix.
In contrast to the infection rate of the scaled SIS process (see Equation (1)), the endogenous infection rate of agent i is linearly dependent on the number of infected neighbours, di, in the basic contact process instead of multiplicative as in the scaled SIS process. As we pointed out in Zhang & Moura [7], one advantage of the scaled SIS process is its tractability. We show in a forthcoming paper the relationship between the infection and healing rates of the scaled SIS process and the basic contact process with exogenous infection.

2.2 Equilibrium distribution
The evolution of the scaled SIS process is captured by the rate (inﬁnitesimal) matrix Q of the Markov process X (t). The assumption that the underlying network G is connected assures that the Markov process is irreducible. Therefore, the equilibrium distribution, π(x), exists and is given by the left eigenvector corresponding to the 0 eigenvalue of Q [14]. The problem in determining the equilibrium distribution π(x) is that its computation is prohibitively expensive for meaningful size networks since Q is a 2N × 2N matrix. This has limited the analysis of epidemics and spreading processes on networks to either: (1) full-mixing models (e.g. where every agent comes in contact with every other agent—the network is a complete graph); (2) small scale simulations, where N is small so that O((2N )3) operations are feasible; or (3) to mean-ﬁeld type approximations of special network conﬁgurations.
We proved in Zhang & Moura [8], see also Zhang & Moura [7], that the scaled SIS process is a reversible Markov process by showing that its equilibrium distribution satisﬁes not only the global balance equation but also the detailed balance equation. For reversible Markov processes, the equilibrium distribution is unique [16]. We derived the equilibrium distribution of the scaled SIS process to be

π(x) = 1

λ

1x
βx Ax/2,

x, ∈ X ,

(3)

Zμ

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

588

J. ZHANG AND J. M. F. MOURA

where Z is the partition function,

Z=

λ

1x
βx Ax/2.

(4)

μ

x∈X

Previous epidemics over network models call the ratio λ/μ, the effective infection rate [19]; this is also known as the reproductive ratio [20]. The equilibrium distribution, π(x), factors as the product of three terms: (1) the normalization by the partition function; (2) the term (λ/μ)1 x that is topology independent since the exogenous infection rate λ and the healing rate μ are identical for all the agents
in the network, and the total number of infected agents, 1 x, does not depend on the topology; and (3) the term βx Ax/2 that explicitly accounts for the exact network through its adjacency matrix A. This term
is topology dependent because the number of edges where both end nodes are infected (we call them infected edges), x Ax/2, explicitly depends on the underlying network.

2.3 Parameter regimes
The scaled SIS Process can model different types of network diffusion processes depending on if the effective exogenous infection rate, λ/μ, and the endogenous infection rate, β, are between 0 and 1, or if they are greater than 1. In Zhang & Moura [7], we identiﬁed four regimes. In this paper, we focus our analysis on Regime II Endogenous Infection Dominant: 0 < λ/μ 1, β > 1. Regime II best models epidemics and similar types of spreading processes.
The effective exogenous infection rate, λ/μ, indicates the preference of individual agents. With 0 < λ/μ 1, the healing rate is larger than the exogenous infection rate; agents prefer the healthy state to the infected state. With β > 1, however, additional infected neighbours increase the rate at which a healthy agent becomes infected. The network helps to spread the infection. As a result, network topology is crucial to determine the behaviour of the scaled SIS process at equilibrium.
In the next section, we introduce the Most-Probable Conﬁguration Problem, which solves for the network conﬁguration with the maximum equilibrium probability. Because there is competition between a topology-independent term and a topology-dependent term, the most-probable conﬁguration exhibits complex phase transition behaviour depending on the effective exogenous infection rate λ/μ, the endogenous infection rate β, and the underlying network topology.

3. Most-probable conﬁguration problem
In the previous section, we showed that, for the scaled SIS process, we are able to derive analytically its equilibrium distribution, π(x) (see Equation (3)). The equilibrium distribution describes the long-run behaviour of the network epidemics. While the partition function (4) renders the exact calculation of the equilibrium distribution infeasible for meaningful size networks, knowing the equilibrium distribution expression allows us to quickly compare between network conﬁgurations, addressing, for example, questions like which of the two is more probable. Of all the possible 2N network conﬁgurations, one is of particular interest, namely, the conﬁguration of infected and healthy agents that has the highest chance of occurring in the long run. This is the conﬁguration that maximizes π(x). Formally, x∗ maximizes the equilibrium probability:

x∗ = arg max π(x) = arg max

λ

1x
βx Ax/2.

(5)

x∈X

x∈X μ

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

ROLE OF SUBGRAPHS IN EPIDEMICS OVER FINITE-SIZE NETWORKS

589

We call this the Most-Probable Conﬁguration Problem and x∗ the most-probable conﬁguration. The Most-Probable Conﬁguration Problem is a combinatorial optimization problem as agents can only be in one of two states: its solution is dependent on the effective exogenous infection rate, λ/μ, the endogenous infection rate β, and the underlying network topology, captured by the adjacency matrix, A.
Previously in Zhang & Moura [7], we provided analytical results for the Most-Probable Conﬁguration Problem in Regime II Endogenous Infection Dominant: 0 < λ/μ 1, β > 1 for particular networks, namely, structured network topologies such as k-regular, complete multipartite, complete multipartite with k-regular islands. We observed a phase transition behaviour. Below a threshold condition that depends on the parameters (λ/μ, β) and on the network topology, the most-probable conﬁguration is x0 = [0, 0, . . . , 0], the conﬁguration where all agents are susceptibles. Above the threshold condition, the most-probable conﬁguration is xN = [1, 1, . . . , 1], the conﬁguration where all agents are infected.
This paper extends the analysis of the Most-Probable Conﬁguration Problem in Regime II to arbitrary network topology. We will show that, for arbitrary networks, the most-probable conﬁguration may be conﬁgurations other than x0 and xN . We call these solutions to the Most-Probable Conﬁguration Problem non-degenerate conﬁgurations. These solutions are useful for identifying agents and communities that are more vulnerable to the epidemics. We will relate these communities to the structure of the networks in detail later. Figures 1 and 2 show the most-probable conﬁgurations obtained by the method of Section 4 for two example networks: a 193 node acquaintance network [10] and the 4941 node power grid [11]. These are non-degenerate conﬁgurations where only a subset of agents are infected.
In Section 4, we prove that we can solve for the most-probable conﬁguration in Regime II in polynomial time using submodular optimization. Then, in Section 5, we discuss the relationship between the most-probable conﬁguration and the network topology, in particular, the relation between nondegenerate conﬁgurations and subgraphs in the network.

4. Submodularity and the most-probable conﬁguration
In this section, we show that the Most-Probable Conﬁguration Problem in Regime II can be transformed into a submodular function. First, we review the deﬁnition of submodular functions.

4.1 Submodular function
The Most-Probable Conﬁguration Problem is the maximization of a pseudo-Boolean function. Pseudo-Boolean functions are functions that map N binary variables to a real number [21]. Minimization of general pseudo-Boolean functions is NP-hard [22]. Grötschel et al. [23] proved that the minimization of a pseudo-Boolean function that is submodular can be solved in polynomial time. If the function is supermodular, its maximization can be found in polynomial time.
A pseudo-Boolean function, f : {0, 1}N → R, is also a set function g : P(V ) → R, where P(V ) is the power set of V = {1, 2, . . . , N}. There are many equivalent deﬁnitions of submodularity [24]. The one we use in this paper is the following:
Deﬁnition 4.1 ([21]) A set function, g : P(V ) → R, is submodular if and only if for any α1 ⊆ V , α2 ⊆ α1, i ∈ V \ α1
g(α1 ∪ {i}) − g(α1) g(α2 ∪ {i}) − g(α2).

590

J. ZHANG AND J. M. F. MOURA

For a submodular function, the incremental gain of adding an element to the set α1 is less than or equal to the gain of adding the element to a smaller subset of α1. A supermodular function has the inequality in the opposite direction.

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

4.2 Most-probable conﬁguration: a submodular problem

The Most-Probable Conﬁguration Problem (5) seeks the maximum of a pseudo-Boolean function that

maps a 0-1 vector, the network conﬁguration x, to a scalar. The network conﬁguration x ∈ {0, 1}N is the

characteristic vector or characteristic function of the set of infected agents: αx = {i | i ∈ V , xi = 1}. Let

h(αx) be the set of infected edges (i.e. edges where both end nodes are infected) in conﬁguration x:

h(αx) = {{i, j} | i, j ∈ V , Aij = 1, xi = 1, xj = 1}.

The number of infected agents in conﬁguration x is |αx| = 1 x. The number of infected edges

is |h(αx)| = x Ax/2. The Most-Probable Conﬁguration Problem is then to solve for the maximum

argument of

g(αx) =

λ

|αx |
β |h(αx )| .

μ

(6)

We will prove in Theorem 4.3 that − log(g(αx)) is a submodular function. Therefore, we can solve for its minimum argument in polynomial time. Lemma 4.2 sets up some basic conditions that makes proving Theorem 4.3 easier.

Lemma 4.2 Consider two sets of infected agents, α1, α2 ⊆ V and i ∈ V \ α1. The cardinalities of α1 and α2 are |α1| = n1 and |α2| = n2, respectively; then |α1 ∪ {i}| = n1 + 1, and |α2 ∪ {i}| = n2 + 1. The numbers of infected edges induced by α1 and α2 are |h(α1)| = e1 and |h(α2)| = e2, respectively. Let |h(α1 ∪ {i})| = e1 + m1 and |h(α2 ∪ {i})| = e2 + m2; therefore, m1 is the number of additional infected edges created with the inclusion of agent i in α1 and m2 is the number of additional infected edges created with the inclusion of agent i in α2. Let α2 ⊆ α1. Then

(1) n1 n2. (2) e1 e2. (3) m1 m2.

Proof. (1) When α2 ⊂ α1, α2 must have strictly fewer infected agents than α1. When α2 = α1, then they
contain the same number of infected agents. Hence, n1 n2. (2) When α2 ⊂ α1, infected agents in α2 can not induce more infected edges than the number of
infected edges induced by the infected agents in α1. When α2 = α1, then the infected agents in α1 and α2 will induce the same number of infected edges. Hence, e1 e2.
(3) Every infected agent in α2 is an infected agent in α1. Every new infected edge that is induced when adding infected agent i to α2 is also a new infected edge when adding infected agent i to α1.
Therefore, m1 m2.

Theorem 4.3 Let g(αx) be the set function given in (6). If λ > 0, μ > 0 and β 1, then − log(g(αx)) is a submodular function, where

λ − log(g(αx)) = −|αx| log μ − |h(αx)| log(β).

ROLE OF SUBGRAPHS IN EPIDEMICS OVER FINITE-SIZE NETWORKS

591

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

Proof. To prove submodularity of − log(g(αx)), we need to show that

− log(g(α1 ∪ {i})) + log(g(α1)) − log(g(α2 ∪ {i})) + log(g(α2)),

(7)

for any α1 ⊆ V , α2 ⊆ α1, i ∈ V \ α1. The left-hand side (LHS) of (7) is

λ

λ

− (n1 + 1) log μ − (e1 + m1) log(β) + n1 log μ + e1 log(β),

(8)

which reduces to

− log

λ μ

− m1 log(β).

(9)

The right-hand side (RHS) of (7) is

− (n2 + 1) log

λ μ

− (e2 + m2) log(β) + n2 log

λ μ

+ e2 log(β),

(10)

which reduces to

λ

− log μ − m2 log(β).

(11)

Expression (7) reduces to

− log

λ μ

− m1 log(β)

− log

λ μ

− m2 log(β).

Since β 1, we know that log(β) 0 and that m1 m2 by Lemma 4.2. Therefore, the LHS of (7) is less than or equal to the RHS of (7) for any α1 ⊆ V , α2 ⊆ α1, i ∈ V \ α1. By deﬁnition, − log(g(αx)) is a submodular function.

Theorem 4.3 proves that − log(g(αx)) is submodular if λ > 0, μ > 0 and β 1; this means that log(g(αx)) is supermodular under the same condition. Since the logarithm function is a monotonic function, the maximum argument of log(g(αx)) is also the maximum argument of g(αx), which is the solution to the Most-Probable Conﬁguration Problem. As Regime II Endogenous Infection Dominant: 0 < λ/μ 1, β > 1 satisﬁes the condition that β 1, using submodular minimization, we can ﬁnd the exact most-probable conﬁguration of the scaled SIS process in Regime II for arbitrary network topology
in polynomial time.

4.3 Social networks and the power grid
The most-probable conﬁguration allows us to identify a set of agents that are more vulnerable to the network epidemics; agents who are infected in the most-probable conﬁguration are more vulnerable to the epidemics than agents who remain healthy. Because the most-probable conﬁguration is derived from a dynamical process, the set of vulnerable agents depends on the infection and healing rates, λ, β, μ.
As we showed in Zhang & Moura [7], the most-probable conﬁguration changes depending on these parameters. When the healing rate dominates over the infection rates, x∗ = x0; this means that

592 (a)

J. ZHANG AND J. M. F. MOURA
(b)

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

(c)

(d)

Fig. 1. Most-probable conﬁguration x∗ under different (λ/μ, β) parameters (Blue = Infected, Red = Healthy). (a) λ/μ = 0.2, β = 2.4. (b) λ/μ = 0.267, β = 3. (c) λ/μ = 0.4, β = 1.2. (d) λ/μ = 0.5, β = 1.6.
the epidemics is not severe. When the infection rates dominate over the healing rate, x∗ = xN ; this means that the epidemics is severe. When x∗ is a non-degenerate conﬁguration (i.e. x∗ =| x0, xN ), this indicates that sets of agents in the network are more vulnerable than others to the epidemics. We illustrate this by solving for the most-probable conﬁguration using [25] under different (λ/μ, β) parameters for two real-world networks: a social network [10] and the Western US power grid [11], obtained from [26]
The network shown in Fig. 1 is a 193 node, 273 edge social network of drug users in Hartford, CT. The network was determined through interviews. Reference [27] looked for inﬂuential agents in the network by considering it as a graph connectivity problem. However, they did not consider a dynamical model of inﬂuence. Assuming that we can model drug habits as an epidemics (i.e. there is a social contagion aspect to the behaviour), we applied the scaled SIS process to this

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

ROLE OF SUBGRAPHS IN EPIDEMICS OVER FINITE-SIZE NETWORKS

593

network and solved for the most-probable conﬁguration under different parameters to ﬁnd inﬂuential network structures.
We show the resultant most-probable conﬁgurations in Fig. 1(a–d) as we change (λ/μ, β). We can see from these results that there is a small community of users who are infected when others are healthy. The size of this community increases or decreases depending on the parameters. If there is a social contagion component to drug usage, then these agents may be more vulnerable to the social contagion component of drug usage and therefore more likely to persist in their habit.
The network shown in Fig. 2 is the 4941 node, 6595 edge power grid network of the Western United States used by Watts and Strogatz [11]. They showed through simulation of the SIR epidemic model on the western power grid that small-world networks like the western power grid are more conducive to spreading infection/failures than lattice networks. This is useful for explaining why failures propagate so quickly in a blackout. However, they can not identify which components in the power grid are more vulnerable to the epidemics with their approach. Here, we model the blackout as an SIS epidemics by assuming that failures and recoveries of grid components (e.g. power stations, substations, generators, switches, lines) are intermittent; a failed component may return to power, possibly failing again, as often happens in practice. Using the scaled SIS process, we can identify the most vulnerable substructures in the network.
Figure 2(a) and (b) show the most-probable conﬁguration for the western US power grid when for the scaled SIS process parametrized at (λ/μ = 0.33, β = 2) and (λ/μ = 0.33, β = 2.6), respectively. We can see that for the same λ/μ, as β increases, thereby increasing the infectiousness of cascading failures (i.e. epidemics), the number of vulnerable components increases. This is intuitive since, for large β, the epidemics is severe, and the most-probable conﬁguration is driven towards xN , the conﬁguration where all the components are infected. Moreover, the most-probable conﬁgurations are both non-degenerate conﬁgurations. The components that are infected at equilibrium are more vulnerable to the cascading failures than components that remain healthy. By using submodular optimization, we can identify these more vulnerable components, by solving for the most-probable conﬁguration out of 24941 total possible conﬁgurations in polynomial time.
Using Matlab [25], on a desktop with 3.7 GHz Quad Core Xeon processor and 16 GB of RAM, the computation for the most-probable conﬁguration for the 193 node network and parameters shown in Fig. 1(a–d) took 1.54, 0.96, 0.14 and 1.76 s, respectively, and for the 4941 node network and parameters shown in Fig. 2(a) and (b) took 1.29 × 104 s and 3.71 × 103 s, respectively. Although large, the increase in computation time from the 193 node network to the 4941 node network is much smaller than the corresponding increase (24748 times) in the number of conﬁgurations. Additionally, computation time varies depending on the parameter values, most likely due to the complexity of the solution space of the optimization function.
An important question is to relate the most-probable conﬁguration to network structure. We will show in the next section that the most-probable conﬁguration is related to subgraph density by rewriting the equilibrium distribution (3) in term of induced subgraphs instead of network conﬁgurations.

5. Most-probable conﬁguration: network structure
In the previous section, we showed that we can exactly solve for the most-probable conﬁguration with a polynomial time algorithm. The exact solution, however, does not give insight on how the most-probable conﬁguration depends on the network topology. In this section, we draw the connection between the most-probable conﬁguration and subgraphs in the network. As per our intuition for

594

J. ZHANG AND J. M. F. MOURA

(a)

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

(b)
Fig. 2. Most-probable conﬁguration x∗ under different (λ/μ, β) parameters (Blue = Infected, Red = Healthy). (a) λ/μ = 0.33, β = 2. (b) λ/μ = 0.33, β = 2.6.

ROLE OF SUBGRAPHS IN EPIDEMICS OVER FINITE-SIZE NETWORKS

595

(a)

(b)

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

Fig. 3. (a) Conﬁguration x1 = [0, 1, 1, 1, 0, 0, 0] . (b) Induced Subgraph H(x1) = H1.

Fig. 4. (a) Conﬁguration x2 = [0, 0, 0, 0, 1, 1, 1] . (b) Induced Subgraph H(x2) = H2.

epidemics, densely connected network structures are more vulnerable to network epidemics; the scaled SIS process quantiﬁes this intuition. First, we will deﬁne the graph theoretic terms used in this section.

5.1 Induced subgraphs and graph density
Deﬁnition 5.1 (From [28]) The graph H is an induced subgraph of G if two vertices in H are connected if and only if they are connected in G and the vertex set and edge set of H are subsets of the vertex set and edge set of G.
V (H) ⊆ V (G), E(H) ⊆ E(G).
Deﬁnition 5.2 The graph H(x) is an induced subgraph of conﬁguration x = [x1, x2, . . . , xN ] if the nodes/edges in the subgraph are the infected agents/edges in x.

V (H(x)) = {vi ∈ V (G) | xi = 1}, E(H(x)) = {(i, j) ∈ E(G) | xi = 1, xj = 1}.

By deﬁnition, |V (H(x))| = 1 x and |E(H(x))| = x Ax/2. Figures 3 and 4 show two network conﬁgurations and their corresponding induced subgraphs. We proved in Zhang & Moura [29] that conﬁgurations whose induced subgraphs are isomorphic are equally probable. Unless we need to refer explicitly to the underlying network conﬁguration x, for notational simplicity, we will write H to denote an induced subgraph instead of writing H(x).

Deﬁnition 5.3 The set of all possible induced subgraphs of G is H = {H(x)}, ∀x ∈ X .
The set H includes the empty graph, which is induced by the conﬁguration x0 = [0, 0, . . . , 0] , and G, which is the subgraph induced by the conﬁguration xN = [1, 1, . . . , 1] .

Deﬁnition 5.4 (From [30]) The density of graph G is

d

(G)

=

|E(G)| |V (G)|

.

There is an alternative deﬁnition for graph density that is the number of edges divided by the total number of possible edges [31]. Unfortunately, these two deﬁnitions of density are not equivalent.
We will refer to the density of the entire network, d(G) = d(H(xN )), as the network density, and the density of an induced subgraph of G as the subgraph density. The density of the empty graph,

596

J. ZHANG AND J. M. F. MOURA

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

d(H(x0)), is 0 by deﬁnition. The subgraphs in H can be partially ordered by their density. There may be many subgraphs with the same density. A special induced subgraph in H is the densest subgraph. Deﬁnition 5.5 Let H be the densest subgraph in G. Then
d(H) d(H) ∀H ∈ H.
Finding H is known as the Densest Subgraph Problem. This problem can be solved in polynomial time exactly and in linear time in approximation for undirected graphs [30].

5.2 Equilibrium distribution of the scaled SIS process

Since there is a one-to-one relationship between the network conﬁguration x and its induced subgraph H(x), we can rewrite the equilibrium distribution (3) of the scaled SIS process in terms of the induced subgraph density and the size of the induced subgraph:

π(H) = 1 Z

λ μ

|V (H)|

β d (H )

,

H ∈ H,

(12)

where d(H) is the density of the subgraph and Z is the partition function. The Most-Probable Conﬁguration Problem (5) is then also an optimization problem over all the
possible induced subgraphs in G:

H(x∗) = arg max

λ

|V (H)|

β d (H )

.

(13)

H∈H μ

The subgraph induced by the most-probable conﬁguration, H(x∗), is the most-probable subgraph, but this is not necessarily the same subgraph as the densest subgraph, H.
Stating the equilibrium distribution in terms of the induced subgraph will allow us to derive several theorems regarding the most-probable conﬁguration. For the theorems that follow, we make the following assumptions:

Assumption 1 The scaled SIS process operates in Regime II Endogenous Infection Dominant. This limits the effective exogenous infection and the endogenous infection rates to the range, 0 < λ/μ 1 and β > 1.

Assumption 2 The underlying network G is a simple, undirected, unweighted and connected graph.

5.3 Most-probable conﬁguration and subgraphs
Theorem 5.6 (Proof in Appendix A) The most-probable conﬁguration x∗ =| x0 if and only if there exists at least one induced subgraph H ∈ H with density d(H) for which λβd(H) > μ.
Theorem 5.7 (Proof in Appendix B) The most-probable conﬁguration x∗ =| xN if and only if there exists at least one induced subgraph H ∈ H \ G with density d(H) = E /N for which

log((λ/μ)β d (G) ) log((λ/μ)β d (H ) )

<

N N

.

Combining Theorems 5.6 and 5.7, we can obtain the following corollary regarding the nondegenerate most-probable conﬁgurations.

ROLE OF SUBGRAPHS IN EPIDEMICS OVER FINITE-SIZE NETWORKS

597

Corollary 5.8 (Proof in Appendix C) Let the density of the network be d(G) = E/N. Then, the mostprobable conﬁguration is a non-degenerate conﬁguration, x∗ ∈ X \ {x0, xN }, if and only if there exists at least one induced subgraph H ∈ H with density d(H) = E /N for which λβd(H) > μ, and

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

log((λ/μ)β d (G) ) log((λ/μ)β d (H ) )

<

N N

.

In Regime II, individual agents have a preference for being healthy, but the epidemics might spread to other agents through neighbour-to-neighbour contagion. Under the scaled SIS process, the subgraph density d(H) scales the exogenous infection rate β, thereby affecting the overall infection rate. Theorem 5.6 states that, if the network contains dense-enough subgraphs, then even when the effective exogenous infection rate, λ/μ, is small (i.e. 0 < λ/μ 1), the exogenous infection rate, β, can leverage dense subgraphs to spread the infection throughout the network.
On the other hand, if the endogenous infection rate, β, is large (i.e. β 1), then most certainly the epidemics will spread throughout the entire network and x∗ = xN . Theorem 5.7 states the condition when x∗ =| xN . It also shows that it is important to consider if there are subgraphs in the network denser than the overall structure. Corollary 5.8 proves that the existence of the non-degenerate conﬁgurations is related to the existence of subgraphs with density larger than the network density. The existence of these denser than G subgraphs is crucial to the existence of non-degenerate conﬁgurations (i.e. different from x0 and xN ) as solutions to the Most-Probable Conﬁguration Problem; when the most-probable conﬁguration is a non-degenerate conﬁguration, agents belonging to denser subgraphs are more vulnerable to the epidemics.
In network science, dense clusters of agents have often been identiﬁed as either network core or community [32–34]. Solving for the non-degenerate conﬁguration is an alternative method for determining these network structures. Previous works in core/community detection are algorithmic and do not consider dynamical processes on the network. The scaled SIS process, however, is a model for dynamical processes on networks and, therefore, what is considered a community changes depending on the parameters of the dynamical process: the most-probable conﬁguration changes depending on the rates λ/μ and β.
We illustrate Theorems 5.6 and 5.7 with two small 16 node examples previously used in [7]: Network A in Fig. 5 and Network B in Fig. 6. For each network, we ﬁx the effective exogenous infection rate, λ/μ = 0.5. We then solve for the most-probable conﬁguration for different β, ranging from 1.2 to 3. As the endogenous infection rate, β, changes, the most-probable conﬁguration also changes. In Figs. 5(a) and 6(a), neither network supports dense-enough subgraphs for the epidemics to be severe. But as β increases, the infection starts to spread. In Network A, there is at least one subgraph denser than the network. The subgraph induced by V 1, V 2, V 3, V 4, V 5, V 7, V 8, V 9, V 10 has a density of 1.33 whereas the density of the entire network is 1.19. In Fig. 5(b), the most-probable conﬁguration has these nine agents infected while the other seven agents remain healthy. The nine agents in the dense subgraph are more vulnerable to the epidemics when λ/μ = 0.5 and β = 1.7.
In Network B, there are at least two subgraphs denser than the network and they are induced by the set of infected agents of the most-probable conﬁguration as shown in Fig. 6(b) and (c). We can see by solving for the most-probable conﬁguration for different parameter values that, as the endogenous infection increases, the most-probable conﬁguration goes towards xN as all agents become vulnerable to the epidemics.

598

J. ZHANG AND J. M. F. MOURA

(a)

(b)

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

(c)

(d)

Fig. 5. Most-probable conﬁguration x∗ under different (λ/μ, β) parameters (Blue = Infected, Red = Healthy). (a) λ/μ = 0.5, β = 1.2, d(H(x∗)) = 0. (b) λ/μ = 0.5, β = 1.7, d(H(x∗)) = 1.33. (c) λ/μ = 0.5, β = 2. d(H(x∗)) = 1.19. (d) λ/μ = 0.5, β = 3, d(H(x∗)) = 1.19.
It is easier for the infection to spread in Network B than in Network A, since, for the same rate parameters, x∗ = xN for Network B while x∗ =| xN for Network A. This is because Network B is a denser graph (d(G) = 2.4375) than Network A (d(G) = 1.19).

ROLE OF SUBGRAPHS IN EPIDEMICS OVER FINITE-SIZE NETWORKS

599

(a)

(b)

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

(c)

(d)

Fig. 6. Most-probable conﬁguration x∗ under different (λ/μ, β) parameters (Blue = Infected, Red = Healthy). (a) λ/μ = 0.5, β = 1.2, d(H(x∗)) = 0. (b) λ/μ = 0.5, β = 1.38, d(H(x∗)) = 2.5. (c) λ/μ = 0.5, β = 1.41, d(H(x∗)) = 2.467. (d) λ/μ = 0.5, β = 1.7, d(H(x∗)) = 2.4375.
5.4 Most-probable conﬁguration and the densest subgraph We showed that the most-probable conﬁguration is related to the density of induced subgraphs in the network. The densest subgraph, H, is a special induced subgraph. In this section, we focus speciﬁcally on the relationship between the most-probable conﬁguration and the densest subgraph.

600

J. ZHANG AND J. M. F. MOURA

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

Corollary 5.9 (Proof in Appendix D) The most-probable conﬁguration x∗ = x0 if and only if λβd(H) μ.
Corollary 5.9 follows the result of Theorem 5.6. If the densest subgraph in the network is not dense enough to overcome individual preferences for being healthy, then the endogenous infection rate β will not be able to drive the most-probable conﬁguration away from x0.
Lastly, because of the connection between the most-probable conﬁguration of the scaled SIS process and the densest subgraph, we can prove a general statement regarding network structure using results from dynamical processes on networks.
Corollary 5.10 (Proof in Appendix E) If G is a k-regular, complete multipartite or complete multipartite with k-regular islands network, then H = G. That is, for these structured networks, the densest subgraph is the overall graph.

6. Conclusion
We introduced in the previous works the scaled SIS process, which is a mathematically analysable model for modelling diffusion processes on a static network [7]. The scaled SIS process is a reversible Markov process and has a closed-form equilibrium distribution that explicitly accounts for the underlying network topology via the adjacency matrix. It is controlled by two parameters: (λ/μ, β). The effective exogenous infection rate λ/μ controls the exogenous, or the topology-independent behaviour of the scaled SIS process whereas the exogenous infection rate β controls the endogenous or the topologydependent behaviour of the process.
Depending on if the parameter values are in (0, 1] or (1, ∞), the scaled SIS process models qualitatively different network diffusion processes. In Regime II Endogenous Infection Dominant: 0 < λ/μ 1, β > 1, the scaled SIS process best models a network epidemic process; individuals prefer to be healthy, while the network helps to spread the epidemics throughout the population.
This paper analyses the Most-Probable Conﬁguration Problem, which solves for the network state with the maximum equilibrium probability, in Regime II for arbitrary networks. First, we proved that the Most-Probable Conﬁguration Problem in Regime II is submodular. This means that we can compute the exact most-probable conﬁguration in polynomial time. We use the most-probable conﬁguration of the scaled SIS process to identify sets of vulnerable agents/components for a social network of drug users and the Western US power grid under different infection/healing rates.
We then showed that the most-probable conﬁguration is dependent on certain classes of subgraphs in the networks. If there exist dense-enough subgraphs, conditioned on the right set of parameters, the most-probable conﬁguration will shift away from x0, the network state where all the agents are healthy. However, if there exist subgraphs that are denser than the entire network, conditioned on the right range of infection and healing rates, the most-probable conﬁguration may not reach xN , the network state with all agents infected. We call the solution of the Most-Probable Conﬁguration Problem that is neither x0 nor xN , the non-degenerate conﬁguration. Non-degenerate conﬁgurations identify subsets of agents that are more vulnerable to the network epidemics than others.
We also proved in this paper using results from Zhang & Moura [7] that structured networks such as k-regular, complete multipartite, complete multipartite with k-regular islands do not contain subgraphs that are denser than the overall network. Therefore, if we want to avoid subsets of agents being more vulnerable than others, we should use these types of structured networks. Our analysis of the scaled SIS process in Regime II informs us that network subgraph structures are important for understanding network diffusion processes. For future work, we are interested in statistically characterizing the subgraphs in network classes such as small-world networks and scaled-free networks.

ROLE OF SUBGRAPHS IN EPIDEMICS OVER FINITE-SIZE NETWORKS

601

Acknowledgement
We wish to thank Prof. João P. Costeira and Prof. João M.F. Xavier of the Department of Electrical and Computer Engineering at Instituto Superior Técnico, Lisbon, Portugal, for discussions regarding submodular optimization.

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

Funding
This work was partially supported by the Air Force Ofﬁce of Scientiﬁc Research (FA95501010291) and by the National Science Foundation (CCF1011903, CCF1018509).
References
1. Pastor-Satorras, R. & Vespignani, A. (2002) Epidemic dynamics in ﬁnite size scale-free networks. Phys. Rev. E, 65, 035108.
2. Keeling, M. J. & Eames, K. T. (2005) Networks and epidemic models. J. R. Soc. Interface, 2, 295–307. 3. De Souza, D. R. & Tomé, T. (2010) Stochastic lattice gas model describing the dynamics of the SIRS
epidemic process. Phys. A: Stat. Mech. Appl., 389, 1142–1150. 4. Newman, M. (2010) Networks: An Introduction. Oxford: Oxford University Press. 5. Danon, L., Ford, A. P., House, T., Jewell, C. P., Keeling, M. J., Roberts, G. O. & Vernon, M. C. (2011)
Networks and the epidemiology of infectious disease. Interdisciplinary Perspectives on Infectious Diseases. doi:10.1155/2011/284909. 6. House, T. & Keeling, M. J. (2011) Insights from unifying modern approximations to infections on networks. J. R. Soc. Interface, 8, 67–73. 7. Zhang, J. & Moura, J. M. F. (2014) Diffusion in social networks as SIS epidemics: beyond full mixing and complete graphs. IEEE J. Sel. Top. Signal Process., 8, 537–551. doi: 10.1109/JSTSP.2014.2314858. 8. Zhang, J. & Moura, J. M. F. (2013) Threshold behavior of epidemics in regular networks. Proceedings of International Conference on Acoustics, Speech and Signal Processing (ICASSP), pp. 5411–5414. doi: 10.1109/ICASSP.2013.6638697. 9. Wang, Y., Chakrabarti, D., Wang, C. & Faloutsos, C. (2003) Epidemic spreading in real networks: an eigenvalue viewpoint. Proceedings of the International Symposium on Reliable Distributed Systems, Florence, Italy, pp. 25–34. doi: 10.1109/RELDIS.2003.1238052. 10. Weeks, M. R., Clair, S., Borgatti, S. P., Radda, K. & Schensul, J. J. (2002) Social networks of drug users in high-risk sites: ﬁnding the connections. AIDS Behav., 6, 193–206. 11. Watts, D. J. & Strogatz, S. H. (1998) Collective dynamics of small-world networks. Nature, 393, 440–442. 12. West, D. B. et al. (2001) Introduction to Graph Theory, vol. 2. Upper Saddle River: Prentice Hall. 13. Ross, R. (1915) Some a priori pathometric equations. Br. Med. J., 1, 546. 14. Norris, J. R. (1998) Markov Chains. Cambridge: Cambridge University Press. 15. Liggett, T. M. (1999) Stochastic Interacting Systems: Contact, Voter and Exclusion Processes, vol. 324. Berlin: Springer. 16. Kelly, F. P. (2011) Reversibility and Stochastic Networks. Cambridge: Cambridge University Press. 17. Draief, M., Ganesh, A. & Massoulié, L. (2006) Thresholds for virus spread on networks. Proceedings of the International Conference on Performance Evaluation Methodologies and Tools, Pisa, Italy. New York, NY, USA: ACM, p. 51. 18. Ganesh, A., Massoulie, L. & Towsley, D. (2005) The effect of network topology on the spread of epidemics. Proceedings of the Annual Joint Conference of the IEEE Computer and Communications Societies, vol. 2, Miami, USA, pp. 1455–1466. 19. Bonaccorsi, S., Ottaviano, S., De Pellegrini, F., Socievole, A. & Van Mieghem, P. (2014) Epidemic outbreaks in two-scale community networks. Phys. Rev. E, 90, 012810.

602

J. ZHANG AND J. M. F. MOURA

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

20. Ball, F. (1999) Stochastic and deterministic models for SIS epidemics among a population partitioned into households. Math. Biosci., 156, 41–67.
21. Billionnet, A. & Minoux, M. (1985) Maximizing a supermodular pseudo-Boolean function: a polynomial algorithm for supermodular cubic functions. Discrete Appl. Math., 12, 1–11.
22. Boros, E. & Hammer, P. L. (2002) Pseudo-Boolean optimization. Discrete Appl. Math., 123, 155–225. 23. Grötschel, M., Lovász, L. & Schrijver, A. (1981) The ellipsoid method and its consequences in combi-
natorial optimization. Combinatorica, 1, 169–197. 24. Lovász, L. (1983) Submodular functions and convexity. Mathematical Programming The State of the Art.
Berlin: Springer, pp. 235–257. 25. Krause, A. (2010) SFO: A toolbox for submodular function optimization. J. Mach. Learn. Res., 11,
1141–1144. 26. Leskovec, J. & Krevl, A. (2003) SNAP Datasets: Stanford Large Network Dataset Collection.
http://snap.stanford.edu/data. 27. Borgatti, S. P. (2003) The key player problem. Dynamic social network modeling and analysis: Workshop
summary and papers, p. 241. 28. Godsil, C. G. R. (2001) Algebraic Graph Theory. Berlin: Springer. 29. Zhang, J. & Moura, J. M. F. (2014) Subgraph density and epidemics over networks. Proceedings of
International Conference on Acoustics, Speech and Signal Processing (ICASSP), pp. 1125–1129. doi: 10.1109/ICASSP.2014.6853772. 30. Khuller, S. & Saha, B. (2009) On ﬁnding dense subgraphs. Automata, Languages and Programming. Berlin: Springer, pp. 597–608. 31. Wasserman, S. (1994) Social Network Analysis: Methods and Applications, vol. 8. Cambridge: Cambridge University Press. 32. Csermely, P., London, A., Wu, L. Y. & Uzzi, B. (2013) Structure and dynamics of core/periphery networks. J. Complex Netw., 1, 93–123. 33. Borgatti, S. P. & Everett, M. G. (2000) Models of core/periphery structures. Soc. Netw., 21, 375–395. 34. Brandes, U., Pfeffer, J. & Mergel, I. (2012) Studying Social Networks: A Guide to Empirical Research. Campus.

Appendix A. Proof for Theorem 5.6
Theorem The most-probable conﬁguration x∗ =| x0 if and only if there exists at least one induced subgraph H ∈ H with density d(H) for which λβd(H) > μ.

Proof. Sufﬁciency: If there exists at least one subgraph H ∈ H with density d(H) for which λβd(H) > μ, then x∗ =| x0.
Using the equilibrium distribution (3), π(x0) = 1/Z. Let the subgraph H ∈ H be the subgraph induced by conﬁguration x ∈ X \ x0. The number of infected agents in conﬁguration x is 1 x =
|V (H) |> 0. Using (12), its equilibrium probability is

π(x ) = π(H) = 1 Z

λ μ

|V (H)|

β d (H )

.

If (λ/μ)βd(H) > 1, we know that π(x ) > π(x0). Therefore, x0 can not be the most-probable
conﬁguration. Necessity: If x∗ =| x0, then there exists at least one subgraph H ∈ H with density d(H) for which
λβd(H) > μ. If x∗ =| x0, this means that there is some conﬁguration x for which π(x ) > π(x0). We know that
π(x0) = 1/Z. Using the equilibrium distribution in (12) and the fact that 1 x = |V (H)| > 0, ∀x ∈ X \ x0,

ROLE OF SUBGRAPHS IN EPIDEMICS OVER FINITE-SIZE NETWORKS

603

we can conclude that there must exist some induced subgraph whose density satisﬁes this condition (λ/μ)βd(H(x ) > 1.

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

Appendix B. Proof for Theorem 5.7
Theorem The most-probable conﬁguration x∗ =| xN if and only if there exists at least one induced subgraph H ∈ H \ G with density d(H) = E /N for which

log((λ/μ)β d (G) ) log((λ/μ)β d (H ) )

<

N N

.

Proof. Sufﬁciency: If there exists at least one induced subgraph H ∈ H \ G with density d(H) = E /N such that log((λ/μ)βd(G))/log((λ/μ)βd(H)) < N /N, then x∗ =| xN .
The subgraph H is induced by the conﬁguration x ∈ X . The log equilibrium probabilities according to (12) for x and xN , respectively, are

log(π(x )) = log 1 + N log λ βd(H)

Z

μ

and

log(π(xN )) = log 1 + N log λ βd(G) .

Z

μ

Condition log((λ/μ)βd(G))/log((λ/μ)βd(H)) < N /N implies that N log((λ/μ)βd(G)) < N log((λ/μ)βd(H)). Therefore, log(π(x )) > log(π(xN )). Since the logarithm is a monotonic function, we can conclude that x∗ =| xN .
Necessity: If x∗ =| xN , then there exists at least one induced subgraph H ∈ H such that log((λ/μ)βd(G))/log((λ/μ)βd(H)) < N /N.
Let x∗ = x , which induces a subgraph H ∈ H with density d(H). Using (12),

π(x ) = log

1 Z

+ N log

λ μ

β

d

(H )

,

π(xN ) = log

1 Z

+ N log

λ βd(G) μ

.

Since x is the most-probable conﬁguration, this means π(x ) − π(xN ) > 0, which implies

N log

λ μ

β

d

(H )

− N log

λ μ

β

d (G)

> 0.

This reduces to the condition that

log (λ/μ)βd(G) log (λ/μ)βd(H)

<N . N

604

J. ZHANG AND J. M. F. MOURA

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

Appendix C. Proof for Corollary 5.8
Corollary Let the density of the network be d(G) = E/N. Then, the most-probable conﬁguration is a non-degenerate conﬁguration, x∗ ∈ X \ {x0, xN }, if and only if there exists at least one induced subgraph H ∈ H with density d(H) = E /N for which λβd(H) > μ, and

log((λ/μ)β d (G) ) log((λ/μ)β d (H ) )

<

N N

.

Proof. We want to determine the necessary and sufﬁcient conditions such that x∗ = x , which induces subgraph H, such that we have both x =| x0 and x =| xN . This is equivalent to showing

π(x ) > π(x0)

(14)

and

π(x ) > π(xN ).

(15)

Condition (14) holds if and only if λβd(H) > μ by Theorem 5.6. Condition (15) holds if and only if

log((λ/μ)β d (G) ) log((λ/μ)β d (H ) )

<

N N

,

by Theorem 5.7. This proves the corollary.

Appendix D. Proof for Corollary 5.9
Corollary The most-probable conﬁguration x∗ = x0 if and only if λβd(H) μ.
Proof. Sufﬁciency: If λβd(H) μ, then x∗ = x0. Recall the deﬁnition of the densest subgraph Deﬁnition 5.5. With β > 1, λβd(H(x)) λβd(H(x)) μ
for all possible induced subgraphs in G. This means that there is no subgraph, H ∈ H, for which λβd(H) > μ. We can conclude that x∗ = x0 using the contrapositive of Theorem 5.6: If there is no subgraph H ∈ H with density d(H) for which λβd(H) > μ, then x∗ = x0.
Necessity: If x∗ = x0, then λβd(H) μ. The result follows from the contrapositive of Theorem 5.6: If x∗ = x0, then there is no subgraph H ∈ H with density d(H) for which λβd(H) > μ. Therefore, all induced subgraphs, including the densest subgraph have density for which λβd(H) μ.

Appendix E. Proof for Corollary 5.10
Lemma If G is a k-regular, complete multipartite or complete multipartite with k-regular islands network, then H = G. That is, for these structured networks, the densest subgraph is the overall graph.
Proof. We proved previously in Zhang & Moura [7] that the solution of the Most-Probable Conﬁguration Problem, in Regime II, can not be a non-degenerate conﬁguration when the underlaying network is k-regular, complete multipartite, or complete multipartite with k-regular islands. We will use this and Corollary 5.8 to prove this corollary.
Consider the contrapositive of Corollary 5.8: Let the density of the network be d(G) = E/N. Then, the most-probable conﬁguration is not a non-degenerate conﬁguration, x∗ ∈ {x0, xN }, if and only if there

ROLE OF SUBGRAPHS IN EPIDEMICS OVER FINITE-SIZE NETWORKS

605

Downloaded from https://academic.oup.com/comnet/article-abstract/3/4/584/775753 by BIUS Jussieu user on 29 November 2018

does not exist any subgraph H ∈ H with density d(H) = E /N for which λβd(H) > μ, or

log((λ/μ)β d (G) ) log((λ/μ)β d (H ) )

<

N N

.

The most-probable conﬁguration is not a non-degenerate conﬁguration for k-regular, complete mul-
tipartite, complete multipartite with k-regular islands networks. This implies that all the induced subgraphs, H ∈ H, in these types of networks, satisfy the condition that λβd(H) μ or

log((λ/μ)βd(G)) N

log((λ/μ)β d (H ) )

, N

for all 0 < λ/μ 1, β > 1 parameter values. Depending on the effective infection rate and the endogenous infection rate, (λ/μ, β), the ﬁrst con-
dition λβd(H) μ may not be satisﬁed. However, since N /N can not be larger than 1 regardless of
parameters and the underlying network, the second condition is satisﬁed if

log((λ/μ)β d (G) ) log((λ/μ)β d (H ) )

1 ∀H ∈ H.

With β > 1, this means that d(H) d(G) for all possible induced subgraph. As this only depends on the structure of the underlying network, we can conclude that d(H) d(G) for networks whose mostprobable conﬁguration can only be x0 and/or xN .

