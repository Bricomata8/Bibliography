2013 IEEE Intelligent Vehicles Symposium (IV) June 23-26, 2013, Gold Coast, Australia

Active Safety for Vulnerable Road Users based on Smartphone Position Data
Martin Liebner, Felix Klanner and Christoph Stiller

Abstract— Smartphones have long become an omnipresent part of our life. Equipped with both a broadband internet connection and advanced GPS onboard sensors, the idea is to use them as mobile sensors for active safety systems that aim at protecting vulnerable road users such as pedestrians or cyclists. This paper gives a comprehensive analysis of today’s smartphones GPS accuracy on an inner-city bicycle track. In addition, the transmission latencies of a prototypical bicycle warning system are evaluated. The results show that while the lateral deviations are still too high to allow for lanelevel localization, the longitudinal accuracy as well as the transmission latencies are good enough for many active safety applications already.
Index Terms— Smartphone Position Data, 3G Transmission Latencies, Bicycle Warning System
I. INTRODUCTION
Detecting vulnerable road users (VRUs) such as pedestrians and cyclists so as to warn the driver in situations of imminent danger has been an ongoing research issue for more than a decade. While camera-based onboard-sensors have already reached good classiﬁcation rates for many situations [1], they still have trouble detecting VRUs at the side of the vehicle or behind an occlusion.
For this reason, the research initiative Ko-FAS [2] is investigating Car2X-architectures that allow to include infrastructure mounted camera units [3] and cooperative sensors [4] into the environment perception of future driver assistance systems. The drawback of this approach is that equipping intersections with extra camera systems is a costly affair, and the cooperative sensor technology would still rely on an additional transponder device that has to be carried around.
Smartphones, on the other hand, have long become an omnipresent part of our life. In Germany, nearly two thirds of the teens and twens and 40% of all ages own a smartphone [5]. Given an estimated 23 million smartphones sold in 2012, which is a rise of 43% as compared to 2011, experts predict an overall penetration of 66% till 2015 [6].
With such a high penetration rate to begin with, smartphones might help to overcome the challenge of low market penetration at the launch of ITS G5. Even today, they are used as satellite navigation systems with a live link to an online map database. If those users are offered a free active safety system on their smartphones, they have a motivation to provide their anonymized position data to the respective
M. Liebner and F. Klanner are with BMW Group, Research and Technology, D-80788 Munich, Germany. {martin.liebner, felix.klanner}@bmw.de
Christoph Stiller is with Karlsruhe Institute of Technology, Department of Measurement and Control, D-76131 Karlsruhe, Germany. stiller@kit.edu

backend which, if integrated in addition to ITS G5, will increase the beneﬁt of car-based driver assistance systems.
In this paper, we investigate the potential of smartphones as mobile sensors for active safety systems that aim at protecting vulnerable road users such as pedestrians and cyclists. In particular, we evaluate both GPS accuracy and transmission latencies of a state-of-the-art smartphone on an inner-city bicycle track and discuss our ﬁndings with respect to the feasibility of a bicycle warning system.
Experiments have been carried out with a Samsung Nexus S that facilitates a Broadcom BCM4751 GPS chip. The same GPS chip is used in Samsung’s Galaxy S3, the world’s most often sold smartphone in Q3 2012 [7]. Apple’s iPhone 4 is based on the predecessor chip BCM4750. In contrast to existing studies such as [8], reference data has been recorded while on the track so deviations both in and orthogonal to the direction of travel can be evaluated.
The remainder of the paper is organized as follows: In Section II, we introduce a bicycle warning system that is based on smartphones as mobile sensors and discuss its requirements with respect to the GPS accuracy of the smartphone. Section III describes the methods and instrumentation used in our evaluation. The results are given in Section IV, while Section V serves to discuss our ﬁndings and their consequences. Finally, Section VI concludes this paper.
II. BICYCLE WARNING SYSTEM In [9], we addressed the problem of driver intent inference at urban intersections for the scenario shown in Figure 1. The aim was to warn the driver of a cyclist that is moving parallel to the street if and only if the driver actually intends to do a right turn.
Fig. 1. Right turn scenario addressed by the bicycle warning system.
In a prototypical implementation of the system, the warning is issued as a directed accoustic signal if both the right-turn intent of the driver and an endangered cyclist are

978-1-4673-2754-1/13/$31.00 ©2013 IEEE

256

detected. The cyclist’s position data is provided by a BMW backend server which again has a direct connection to the smartphone. In the future, this kind of data transfer will be handled by a middleware that is currently under development at BMW Group and might well be standardized within Genivi [10]. The purpose of that middleware is to encapsulate the complexity of communication and to provide developers a convenient way to implement distributed applications.
Compared to most scenarios with pedestrians involved, our bicycle warning system has comparably low requirements on the GPS accuracy of the smartphone. Assuming that most cyclists use the cycleway if present, a map-matching algorithm can be employed to the smartphone’s position data so as to reduce its deviation from the cyclist’s actual position to its longitudinal component. Moreover, as cyclists have a higher velocity than pedestrians, the longitudinal deviation of their position data corresponds to a much smaller time difference when it comes to predicting time-to-reach values.
Assuming that the driver intent can be perfectly recognized, the remaining challenge lies in the correct classiﬁcation of situations in which a warning is necessary, which is often referred to as risk assessment. The risk assessment of the bicycle warning system consists of 3 steps: First, the future trajectory of the car is predicted so as to estimate the remaining time tCar for the car to reach the potential conﬂict point. If this time is less than 3 seconds, the same prediction is done for the bicycle using a constant velocity model. Finally, a warning is issued if the difference between the estimates tˆCar and tˆBicycle is within [−3 s, 2 s] and the probability for the right-turn intent of the driver is higher than a certain threshold.
An analysis of how well this risk assessment can detect critical situations based on the smartphone’s GPS data is given in Section V.

III. EVALUATION METHODS
This section describes the methods for evaluating the smartphone’s GPS accuracy and the transmission latencies for smartphone-to-car communication.

A. Evaluation of GPS accuracy
Evaluation has been carried out on inner-city cycleways in Munich. The track is shown in Figure 3. One lap is 2494 m and takes around 10 minutes to complete. For this study we cycled 219 laps, adding up to a total of 542.2 km and around 39 hours of measurement data. For better comparability between consecutive days, the data is organized in time slots of one hour each as shown in Table I.

TABLE I TIMESLOTS

Slot No.
1 2 3 4 5

Time (CET)
0900 – 1000 1000 – 1100 1300 – 1400 1400 – 1500 1500 – 1600

Leica Geosystem GPS1200
Samsung Nexus S
Fig. 2. Experimental setup. The Samsung Nexus S smartphone is horizontally mounted on the handlebar of the bicycle while the Leica Geosystem GPS1200 is carried in a special rucksack on the back.
The measurement setup is shown in Figure 2. For optimal reception as well as for inter-person comparability, the smartphone was mounted to the handlebar of the bicycle. However, we also did a small study with the smartphone put into the breast pocket of the cyclist’s jacket so as to investigate how much this is degrading the GPS accuracy.
As ground truth, a high precision carrier phase differential GPS system was used. The GPS antenna needs to be carried in a special rucksack on the back, so there is an estimated longitudinal offset of about 40 cm that needs to be compensated. Also, we expect an additional position error of up to 25 cm due to the cyclist’s movements. Beside the actual position values, the estimated standard deviation of the reference system as well as four position quality indicators (accuracy, horizontal dilusion of precision, number of satellites used to calculate the GPS ﬁx, number of satellites visible) of the smartphone have been recorded.
While the smartphone records data at 1 Hz, the reference system was set to a measurement rate of 20 points per second. Both smartphone and reference provide high precision GPS based timestamps, so the ground truth for the smartphone GPS ﬁxes can be calculated by interpolation. Also, each data point is mapped onto a digital representation of the track so as to allow for distance dependent evaluation.
B. Evaluation of transmission latencies Both smartphone and car have high precision GPS based
UNIX timestamps available, so latencies can mostly be compensated using a constant velocity model for the bicycle. They do become relevant, however, when the cyclist turns or brakes. In both cases the driver assistance system might warn

257

900 m 800 m 700 m 600 m 500 m
400 m

Latitude [°]

2100 m 2000 m 1900 m
1800 m 1700 m

48.181 48.180 48.179 48.178 48.177

1500 m 1400 m 1300 m 1200 m 1100 m 1000 m

300 m 200 m 100 m 0m 2400 m 2300 m

48.176 11.522

11.524 11.526 11.528 Longitude [°]

2200 m 11.530

Fig. 3. Route that has been taken for measurement. The 100% cycleway track includes a tree-lined part at 2400 m to 100 m, a comparably narrow street at 400 m to 1500 m as well as several potential stops at trafﬁc lights.

the driver of a threat that no longer exists if the latencies are too high.
In this paper, we use the right turn scenario of Figure 1 to analyze typical transmission latencies for smartphone-to-car communication. Experiments have been carried out at the crossing Hanauer Str. / Dessauer Str. (track distance 100 m) with both cyclist and car moving. In total, data from 39 right turn maneuvers has been captured. The internet connection of the car’s application unit has been established using a standard 3G HSDPA stick.
IV. RESULTS
A. GPS availability and reference quality
The complete dataset contains 140102 GPS ﬁxes over 140120 seconds of measurement, which corresponds to a GPS availability of 99.99% over time. However, evaluation had to be restricted to points for which the reference position satisﬁes an estimated standard deviation of less than 1 m, which is true for only 89% of the data. Within this reduced dataset, the estimated standard deviation of the reference position is distributed as shown in Figure 4.
0.6

Sigma [m]

0.4

0.2

0

East

North

Fig. 4. Estimated standard deviation of the reference position given as percentile ranges between 0, 25, 50, 75 and 95 percent.

B. Overall position accuracy

Count [−]

12000

12000

10000

10000

Count [−]

8000

8000

6000

6000

4000

4000

2000

2000

0 −10 −5 0 5 10
Longitudinal Deviation [m]

0 −10 −5 0 5 10
Lateral Devation [m]

Fig. 5. Overall deviation in and orthogonal to the direction of travel.

Figure 5 shows the deviation of the smartphone’s position data from that of the reference both in and orthogonal to the direction of travel. Apparently, the GPS ﬁxes are much more accurate in longitudinal than in lateral direction. The 95% quantile of the absolute values of the longitudinal deviations is 4.68 m, that of the lateral deviations 6.83 m.
C. Deviation over distance
In urban environments, there are many factors that can lead to a degradation of GPS based positioning systems. In order to explain the difference between longitudinal and lateral accuracy, Figure 6 visualizes the deviation of the smartphone’s position data over the track distance.
While the longitudinal deviations have more or less the same distribution throughout the whole course, the lateral deviations change signiﬁcantly when the cyclist enters the east–west part of the track. The change from negative to positive deviation values at a distance of 950 m, which is exactly the turning point at the westmost point of the track, indicates that the broader range and bias of the deviation is due to multipath effects caused by the buildings at the southern side of the street, which are very close to the cycleway at this part of the track. In general, most occlusions and reﬂective surfaces are oriented alongside the street, so it seems plausible that multipath-effects are more a problem of the lateral than of the longitudinal accuracy.
The trees alongside the cycleway between 2400 m and 100 m, on the other hand, seem to have a stronger effect on the longitudinal than on the lateral accuracy. This might be due to the smartphone’s internal position ﬁlter. If the cyclist stops at the trafﬁc light near 2400 m, he needs to accelerate within the tree-lined section of the track. In this section, the GPS signal strength is lower than usual and therefore, the position ﬁlter puts more weight to its constant velocity model than to the actual GPS updates. Given that the cyclist actually accelerates, this leads to negative longitudinal deviations as observed in the data.
D. Deviation over time
Figure 7 shows the distribution of the longitudinal and lateral deviation for the individual datasets. The most conspicuous observation is that for the datasets from 26th and 27th November 2012, 0900–1000 CET, the lateral deviations are much greater than average. Being from consecutive days

258

Longitudinal deviation [m]

20 10
0 −10 −20
0
20 10
0 −10 −20
0

500

1000

1500

2000

Distance [m]

500

1000

1500

2000

Distance [m]

Fig. 6. Deviation along the track. The lines correspond to the 2.5, 25, 50, 75 and 97.5 percent quantile.

2500 2500

Lateral deviation [m]

and the same time slot means that the satellite constellation was nearly identical for the two datasets. This demonstrates that the GPS performance strongly depends on the number and location of the satellites that are used for position estimation. It seems that under such worst case conditions the deviations are nearly twice as high as normal. However, given that the deviations of the rest of the data are consistent, such conditions seem to be rather unusual.
E. Quality indicators
For the use in driver assistance systems, it would be of great help to know when the smartphone position data is reliable and when not. A basic ﬁltering approach is to limit the GPS ﬁxes that are actually used to those whose quality measure is higher than a certain threshold. For the quality indicators that are provided by the smartphone, the resulting distributions of the total deviation as well as size of the remaining fraction of the data are shown in Figure 8.
Apparently, ﬁltering the data with the quality indicators satellites in ﬁx and satellites visible has no favourable effect on the actual deviations. On the contrary, it seems that the deviations are even higher the more satellites are visible. For the other two quality indicators, accuracy and horizontal dilusion of precision, ﬁltering does have a marginally positive effect.

Accuracy 12

Hdop 12

10

10

Total Deviation [m]

Total Deviation [m]

8

8

6

6

4

4

2

2

0 <= Inf <= 15 <= 10 <= 5 (100%)(99%) (96%) (66%)
SatsInFix 12

0 <= Inf <= 2.0 <= 1.4 <= 1.2 (100%)(92%) (73%) (45%)
SatsVisible 12

10

10

Total Deviation [m]

Total Deviation [m]

8

8

6

6

4

4

2

2

0 >= 0 >= 8 >= 9 >= 10 (100%)(93%) (73%) (37%)

0 >= 0 >= 10 >= 11 >= 12 (100%)(97%) (62%) (11%)

Fig. 8. Overall total deviation and availability of GPS ﬁxes under restrictions on the quality indicators provided by the smartphone. Deviations are given as percentile ranges between 0, 25, 50, 75 and 95 percent. Values in brackets represent the fraction of GPS ﬁxes that can still be used under the restriction.

259

|Longitudinal Deviation| [m]

15 10
5 0 15 10 5 0

|Lateral Deviation| [m]

2012−11−26 Slot 1 2012−11−26 Slot 2 2012−11−26 Slot 3 2012−11−26 Slot 4 2012−11−26 Slot 5 2012−11−27 Slot 1 2012−11−27 Slot 3 2012−11−28 Slot 2 2012−11−28 Slot 4 2012−11−30 Slot 5 2012−12−18 Slot 1 2012−12−18 Slot 2 2012−12−18 Slot 3 2012−12−19 Slot 4 2012−12−19 Slot 5 2012−12−20 Slot 1 2012−12−20 Slot 2 2012−12−20 Slot 3 2012−12−20 Slot 4 2012−12−20 Slot 5 2013−01−07 Slot 2 2013−01−07 Slot 3 2013−01−07 Slot 4 2013−01−07 Slot 5 2013−01−08 Slot 1 2013−01−08 Slot 2 2013−01−08 Slot 3 2013−01−08 Slot 4 2013−01−08 Slot 5 2013−01−09 Slot 1 2013−01−09 Slot 2 2013−01−09 Slot 3 2013−01−09 Slot 4 2013−01−09 Slot 5 2013−01−10 Slot 1 2013−01−10 Slot 2 2013−01−10 Slot 3 2013−01−10 Slot 4 2013−01−10 Slot 5 2013−01−11 Slot 3 2013−01−11 Slot 4 2013−01−11 Slot 5

Fig. 7. Individual deviation for each dataset given as percentile ranges between 0, 25, 50, 75 and 95 percent.

Count [−] Count [−]
Count [−]

F. Deviations with smartphone in pocket

G. Transmission latencies

As a side study, we also investigated the GPS deviations when the smartphone was put into the breast pocket of the cyclist’s jacket. The experiment was carried out on the ﬁrst 100 m of the track during time slots 1–4. In each time slot, the smartphone was ﬁrst carried 15 minutes in the breast pocket and then 15 minutes mounted to the handlebar so that changes in the satellite constellation do not affect the comparison. The results are given in Figure 9.

1000

Pocket

1000

Attached

The transmission latencies of the bicycle warning system introduced in Section II are given in Figure 10.

600 400 200
0 0

500

1000

Latency [ms]

1500

500

500

Fig. 10. Latency for smartphone-to-car communication in right turn

scenarios where both car and smartphone are moving.

0

0

10

20

Total deviation [m]

0

0

10

20

Total deviation [m]

Fig. 9. Deviation of GPS ﬁxes for the smartphone being put into the jacket’s breast pocket or attached to the handlebar of the bicycle.

As the diagram shows, the GPS performance suffers heaviliy if the smartphone is stored away in a pocket.

While there are occasions when the transmission takes longer than 1500 ms, 95% of the smartphone GPS position updates is transmitted in less than 646 ms. Given that the internet connection of the car’s application unit was established with a standard 3G HSDPA stick, it is conceivable that even better values might be obtained if a roof mounted antenna is used.

260

Warning Probability [%]

V. DISCUSSION
We are now going to discuss the consequences of our ﬁndings to the prototypical bicycle warning system introduced in Section II. By speciﬁcation, the system is to issue a warning if the estimated time difference between the bicycle and the car reaching the potential conﬂict point is within [−3 s, 2 s]. Because of the longitudinal deviation of the bicycle’s position data, however, the time for the bicycle to reach the potential conﬂict point cannot be exactly determined. Also, an additional error might be introduced by the transmission latencies of the smartphone-to-car communication if the cyclist accelerates or brakes. Both might lead to false positive as well as false negative risk assessments.
In practice, the cyclist will often move at a more or less constant velocity, so the transmission latencies can be neglected. Assuming a constant actual bicycle velocity of 6 m/s and a standard deviation of 10% for both the estimate of the car’s time-to-reach tˆCar and the estimate of the bicycle’s velocity, the probability of the system issuing a warning in a situation with an actual time difference tCar − tBicycle can be calculated based on the observed distribution for the smartphone’s longitudinal deviation shown in Figure 5. The result is visualized in Figure 11.
100
80
60
40
20
0 −5 −4 −3 −2 −1 0 1 2 3 4 5 tCar − tBicycle [s]
Fig. 11. Probability of a warning given the actual time difference between the bicycle and the car reaching the potential conﬂict point.
The ﬁgure indicates that, under the given assumptions, the smartphone’s longitudinal GPS accuracy is good enough to classify most of the situations correctly: Within the speciﬁed interval, warnings are issued with an overall probability of 91%. In very critical situations with time gaps between −2 s and 1 s, a warning is issued with a probability of more than 99%. Conversely, only 8% of all warnings have been issued outside the speciﬁed interval, with near to no warnings outside [−4 s, 3 s].
According to [11], the right-turn scenario is one of the three most common bicycle accident scenarios. The other two involve a car turning from the side street into the main street while a cyclist is moving along the cycleway of the main street either in or against the direction of trafﬁc. Both scenarios are very similar to the one discussed in that it is only the longitudinal deviation of the cyclist’s position data that matters as long as the we can safely infer that

the cyclist is moving along the cycleway. Given the same constant velocity of the cyclist, the resulting performance can therefore be expected to be very similar to the one discussed.
VI. CONCLUSION
In this paper, the potential of a state-of-the-art smartphone has been evaluated with respect to its use as a mobile sensor for active safety systems. The results indicate that while the lateral deviations are still too high to allow for lane-level localization, the longitudinal accuracy is good enough for many active safety applications already. Using a map-matching algorithm and context knowledge to negotiate lateral deviations, the smartphone position can be predicted with 95% of its deviations below 4.68 m. Combined with an average transmission latency as low as 500 ms, this has been shown to be sufﬁcient to address the majority of common bicycle accident scenarios.
A remaining problem is the strong degradation of the position quality if the smartphone is stored away into a pocket, which makes it unusable as a pedestrian detection device in inner city scenarios. Hopefully, this will change with the next generation of GPS chips, which have been announced in 03/2012 [12], and the launch of Galileo.
ACKNOWLEDGEMENTS
This work was funded in part by the Federal Ministry of Economics and Technology of the Federal Republic of Germany under grant no. 19 S 9022. The authors would like to thank Christoph Brewing, Roland Feit, Sonja Steker and Michael Baumann for their help to collect the measurement data.
REFERENCES
[1] M. Enzweiler, “Compound Models for Vision-Based Pedestrian Recognition,” PhD Thesis, University of Heidelberg, 2011.
[2] “Ko-FAS research initiative.” [Online]. Available: www.kofas.de [3] D. Weimer, S. Kohler, C. Hellert, K. Doll, U. Brunsmann, and
R. Krzikalla, “GPU architecture for stationary multisensor pedestrian detection at smart intersections,” in Intelligent Vehicles Symposium (IV), 2011 IEEE. IEEE, 2011, pp. 89–94. [4] D. Schwarz, H. Kloeden, and R. Rasshofer, “Ko-TAG - Cooperative Sensor Technology for Trafﬁc Safety Applications,” in WIT, 2011. [5] German Federal Association for Information Technology, Telecommunications and New Media, “Fast 40 Prozent haben ein Smartphone,” 2012, Press Release. [Online]. Available: www.bitkom.org [6] ——, “Trendkongress diskutiert neue Entwicklungen der digitalen Welt,” 2012, Press Release. [Online]. Available: www.bitkom.org [7] Strategy Analytics, “Samsung Galaxy S3 Becomes World’s BestSelling Smartphone Model in Q3 2012,” 2012, Press Release. [Online]. Available: www.StrategyAnalytics.com [8] D. Thielen, T. Lorenz, M. Hannibal, F. Koster, and J. Plattner, “A feasibility study on a cooperative safety application for cyclists crossing intersections,” in Intelligent Transportation Systems (ITSC), 2012 15th International IEEE Conference on, 2012, pp. 1197 –1204. [9] M. Liebner, M. Baumann, F. Klanner, and C. Stiller, “Driver intent inference at urban intersections using the intelligent driver model,” in IEEE Intelligent Vehicles Symposium, Alcala de Henares, Spain, June 2012, pp. 1162–1167, (best paper award). [10] Genivi Alliance, 2013. [Online]. Available: http://www.genivi.org/ [11] “GIDAS - German In-Depth Accident Study,” 2011. [Online]. Available: www.gidas.org [12] Broadcom Corporation, “Smartphone Location Platform Delivers 10X Improved Acquisition Performance and Leverages Broadcom Wireless Connectivity for Indoor Positioning,” 2012, Press Release. [Online]. Available: www.broadcom.com

261

