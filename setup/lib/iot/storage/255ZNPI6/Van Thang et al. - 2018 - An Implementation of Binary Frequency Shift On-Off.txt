An Implementation of Binary Frequency Shift On-Off Keying Modulation for Optical Camera
Communication

Van Thang Nguyen, Nam Tuan Le, Thanh Luan Vu, Minh Duc Thieu, Yeong Min Jang Department of Electronics Engineering, Kookmin University, Seoul, South Korea yjang@kookmin.ac.kr, thang.nguyenvan.hust@gmail.com

Abstract— Optical camera communication (OCC) technique has been considered as an extension of visible light communication (VLC) with the advances on the development and commercialization of camera. It will be a promising technique for wireless communication which has been promoted as a candidate for the standardization issues by IEEE 802.15.7r1. OCC is the convenient way of transmitting data between light sources (LEDs, digital signage or other light emitting devices) and image sensor (camera, webcam) that are included in most of smart devices. In this paper, we introduce an OCC system from architecture to modulation scheme and application in indoor environment. Then, we propose a binary frequency shift on-off keying (BFSOOK) uses a pair of distinct OOK frequencies to transmit logic ones and zeros respectively for rolling shutter image sensors camera using light-emitting diode (LED) as the transmitter and camera of the smartphone device as the receiver. Within the scope of this technique, the new standard of Camera API with more advantages is used to resolve some issues related to OCC system.
Keywords— Optical camera communication (OCC), Visible light communication (VLC), IEEE 802.15.7r1, frequency-shift-onoff-keying, FSK, API.
I. INTRODUCTION
Recently, wireless communication using visible light spectrum pay a lot of attention and was standardized in the IEEE visible light communication (VLC) standardization. Optical camera communication (OCC) is known as extension of VLC, is a promising technology due to the illumination and commercialization [4], [5]. Especially, in line of sight marketing service and indoor localization, OCC which can be extended from all commercial smartphones, will be a promising service. Different with VLC system based photodiode, the OCC transmitters are light sources with single source such as LED, LCD screen or digital signage and the OCC receiver are computer programming based on image sensor from camera, webcam [4]. The architecture and operation of OCC are shown in Fig. 1. In this paper, the OCC system is implemented with the transmitter system used LED light with the Arduino Mega board, and the receiver based on decoding application using android smart phone device.
In order to get data from LED for communication purpose, some parameters on the smartphone device must be set up by using new Application Programming Interface (API) version

called camera 2 API such as shutter speed, frame rate, resolution and etc. Camera 2 API is new API which was integrated in Android OS from API version 21 supporting developer fully functions on camera control. With new advances on camera apps, it can increase the performance of camera at different scenarios. We can easily configure the camera with the shutter speed up to 16000Hz or frame rate exactly, this depend on the hardware of each smartphone camera [3]. When the shutter speed is configured fast enough, the background of the image is totally dark and the light source areas on the image are very bright. It means that image processing time will be decrease significantly as well as applying algorithm to the application will be simpler. In addition, camera 2 API supports YUV_420_888 output image format, which makes the duration time variation between two frames is so small and the synchronization between the transmitter and receiver easily as well as frame rate optimization.
Beside the typical advantages, challenges and technical problems still exist for OCC. One of the most consideration issues for indoor application is flickering control. In addition, the transmitter and the receiver are not strictly synchronized, and it is difficult to know the phase difference between the transmitted signal and the camera receiver, so the received onoff keying (OOK) waveform slowly slips with respect to the sampling point. The phase slipping problem can cause more error bits and reduce the system performance. With OOK modulation, the modulated light signal represents the digital bit by on-off state. In spite of achieving higher data rate than FSOOK, it cannot support the flickering avoidance [2], [4]. In this paper, we propose a binary frequency shift on-off keying (BFSOOK) uses a pair of distinct OOK frequencies to transmit logic ones and zeros respectively for rolling shutter image sensor camera. Camera is also able detect this BFSOOK signal as a form of banded image the frequency of which is proportional to the frequency of the LED. The sampling properties of BFSOOK allows the encoding of bits at frequency shift on-off keying frequencies that avoid flicker while at the same time being successfully decoded by a low frame rate camera.
The remainder of this paper is organized as follows. Section 2 shows the overview and related works in OCC system. In Section 3, we first give some challenges about illumination in

978-1-5386-4646-5/18/$31.00 ©2018 IEEE

121

ICUFN 2018

Fig. 1: Optical camera communication architecture

OCC. Subsequently, our proposed modulation scheme will be presented. Section 4 is the implementation architecture and the performance evaluation of proposed modulation. The final section will summarize the research and gives direction for future trend.
II. RELATED WORKS
Visible Light Communication (VLC) has emerged as a promising technology for wireless communication that has been officially standardized by IEEE 802.15.7. Most of the applications of VLC are combinations of lighting function and communication on existing light system. As a consideration for the extension of VLC, Optical Camera Communication (OCC) technique inherits and takes advantage of VLC on receiver characteristic and is a candidate for the standardization of issues in IEEE 802.15.7r1.
For the general view, VLC can be classified by photon signal from photodiode or image sensor [2], [4], [5]. As this classification, there are two major receiver optical choices in VLC: (i) non-image optics is used with single photodiode detectors to enhance FOV angle and convert light signal to electrical signal with continuous waveform; (ii) imaging optics is used in conjunction with camera image sensor. Considering illumination function and modulation technique, OCC system can be classified by two directions: OOK modulation and frequency subcarrier modulation.
Undersampled frequency shift on off keying (UFSOOK) in [1], [2] is a modulation that encodes bits using a form of DC balanced differential encoding. The modulation concept was based on frequency shift keying (FSK), and it encodes bit 1 and bit 0 with different frequencies. The frequencies for the logic encoding of bit 1 and bit 0 are selected as mark and space frequencies, respectively and are used for the lower frame rate in the camera. With global shutter camera, each pixel in the

image sensor array begins and ends the exposure simultaneously. This means we can only obtain one state mark, space at each sampling process. This paper will mainly focus on the analysis and the performance evaluation of OCC system that used frequency subcarrier modulation, the data is transmitted by different frequency of on-off lighting source. Rolling shutter camera will detect the carrier frequency from image of light and demodulate the original data.
III. BINARY FREQUENCY SHIFT ON-OFF KEYING MODULATION
A. Illumination Challenges
Due to the strict relation exists between the modulation technique and flicker factor, flickering mitigation is considered as a mandatory factor that determine the success of the modulation technology for both indoor and outdoor environment applications. Based on the cutoff frequency of human eye and camera in Fig. 2, an innovative modulation scheme for flickering avoidance modulation with a low frame rate camera of 30 fps, named undersampled frequency shift onoff keying (UFSOOK). In this scheme, the mark (logic 1) and the space (logic 0) frequencies are configured higher than 100 Hz in order to remove the flickering effect of LEDs. The modulation frequency is also restricted with camera shutter speed, to limit shutter speed value for camera then the frequencies of logic 1 and logic 0 are no larger than 1000Hz.
With OOK modulation as shown in Fig. 3, each bit represents for one stripe on capture image [3]. Although achieving higher data rates than FSOOK modulation, data loss can occur in OOK modulation when the transmission distance is changed. With FSOOK modulation technique, each stripe represents for multiple bits on the image view as shown in Fig. 4 so the data can be decoded accurately without data loss. Additionally, the distance for data transmission also has a strict relation with data rate, the number of of strips in the imageview

122

will change inversely proportional with the distance as shown in Fig. 5.
Fig. 2. The cutoff frequency of human eye and camera

camera communication. Camera is also able to detect signals as a form of banded image the frequency of which is proportional to the frequency of the LED. The most important problem of our proposed modulation scheme is classification the bit state from frequency subcarrier on the transmitter side. To resolve this issue, at least two discrete sampling from camera are used. We assume that f1 and f2 are two frequencies which represent for bit 0 and bit 1. The sampling properties of BFSOOK allow the encoding of bits at frequency that able to avoid flickering while decoded by a low frame rate camera at the same time. Additionally, by using rolling shutter camera, we can get a sequence of bits which can help data loss avoidance. Depending on the sampling time, the combination sampling is different. The sampling bit pattern of camera for bit subcarrier 0 and bit subcarrier 1 are shown in Table 1.
TABLE 1: SAMPLING BIT PATTERN

Data bit

Sampling bit

Fig. 3. OOK modulation for OCC

Transmitter

bit 0

bit 1

bit 1

bit 0

Stripes on camera sampling Receiver
Fig. 4. Binary frequency shift on-off keying modulation for OCC

1

10

0

11

Bit Encoding

Sampling bit 0

f1

Sampling bit 1

f2

The start frame delimiter (SFD) which is appended to the beginning of each data frame is required to identify the beginning of a data packet. The appearance of another SFD will be at end of the packet, which signals is at the start of the next packets data frame. In order to distinguish SFD from data bits, we use the synchronization phase “00” sampling bit pattern at the start of each data packet as shown in Fig. 6.

00 bit 0 bit 1

00 bit 0 bit 1

00

SFD Data packet 1

SFD Data packet 2

SFD

Preamble data

Data Packets

End data

Fig. 5. Effect of communication distance
B. BFSOOK Binary frequency shift on off keying (UFSOOK)
modulation uses a pair of distinct OOK frequencies to transmit logic ones and logic zeros respectively. Figure 4 shows an example of binary frequency shift OOK modulation for optical

Fig. 6. Start frame delimiter in UFSOOK
IV. EXPERIMENT PERFORMANCE In this section, we will implement the proposed modulation on experiment application to analysis the performance of OCC system on rolling shutter camera with the scenario as shown in Fig. 7. The receiver processing interface is based on image sensor in the smartphone; the Arduino board is used for

123

controlling LED as the transmitter through Mosfet driver. The system configuration with different setting modulation of the
TABLE 2: SYSTEM CONFIGURATION

Parameter

Value

f1 f2 LED power Camera Camera sampling rate Camera image sensor Shutter speed

2 KHz 4KHz 12V, 15W Nexus 5x 20 fps Rolling shutter 1/8000s

Arduino board

Mosfet

LED

transmitter and receiver is shown in Table 2. Following implementation scenario and the configuration parameters in Fig. 8a, we achieve the bit pattern image of one super frame and the data is transmitted from the LED through the android application built on smartphone which supports camera 2 API as shown in Fig. 8b. Due to the effect of configuration settings, the width of stripes and the number of stripes at different distance and different shutter speed values are shown in Fig. 9 and Fig. 10. That is the important factors for coding at the transmitter side and decoding at the receiver side.

10

1/16000 sec 8

1/12000 sec 6
1/8000 sec 4

1/4000 sec 2
1/3000 sec

0

0

0.5

1

1.5

2

2.5

3

3.5

Shutter speed [s]

Figure 9: Relationship between shutter speed and width stripe

10-4 4

OCC application
Figure 7: Implementation architecture
Fig. 8. Experimental setup

Figure 10: Relationship between distance and number of stripe
V. CONCLUSION
As a candidate for the revision of 802.15.7, OCC that takes the advantages of the VLC system will be a promising technology of future wireless communication. In this paper, we introduced the OCC system from architecture to modulation scheme and application in indoor environment. Through the implementation using camera 2 API in smartphone, we give some performance evaluations and analysis for OCC structure based on proposed modulation protocol named binary frequency shift on off keying (BFSOOK). The implementation results demonstrated that the feasibility of the proposed modulation despite of the data rate limitation. As far as future work is concerned, localization is a promising trend in both laboratory as well as industrial area to achieve the ultimate goal of commercialization in production.

124

ACKNOWLEDGMENT This research was supported by the MSIT (Ministry of Science and ICT), Korea, under the Global IT Talent support program (IITP-2017-0-01806) supervised by the IITP (Institute for Information and Communication Technology Promotion).
REFERENCES
[1] Richard D. Roberts, “Undersampled frequency shift ON-OF keying (UFSOOK) for camera communications (CamCom)”, 2013 22nd Wireless and Optical Communication Conference, pp. 645–648, December 2013.

[2] Nam Tuan Le, Trang Nguyen, Yeong Min Jang, “Frequency shift on-off keying for optical camera communication,” ICUFN 2014, pp. 22–25, August 2014.
[3] Phuoc Nguyen, Nam Tuan Le, Yeong Min Jang “Challenges Issues for OCC Based Android Camera 2 API” ICUFN 2017, pp. 669–673, July 2017.
[4] Nam Tuan Le, Mohammad Arif Hossain, Yeong Min Jang “A survey of design and implementation for optical camera communication” Signal Processing: Image Communication, vol. 53, pp. 95–109, April 2017.
[5] Nirzhar Saha, Md Shareef Ifthekhar, Nam Tuan Le, Yeong Min Jang “Survey on optical camera communications: challenges and opportunities” IET Optoelectronics, vol. 9, pp. 172–183, October 2015.
[6] Peng Ji, Hsin-Mu Tsai, Chao Wang, Fuqiang Liu “Vehicular Visible Light Communications with LED Taillight and Rolling Shutter Camera” 2014 IEEE 79th Vehicular Technology Conference, pp. 1–6, January 2015.

125

