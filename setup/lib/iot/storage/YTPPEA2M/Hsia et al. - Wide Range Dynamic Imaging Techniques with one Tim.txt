Wide Range Dynamic Imaging Techniques with one Time Exposure

Shih-Chang Hsia, Ting-Tseng Kuo /National Yunlin University of Science and Technology, Department of
Elecrtron, Douliou, Taiwan
Email: hsia@yuntech.edu.tw
Abstract—The proposed algorithm used an inverting local pattern approach to compensate histogram of the lighting distribution. To improve processing efficiency, the sampling image is classified into three types with various processing methodologies, to achieve a suitable correct factor. The inverting factor is mixed with the original sample, to get dark brightening and bright darkening effect. Then the brightness enhancement and auto-gain-control are post-processed to expand the range of gray level.
Keywords—histogram, pattern, gain control, image processing
I .Introduction
In order to improve the imaging qulaity, high dynamic range (HDR) algorithms are presented in recent. The HDR algorithm is to expand the visible range at a part of the bright and dark scene at the same time for imaging details presented. Multiple exposure methods [1-3] are efficient to expand the dynamic range. Catching three images under three different exposures are used based on the gradient-based synthesis [2]. A set of images involved in the same scene made with different exposures. A HDR pixel is computed by three images according to Gaussian blending function and cutting function to reserve high quality part of each sampling. However, the multiple exposure approach increases computational time. Recently, V. Vonikakis et al. [4] proposed a single exposure algorithm to reduce the computational cost. This approach comprises three different stages: a linear stretch, block parameter estimation and contrast modification. This approach can achieve good improvement for HDR images using a short execution time. However, the download- and up- sample may degrade image resolution possible. G. Guarnieri [7] et al. used the techniques of logarithms and exponential-based edge-preserving low-pass and multi-resolution acceleration. Since the iteration operation is used, this is inevitable to increase computation time. K. Kim et al. [8] presented a retinex algorithm, which proposed a tone mapping function to improve the dark area contrast. The algorithms [7.8] are not effective for over-exposed regions to reduce positive saturation based on retinex-like approach.
In this study, we present a high performance HDR algorithm using a single image processing to fasten computational speed. Based on LCD backlight theory, an inverted pattern approach is proposed to improve both overand under- exposed regions at the same frame for a camera

Tzu-Hsiung Chen / Taipei City University of Science and Technology, Department of Computer Science and
Information Engineering, Taipei, Taiwan
Email: thchen@tpcu.edu.tw imaging system. For real-time application, this algorithm uses one-pass processing flow to keep low computational complexity.
II. Proposed Fast Algorithm for HDR Image Generation For real-time application, we proposed one-pass
processing instead of iterative operation. Figures 1 illustrates a flow chart of the proposed HDR algorithm. First, the original image is converted from the RGB to YCbCr. The luminance signal Y is used to determine the frame type using histogram analysis. The frame type for HDR computing is classified to three types: dark, bright and extreme type. Dark enhancement is applied to dark and extreme type to improve the region of
low gray level. On the other path, the inverse pattern yinv is
generated from an inverse kernel which includes 2x2 maximum fill, 3x3 low-pass and inverse operation. The
inverted patterns yinv are mixed by using the factor of the
original luminance signal. The results are further processed by the modules of bright enhancement and AGC (Automatic Gain Control)[11]. Finally, the color HDR image is generated by YCbCr to RGB conversion.
Fig. 1 Block diagram of the proposed HDR algorithm

978-1-7281-1340-1/19/$31.00 ©2019 IEEE

224

ICUFN 2019

When the current frame is sampled, we first estimate light distribution using histogram analysis before HDR computing. According to histogram distribution, the frame is classified to three types: (a). Dark Type : most of distribution are in the low-gray level. (b). Bright Type: most of distribution are in the high-gray level. (c). Extreme Type: both of high- and low- gray levels occupied most of distribution.
Table 1 Condition of three types.

Type

Condition

Dark

Lo  2Hi

Bright

Hi  2Lo

Extreme

1 2

Hi Lo

2

and

Hi & Lo



Ptotal 4

Normal

Other conditions

For this, we devise two parameters Hi 及 Lo, for type

decision of an 8-bit image, which can be expressed by


  
 
  

Hi Lo

 

Th4

255

h(i)  h(i)  2

i Th 3

iTh 4

Th1

Th 2

h(i)  2  h(i)

i0

i Th1

(1).

The parameter Hi denotes the accumulation of the number of gray-level between thresholds between Th3 to Th4. To enhance the extra bright feature, we take the double number between Th4 to 255, to accumulate to Hi. Similarly, the parameter Lo represents to accumulate the double number of gray level range from 0 to Th1 and to accumulate the interval with the threshold Th1 to Th2 pixels. If the sampling image is too dark, Lo value will be large. If Hi value is high, the sampling frame is possible to be brightness.
According to the parameters Hi and Lo, the frame type

can be efficiently classified, as listed in Table 1. If Lo  2Hi ,

the sampling frame is too dim, this belongs to dark type. If

Hi  2Lo , this is a bright type since the sampling level is high

on average.

When

1 2



Hi Lo



2

and

Hi & Lo  Ptotal 4

， where

Ptotal is the number of total pixels, this is classified as a
extreme type since the sampling pixels included the partial positive and negative saturation at the same frame. If the sampling frame is not satisfied these conditions, this is a normal case ; we do not require any HDR processing.
The inverse kernel consists of three sub-modules that are 22 maximum fill, 33 low-pass filter and inverse operation. The detailed description for each block is following:
(i). 22 maximum fill: is used to keep original detail thin information for HDR algorithm. Four pixels in a 22 block is filled by the maximum value of four pixels. First, we search the maximum value of the pixels of 22 block. Then, all pixels of 22 block are filled by the maximum value. Figure

2(a) shows the original image, and the result of 22 maximum fill is shown in Fig. 2(b).

Fig. 2(a) and (b) is original image, and results with 22 maximum fill

(ii) 33 low-pass filter : is used to smooth the pixel after

22 maximum filling operation. Because 22 maximum fill

will make the image to appear jagged edges, low-pass filter is

used to smooth jagged edges.

(iii) Inverse operation : achieves inverse function of input

pixel in order to enhance the level of dark region and reduce to

brightness level to avoid negative and positive saturation. We

adopt a square linear function to improve the performance of

dark region, which can be given by

  yinv (i, j) 

255  ylpf (i, j) 2 255

(2),

for 8-bit image. The inverse function gives the maximum gain

for the lowest brightness pixel. The gain gradually decreases

when the gray value increases.

First, we compensate the dim region for dark type and

extreme type to promote the dark level, the dark pixel is

enhanced by

ydark

(i,

j)



  

yin yin

(i, (i,

j) j)



Thdark



yin

(i,

j)  0.05　 if
　if

　yin (i, 　yin (i,

j) j)

 

Thdark Thdark

(3)

, where the threshold Thdark is defined by

128 if

Thdark



 

50

if

yin  Dark Type yin  Extreme Type

(4)

 0 if yin  Bright Type

, where yin is an original input Y signal. This operation further adds one minimum value for very low level pixel to

avoid negative saturation. If yin is lower, the gray level is improved larger using (6). When the frame type is dark, the

gray level is enhanced if it is less than 128. For extreme type,

the pixel level is increased only if the gray level is less than 50.

We skip the dark enhancement for bright type when setting

Thdark =0.

For HDR display, we take a mixing operation of the

inverse pixel from (2) and dark enhanced pixel from (3) by

ymix (i, j)  ydark (i, j)  yinv (i, j)  k (4)

, where k is a key parameter to decide HDR image. If k is

larger, we obtain stronger degree of HDR. The dark portion is

raised because its inverse backlight yinv is high. On the
opposite case, the bright pixels can be reduced due to low yinv, which can overcome pixel to be over-exposure. To find a

225

better k parameter, we select three type pictures for testing,

and find a suitable k value for any picture in experiments.

When Lo value that is from (1) is high, we require larger k to

adjust image brightness. Since high Lo implies more dark

pixels in the frame, the k is enlarged to increase the gain of

level increment.

After the mixing operation, the luminance of dark region

is promoted. However, the bright region is compressed. To

expand the dynamic range, the pixel level is further promoted

by bright enhancement by

yHDR

(i,

j)



  

ymix (i, ymix (i,

j) j)





ydark

(i,

j)

 Thb

2



0.005　if 　if

　ydark 　ydark

(i, (i,

j) j)

 

Thb Thb

.

(5)

III. Simulations and Comparisons

To simulate the proposed HDR performance, various

image types are sampled for testing. First, we estimate with

and without using maximum fill in the inverse kernel. Figure

3(a)-(c) show the original sampling image, and HDR

processing without and with 22 maximum fill operation.

Clearly, the detail "line" and edge will be disappeared when

show the extreme type, where many pixels that are near to negative and positive saturation locate on low and high levels at the same frame. The FCSCM [4] can reduce MB value and improve the image quality. Our algorithm can adaptively compute k value to suit for various images for HDR image generation. Results show that our algorithm can achieve lower HB and better image quality than [4]. Next, the dark-type images are tsted, the results are shown in Fig. 5 (a)-(c). For dark type, the k value is adaptively to higher to compensate the dim region efficiently. Finally, we test the bright type. This type may contain positive saturation pixels. According to our algorithm, k is adapted to be small. The high-level pixels of too bright region can be reduced to avoid positive saturation. Results are shown in Fig. 6(a)-(c). Clearly, the positive saturation pixel can be reduced in histogram distribution. From these results, the proposed method indeed improves the image quality in objective view, and better HB value for subjective measurements.
For objective evaluation, Table 2 listed the HB value of all testing images for original ones, and the results of [4] and the proposed method respectively. In average, our HB value can

(a)

(b)

(c)

Fig. 3(a) is original image, Fig. 6(b) HDR processing without

22 maximum fill, Fig. 6(c) HDR processing with 22

maximum fill.

HDR processing without using 22 maximum fill. Hence

22 maximum fill operation is required for our proposed

algorithm to keep the detail thin information.

In order to estimate the performance of HDR algorithm

by subjective measurement, we defined the parameter HB

(histogram balance) as

 HB  255 h(i)  height  width

i0

256

(6)

. where the frame size is height x width. Since the image

resolution is 8 bits, the gray level is 256. So the average

histogram of each level is (height x width)/256. The symbol

h(i) is the counting number of the ith level in a histogram.

When each h(i) is close to average histogram, HB becomes

smaller. This denotes that the distribution of each gray level is near to uniform, such that the dynamic range of image is wider to achieve better HDR performance.
For comparisons, we select one HDR algorithm based on FCSCM(Fast centre–surround contrast modification,) approach [4] using one time exposure for the single frame processing. This algorithm can solve the problem of underand over-exposed sampling. The sampling image is processed by FCSCM and the proposed algorithm for objective and subjective evaluations. We select the sampling image with extreme, dark and bright type for testing. Figures 4(a)-(c)

4(a) HB=409432 4(b) HB=360508 4(c) HB=307974 Fig. 4 (a)-(c) show the original image, and the result of [4] and the proposed method for extreme type.
5(a) HB=479788 5 (b) HB=378626 5 (c) HB=323734 Fig. 5 (a)-(c) show the original image, and the result of [4] and the proposed method for dark type.

6(a)HB=247890

6(b)HB=241132 6(c)HB=227234

Fig. 6 (a)-(c) show the original image, and the result of [4] and the proposed method for bright type.

226

Table 2 Average HB of 8 pictures using difference methods
reduce about 18 % of original image. Compared with the competing algorithm [4], our method can reduce it about 8%. Clearly, the proposed HDR algorithm can achieve better performance in both of objective and subjective test.
IV. Conclusions In this paper, we present a high-performance HDR algorithm using only one exposure time. Based on LCD backlight principle, the inverse pattern is adaptively generated to according to the imaging dat. Using the frame type classification, the HDR algorithm can adaptively compute the parameter to suit various image features processing. Results shown the proposed algorithm can achieve superior HDR image either under-exposed or over-exposed regions. The resulted HDR images look like natural scene without the effects of halo and art-made. Additional, the algorithm used one-pass processing instead recursive processing, which can save more computational cost. For subjective measurement, we present HB parameter to evaluate the performance of HDR algorithm. The HB value can be improved by 18% and 8% compared with the original image and the result of competing method [4] on average, respectively. With high-performance and low computations, the proposed algorithm can be applied on a real-time camera imaging system.

“Gradient-based synthesized multiple exposure time color HDR image,” IEEE Transactions On Instrumentation And Measurement, vol. 57, no. 8, pp. 1779–1785, Aug. 2008. 3. A. Vavilin, and K-H. Jo, “Fast HDR image generation
from multi-exposed multiple-view LDR images,” in Proc. IEEE Int. Conf. European Workshop on Visual Information Processing, pp. 105-110, 2011. 4. V. Vonikakis, I. Andreadis, and A. Gasteratos, “Fast centre–surround contrast modification,” IET Image Process., vol. 2, no. 1, pp. 19–34, 2008. 5. Y. Qi. Huo, and Q.C. Peng, “Evaluation of HDR tone mapped image and single exposure image,” in Proc. IEEE Int. Conf. on Computational Photography, pp. 4850, 2011. 6. S. Mann, R. C. H. Lo, K. Ovtcharov, S. Gu, D. Dai, C.Ngan, and T. Ai, “Realtime HDR (high dynamic range) video for eyetap wearable computers, fpga-based seeing aids, and glasseyes (eyetaps),” in Proc. IEEE Int. Conf. 25th IEEE Canadian Conference on Electrical and Computer Engineering (CCECE), pp. 1-6, 2012. 7. G. Guarnieri, S. Marsi, and G. Ramponi, “High dynamic range image display with halo and clipping prevention,” IEEE Transactions on Image Processing, vol. 20, no. 5, pp. 1351-1362, May 2011.

REFERENCES
1. Ramachandra, M. Zwicker, and T. Nguyen, “HDR imaging from differently exposed multiview videos,” in Proc. IEEE 3DTV-CON'08, pp. 85-88, May 28-30, 2008, Istanbul, Turkey.
2. A. R. Várkonyi-Kóczy, A. Rövid, and T.Hashimoto,

227

