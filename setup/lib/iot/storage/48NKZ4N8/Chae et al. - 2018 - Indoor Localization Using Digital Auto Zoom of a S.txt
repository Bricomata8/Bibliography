Indoor Localization Using Digital Auto Zoom of a Smart-phone Camera and Integrated Sensors
Yoonsung Chae, Duy Thong Nguyen, Sangcheol Park, Youngil Park* Department of Electronics Engineering, Kookmin University 77 Jeongneung-ro, Seongbuk-gu, Seoul 136-702, Korea E-mail: yschae@kookmin.ac.kr, ypark@kookmin.ac.kr*

Abstract — In this paper, we introduce a new indoor localization system that receives a reference information from LED lamps and utilizes smart-phone sensors in tracking the device. To receive data from LED lamps placed at high ceiling, a digital auto zoom based optical camera communication (OCC) scheme is used in increasing the transmission distance. In addition, a magnetic sensor, a gyro sensor, and an acceleration sensor are effectively combined to realize a precise pedestrian dead reckoning (PDR) system. In this paper, we provide algorithms to implement the proposed schemes and show the experimental results.
Keyword —Optical Camera Communication(OCC);light emitting diode; digital zoom; rolling shutter; indoor positioning; pedestrian dead reckoning(PDR); smartphone.
I. INTRODUCTION Indoor localization is a way to find the position of people or objects in a building or underground, where GPS signal is not reached. Numerous applications can be found including indoor navigation, parking assistance, and autonomous robot, etc. A variety of researches are being conducted on location recognition by combining Wi-Fi or Bluetooth signals embedded in smart devices. One of the disadvantages of this method is that radio signal strength is not just a function of the distance. The best way to solve this problem is to compensate for the variation depending on the location and the device, which is very complicated process. In this paper, we propose an indoor position recognition system by combining optical camera communications (OCC) using digital auto zoom of a camera and pedestrian dead reckoning (PDR) using sensors integrated in a smartphone. OCC is a way of communications where a camera image sensor receives data from LED lamps[1], which is common in everyday life; thus, it can be used conveniently by users. Since this scheme uses a built-in camera of a smartphone, it is a more efficient communication method than photodiode-based VLC. However, one of the problems of the OCC is its distance limit. In this paper, we solved this problem using digital auto zoom. PDR is a positioning scheme that estimates one’s location by using a previously determined position and measured values from various sensors[2]. In this paper, our PDR system is a position measurement method that estimates the position using the previously determined position and the measured value of the smartphone built-in sensor.

This is an efficient way to track motion, but it has the disadvantage of error accumulation. In this study, therefore, we combine these two schemes to increase the accuracy of indoor positioning systems.
Many studies on OCC-based indoor localization are based on triangulation method using multiple LEDs on the ceiling; these LEDs should have different colors [3] or transmit their own location information [4]. However, it is not easy to receive multiple LED images from a single camera. Therefore, it is expected that the proposed scheme combining digital zoom-based OCC and PDR can provide more practical way of indoor localization[5].
II. PRINCIPLES OF THE PROPOSED INDOOR POSITIONING In this paper, the indoor localization system is implemented by combining OCC and PDR system. Fig. 1.shows the algorithm of the proposed system. In the beginning, it reads the position information from the LED lamp and the magnetic sensor output, which are used to find the initial orientation of the mobile device. Then calculate two parameters: distance and direction. The former can be obtained from accelerometers and gravity data, and the latter from magnetometer and gyroscope. A magnetic sensor is highly disturbed near ferromagnetic materials such as metal doors or electronic devices. Therefore, the magnetic sensor is used only in the beginning of the application, then, is replaced by a gyroscope data. Location is updated constantly by calculating these distance and direction information. By the way, the device check if there is a new valid LED information; if it is, then the new position information from the LED becomes the new starting point of the localization.
III. AUTOMATIC DIGITAL ZOOM BASED OCC As mentioned in the above section, information on the absolute position is received from the LED signal. Each LED lamp has its own ID and broadcast this information over the light signal from the LED. The OCC method of this paper is based on the principle of a CMOS image sensor - a rolling shutter pattern. It is possible to achieve a rather high data rate using this scheme;

978-1-5386-4646-5/18/$31.00 ©2018 IEEE

567

ICUFN 2018

but, the problem is that the distance is limited within a meter or less. To increase the transmission distance, we suggest to use the digital zoom function of a digital camera. Fig. 2 shows the difference in rolling shutter pattern between digital zoom and optical zoom. With the optical zoom, the number of rolling shutter patterns increases, which is required to receive the increased the amount of data. However, since the location of the lens has to be moved in this case, it is not easy to install the optical zoom function in a smart-phone. Instead, a digital zoom is used in a smart-phone camera.

Start

NO

OCC with Digital Auto Zoom

Valid LED info?

Find LED ? YES(ZOOM IN)

YES

NO

Read LED info & Gravt

Accelm,Gravt : step length

Magn and Gyro :direction

Magn: magnetic sensor Accelm: accelerometer Gravt : gravity Data gyro:gyroscope

Location Calculation

Pedestrian Dead Reckoning Fig. 1. Algorithm of the LED Indoor positioning process

(a)

(b)

(c)

Fig. 2. Comparison of optical zoom and digital zoom

(a) original image without zoom (b) optical zoom (c) digital zoom

Digital zoom does not increase the amount of total data, but increases the resolution of LED on-off pattern, which makes the data decision easier. Fig. 2 compares the effect of digital zoom and optical zoom. The original rolling-shutter image without zoom in Fig. 2(a) shows only 2 lines/bit, which is not enough for the precise measurement. If optical zoom is used, then more signals can be detected as shown in Fig. 2(b); but, the problem is

that optical zoom can’t be installed in most smartphones. If digital zoom is used instead, the image becomes like Fig. 2(c), where as many as 8 lines/bit are measured. More lines per each bit means easy detection process, leading to better transmission performance. The appropriate digital zoom varies with distance, and the selection algorithm helps finding the right value. In this paper, the appropriate zoom is selected automatically by on-off ratio of the pattern.
As the distance from the LED becomes larger, the rollingshutter pattern becomes smaller, and the camera cannot detect any information for most of the time. To solve this problem, the same data is transmitted in multiple times, and the number of repetition is proportional to the distance.

IV. PDR SYSTEM USING SMARTPHONE SEONSORS The PDR system used in this paper can be divided into two parts - direction and distance. The accuracy of the PDR system is determined by how each sensor value is used. When implementing a PDR using only sensors, error from sensors accumulate to create large amount of location error. To resolve this issue, the absolute location should be updated using OCC, periodically. However, between LED lamps the location should be updated using sensors. For this purpose, characteristics of each sensor is investigated to reduce error.

A. Magnetometer and gyroscope

Among various smartphone sensors, magnetometer and gyroscope help determine the direction of the movement. However, both sensors are subject to numerous errors under various conditions as shown in Fig. 3. This paper proposes how to choose among magnetometer and gyroscope according to different environment for determining the direction of the PDR system( Dt ). Fig. 3(a) and (b) show that the magnetic sensor has a large error when a ferromagnetic object is close to it. On the contrary, it is shown from Fig. 3(c) and (d) that the gyroscope has a continuous small error, but it is not negligible for the localization since the error is accumulated in the calculation of the direction. To solve this problem, this paper utilizes magnetometer and gyroscope as shown in equation (2). The initial direction is decided by the magnetometer output, M, since it provides the absolute direction. Then, the following direction is adjusted by the gyroscope output G(t) as in equation (2).

D(0)  M , D (t) D(0)   G(t)dt

(2)

In this process, the error term included in G(t) accumulates with time. Therefore, when the strength of magnetometer is stable for a while, the direction is readjusted to the value from the magnetometer, periodically.

568

B. Acceleration sensor (Gravity sensor) The acceleration sensor can be used for two purposes in this
study. The first is to calculate the step size of the pedestrian and the second is to measure the slope of the smartphone when it receives information from an LED lamp. In the case of step size, the time between the peak values of the acceleration is used to determine the time taken for a step, and the distance traveled through the value from the highest value to the lowest value of the acceleration can be calculated. In order to know the angle of the smartphone from the LED, a gravitational acceleration value is needed. When receiving LED information, the distance between the LED lamp and the smartphone can be calculated using the angle between them.

1857

1793

1601 1665 1729

1409 1473 1537

1345

1217 1281

1

1 86

22 43 64 85 106

171

127 148

256

169 190

341

211 232

426

253 274

511

295 316

400
350
300
250
200
150
100
50
0
Magn Gyro
(a)
400 350 300 250 200 150 100 50
0
Magn Gyro
(c)

596

337 358

681

379 400

766

421 442

851

463 484

936

505 526

1021

547 568

1106 1191 1276

589 610 631 652 673 694 715

1361

736 757

1446

778 799

1531

820 841

1616

862 883

1701

904 925

1786

946 967

988

400 350 300 250 200 150 100
50 0
450 400 350 300 250 200 150 100
50 0

1

1

65

49 97

129 193 257

145 193

321 385 449

241

513

289

577 641

337

705

385 433

769 833 897

481 529

961 1025 1089

Magn Gyro
(b)
Magn Gyro
(d)

1153

913

817 865

721 769

673

625

577

Fig.3. Output from gyroscope and magnetometer during rotation (a) normal condition (b) nearby magnet (c) walking at normal speed (d) walking at high speed

TABLE II.PARAMETERS IN THE EXPERIMENT

Parameter Encoding Transmitter
LED Modulation frequency
Smartphone Resolution of display
Data rate

Value Manchester coding Arduino with LED Driver
15W white LED 25 kHz LG-F700 640480 1800 bps

Estimation of a reference position is made using the OCC with the LED lamp. Then, this value is used to compensate for the accumulated error from the PDR. In the experiment of this study, two LED lamps, ‘LED A’ and ‘LED B’, are used to provide the reference position. The corrected error varies within 0.2 to 1.0 meter with average value of 35cm.
A pedestrian walks inside a building with a smartphone, where the proposed algorithm is installed. Fig. 4(a) shows the map of the building, where a person moves along about 70 meter path indicated in green line. The yellow rectangles indicate the position of LEDs and the on/off pattern in the bottom left indicates rollingshutter image received from the LED. Fig.4(b) shows the route traced by the algorithm when the pedestrian is moving in counterclockwise, while Fig.4(c) shows the case in clockwise. It is seen from the experiment that less than 1 meter error is found from the PDR, and this error is removed by OCC.

Equation (2) shows the calculation of the distance using the

output from between the

tLheEDaccaenldertahteiosnmsaerntspohro(n‫ܣ‬e௫.

,

‫ܣ‬௫

,

‫ܣ‬௭

)

and

the

height(

H

)

Dist H  AX 2  AY 2 / AZ

(2)

The calculated distance using the slope angle of the smartphone

shows the average error of about 10 cm, meaning that the error of

reference position is bounded by this value.

V. RESULTS AND DISCUSSIONS We conducted the experiment described in the previous section. An Arduino microprocessor is used in encoding in the transmitter. Information on the location stored at Arduino is converted to optical signals using an LED driver and a lamp. A smartphone uses its built-in camera to receive a light signal from the LED lamp and decode the position data. At the same time, the smartphone uses its sensors to implement the PDR system. Table II shows parameters used in the experiment.

(a)

(b)

(c)

Fig. 4. Experiment results of the proposed localization algorithm

(a) map of the experiment (b) moving in counterclockwise (c) moving in

clockwise

VI. CONCLUSIONS In this paper, we propose an indoor localization system based on OCC and PDR schemes. Enhancement of the OCC distance is essential, and this function is implemented using a digital auto zoom. Finally, more than 6 meter transmission is achieved in the experiment. By the way, algorithms on the efficient use of smartphone sensors are suggested for implementing a precise

569

PDR. The proposed system is successfully demonstrated with two reference LED lamps.
ACKNOWLEDGEMENTS
This work was supported by Basic Science Research Program through National Research Foundation of Korea (NRF2015R1D1A1A01059416) funded by the Ministry of Education.
REFERENCES [1] C. Danakis, M. Afgani, G. Povey, I. Underwood, and H. Haas, “Using a
CMOS camera sensor for visible light communication,” IEEE Globecom Workshops, pp. 1244–1248, 2012. [2] A. Pratama, Widyawan, R. Hidayat “Smartphone-based Pedestrian Dead Reckoning as an Indoor Positioning System”, International Conference on System Engineering and Technology, Sep. 11-12, 2012. [3] Bangjiang Lin, Zabih Ghassemlooy, Chun Lin, Xuan Tang, Yiwei Li, and Shihao Zhang, “An Indoor Visible Light Positioning System Based on Optical Camera Communications”, IEEE PHOTONICS TECHNOLOGY LETTERS, VOL. 29, NO. 7, APRIL 1, 2017. [4] Md. Tanvir Hossan, Mostafa Zaman Chowdhury, Amirul Islam, and Yeong Min Jang,“A Novel Indoor Mobile Localization System based on Optical Camera Communication”,Wireless Communications and Mobile Computing,Vol 2018, pp. 1-17, 2018. [5] Seungwoo Hyun, Yunhyeong Lee, Jungho Lee, MinChul Ju, and Youngil Park,“Indoor Positioning Using Optical Camera Communication & Pedestrian Dead Reckoning”, Ubiquitous and Future Networks(ICUFN), pp. 64-65, 2015. [6] Yoonsung Chae, Duy Thong Nguyen, Youngil Park, "Transmission Distance Enhancement of Rolling-Shutter Based Optical Camera Communications Using Digital Zoom", The Journal of Korean Institute of Communications and Information Sciences, Vol.42 No.09, pp. 1765-1770, Sep. 30, 2017.
570

