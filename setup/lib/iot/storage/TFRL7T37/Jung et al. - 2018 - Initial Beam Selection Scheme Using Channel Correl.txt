Initial Beam Selection Scheme Using Channel
Correlation Matrix in mmWave Massive MIMO
Systems
Jaemin Jung∗, Heeyoung Kim∗, Seongbae Han∗, Youngrok Jang∗, Seokki Kim†, Seungkwon Baek†, and Sooyong Choi∗
∗School of Electrical and Electronic Engineering, Yonsei University, Seoul, Korea. Email: {jjmm1000, khy93, hsb1531, dynamics, csyong}@yonsei.ac.kr
†Electronics and Telecommunications Research Institute (ETRI), Daejeon, Korea Email: {kimsk0729,skback}@etri.re.kr

Abstract—For millimeter wave (mmWave) massive multipleinput-multiple-output (MIMO) Xhaul systems, an initial beam search technique based on the maximum value of the codebook multiplied by the channel correlation matrix is proposed. Simulation results show the proposed initial beam selection scheme reduces complexity by more than 95% and improves up to 24% gain in terms of achievable rate compared with the conventional turbo-like tabu beam search algorithm with a random initial beam selection.

Fig. 1. Block diagram of mmWave MIMO system.

I. INTRODUCTION
The exponential growth of the ﬁfth-generation (5G) wireless communication is expected in order to support a lot of devices and high data trafﬁcs [1]. Therefore, evolution of fronthaul and backhaul between the radio access network and packet core is necessary. Recently millimeter wave (mmWave) Xhaul which integrates fronthaul and backhaul using the mmWave in wireless communication systems has been considered as a promising solution [2][3]. However, path loss is one of the major problems in mmWave systems. To solve this problem, mmWave systems use massive multiple-input-multipleoutput(MIMO) systems which use large antenna arrays to combat path loss [4].
In massive MIMO systems, a beamforming (including transmit precoding and receiving combining) technique is required [5]. mmWave Xhaul networks with massive MIMO systems usually use codebook-based beamforming techniques [6]. The optimal codebook-based beamforming scheme is exhaustive beam search method [7]. However, the exhaustive beam search method is too high complex to use in practical. Therefore, many low-complexity beam search schemes have been studied [8][9].
The initial beam selection is important for the conventional beam search scheme using tabu search algorithm [10][11]. In this paper, we introduce how to select an initial beam of tabu search algorithm using channel correlation matrix. To select the initial beam, we ﬁrst obtain the modiﬁed codebook by multiplying channel correlation matrix to existing codebook. Then, a codebook vector which has the maximum power in the modiﬁed codebook is selected as the initial beam

for the conventional beam search scheme using tabu search algorithm in order to reduce the complexity and improve the performance.
The rest of the paper is organized as follows. Section II presents the system model that describes the Xhaul network, massive MIMO systems and channel model considered in this paper. Section III explains the conventional turbo-liked tabu beam search algorithm brieﬂy and introduces the proposed scheme. Section IV presents the simulation results. Finally, Section V concludes this paper.
Notation: A is a matrix, a is a vector and a is a scalar. Ai,j is the i th row and j th column element. IN is the N × N identity matrix. (·)−1, (·)T , (·)H , E(·), and det(·) denote inversion, transpose, conjugate transpose, expectation, and determinant of a matrix, respectively. (A)F denote the Frobenius norm of matrix A.

II. SYSTEM MODEL

We consider the communication links between two Xhaul

units. As shown in Fig. 1, the transmit Xhaul unit (transmitter)

employs Mt antennas and NtRF RF chains to simultaneously transmit Ns data streams to the receive Xhaul unit (receiver) with Nr antennas and NrRF RF chains. To fully achieving the spatial multiplexing gain, we assume NtRF = NrRF = Ns
[12]. Under the narrowband block fading massive MIMO

channel [12], the presented as y =

r√ecρeCivHAedHsPigAnasl+vCecHAtonr y, wathtehree

receiver s is the

can be Ns ×1

data streams with E[ssH] = 1. ρ denotes the transmit power

and n ∼ CN (0, σ2INr ) is the independent and identically

978-1-5386-4646-5/18/$31.00 ©2018 IEEE

744

ICUFN 2018

distributed (i.i.d) additive white Gaussian vector. PA and CA are the Nt × Ns analog precoding matrix and the Nr × Ns analog combining matrix, respectively. Since PA and CA are

the analog beamforming matrices [13], all elements should be

satisﬁed with pAi,j = 1/Nt and cAi,j = 1/Nr, where i and j denote the indexes of the row and column, respectively.

Considering Saleh-Valenzuela channel model [12], a

Nt × Nr channel matrix H can be expressed as H =

L

NtNr L

αlfr (φrl ) ftH (φtl ), where L is the number of scat-

l=1

ters and αl ∼ CN (0, 1) is the complex gain of lth path. φtl and

φrl are the angle of departures (AoDs) and angle of arrivals

(AoAs) of the lth path, respectively. The vectors ft(φtl ) and

fr(φrl ) are the normalized transmit and receive array response

vectors respectively. According to [14], the array response

vector f (φ) for an N -element uniform linear array (ULA)

is given by

f (φ) = √1

1, ejkd sin(φ), . . . , ej(N−1)kd sin(φ)

T
,

(1)

N

where

k=

2π λ

and

d

is

antenna

spacing.

In this paper, we use codebook-based beamforming. Let F

and W are the codebooks for analog precoding and combining

matrices, respectively. Using (1), the analog precoding and

combining matrices PA and CA are represented as

PA = ft φ¯t1 , ft φ¯t2 , . . . , ft φ¯tNtRF ,

CA = fr φ¯r1 , fr φ¯r2 , . . . , fr φ¯rNrRF ,

respectively, where φ¯ti is the quantized AoD for i th RF chain (i = 1, ..., NtRF ) and φ¯rj is the quantized AoA for j th RF chain (j = 1, ..., NrRF ). The number of bits for codebooks, F and W, as Bt and Br, respectively. Then, transmitter and receiver have 2Bt NRt F and 2Br NRr F possible candidates,
respectively. By the joint search for the codebooks, F and W,

the optimal beamforming pair is selected with the maximum

achievable rate as

R

=

max
PA ∈F,CA

∈W

log2

INS

+

ρ Ns

R−n 1CHA

HPHA

PAHH

CA

,

(2)

where Rn is the covariance matrix of noise after processing the analog combining matrix [12].

III. CONVENTIONAL TURBO-LIKE TABU BEAM SEARCH ALGORITHM AND PROPOSED INITIAL BEAM SELECTION
SCHEME
In this section, we introduce the conventional turbo-like tabu beam search algorithm [11] and the proposed initial beam selection scheme.

A. Turbo-like tabu beam search algorithm
The turbo-like tabu beam search algorithm [11] consists of two loops. The inner loop is a tabu search algorithm, that is transmitter and receiver search beamforming matrices using the tabu beam search algorithm. The outer loop is a turbo-like

joint search. During the turbo-like joint search, transmitter and receiver search a beam pair jointly based on the beamforming matrices resulting from the tabu beam search algorithm. The turbo-like tabu beam search algorithm can be operated as follows.
1) Neighborhood Deﬁnition: First, the neighborhood set of the initial beam should be deﬁned in order to select the analog beamforming matrices. For example, when NRt F = 1, Bt = 2, and an initial beam at transmitter is PA = ft(3φ/2), the neighborhood set is [ft(2φ/2), ft(4φ/2)].
2) Achievable Rate Computation: After deﬁning the neighborhood set of the initial beam, the transmitter (receiver) computes achievable rates of all the possible combinations in the neighborhood set by using (2).
3) Beam Update: Using the obtained achievable rate, transmitter (receiver) selects the beamforming matrix having the highest achievable rate as a candidate beam. Then we compare the candidate beam with the selected beam. If the candidate beam has the higher rates than the selected beam, the candidate beam becomes the selected beam. If not, the selected beam is maintained. After the beam update is done, we return to 1). The processes from 1) to 3) repeat until the tabu iterations reach the deﬁned maximum iteration or the selected beam does not change during the deﬁned maximum update period.
4) Turbo-Like Joint Search: After the tabu beam search process from 1) to 3) (i.e., inner loop), transmitter (receiver) sends the selected beam to the receiver (transmitter) to search the optimal beam using the tabu beam search algorithm. Then the transmitter and receiver repeat this procedure until the deﬁned turbo iteration.

B. Proposed Initial Beam Selection Scheme

In this subsection, the proposed initial beam selection scheme is presented. To select an initial beam, we multiply channel correlation matrix to the existing codebook and search the best beam pair. By a kronecker MIMO channel model [15], a channel matrix H can be expressed as

H = R1r/2HwR1t /2,

(3)

where every entries of Hw is an i.i.d complex Gaussian random variable with zero mean and unit variance and R1t/2 and R1r/2 denote channel correlation matrices at the transmitter

and receiver, respectively. Based on the channel correlation

matrices R1t /2 and R1r/2, we can modify the existing code-

books as

F′ = R1t /2F, W′ = R1r/2W,

(4)

respectively, where F and W denote the existing codebooks.
As shown in Fig. 2, a modiﬁed codebook can have skewed magnitudes and directions based on the channel correlation matrix. Based on the modiﬁed codebook F′ and W′, we propose a multiple initial beam selection scheme in order to
choose better beam vectors. At the ﬁrst beam selection, the transmitter and receiver choose NtRF and NrRF beam vectors in order of the power in F′ and W′, respectively. Then, at

745

TABLE I SIMULATION PARAMETERS RELATED TO TABU SEARCH

Fig. 2. Modiﬁed codebook using channel correlation matrix for proposed scheme.

the next beam selection, the initial beam selection can be performed by choosing NtRF and NrRF beam vectors except the previous selected beam.

C. Complexity Analysis
In this subsection, we analyze the complexity of the proposed scheme and compare with that of the conventional turbolike tabu beam search algorithm. We also consider the fullsearch algorithm (i.e., exhaustive search) as in [7].
The complexity of the full-search algorithm CF S can be expressed as

CF S = 2Bt × NtRF 2Br . NrRF

(5)

As shown in (5), the complexity of the full-search algorithm

depends on the codebook bit. In contrast, the complexity of

the conventional tabu beam search algorithm does not depend

on the codebook bit since the tabu search compares beams

in the neighborhood set. The complexity of the conventional

turbo-like tabu beam search algorithm CT S can be expressed

as

CT S = 2NtRF · T + 2NrRF · T M K,

(6)

where T , M , and K denote tabu beam search iteration, number of joint search iteration, and number of initial beam selection of conventional turbo-like tabu beam search algorithm, respectively. The proposed scheme requires the Nt + Nr extra computations for an initial beam selection. The complexity of proposed scheme CP S can be expressed as
CP S = Nt + Nr + 2NtRF · T + 2NrRF · T M K. (7)

Using the proposed initial beam selection scheme, the beam search algorithm converges faster than the random initial beam selection method. To compare the complexity among three beam search algorithms as aforementioned, we consider NtRF = NrRF = Ns = 2 and Nt = Nr = 64 and the simulation parameters related to tabu beam search in Table I. In Table I, max-length denotes maximum update period.
The results of the complexity comparison can be shown in Table II. For the case of Bt = Br = 4, the full search algorithm and the conventional turbo-like tabu beam search algorithm have the almost same complexity. However, the proposed scheme has only 5% complexity of the conventional turbo-like tabu beam search algorithm. As the codebook bit

Codebook bit T
max-length K M

Conventional turbo-like tabu beam search algorithm [11]
4bit/5bit/6bit 400/800/2500 100/200/600
4 5

Proposed scheme
4bit/5bit/6bit 100/200/600 50/100/200
2 2

TABLE II COMPLEXITY COMPARISON

Full-search Conventional turbo-

Proposed Complexity

algorithm [7] like TS algorithm [11] scheme (PS) ratio(PS/TS)

4bit 6.5 × 104

6.4 × 104

3.2 × 103

5%

5bit

1 × 106

1.3 × 105

6.4 × 103

4.9%

6bit 1.7 × 107

4 × 105

1.9 × 103

4.7%

Achievable rate (bps/Hz)

10

4-bit Full search algorithm

9

5-bit Full search algorithm

6-bit Full search algorithm

4-bit Conventional tabu beam search algorithm [11]

8

5-bit Conventional tabu beam search algorithm [11]

6-bit Conventional tabu beam search algorithm [11]

7

4-bit Proposed scheme, M 2
PS

5-bit

Proposed

scheme,

M
PS

2

6

6-bit Proposed scheme, M 2

PS

5

4

3

2

1

0

-30

-25

-20

-15

-10

-5

0

SNR (dB)

Fig. 3. Achievable rate of the full-search algorithm, the conventional tabu beam search algorithm [11], and the proposed scheme for Nt = Nr = 16 with NtRF = NrRF = Ns = 2.

becomes larger, the complexity difference between the conventional turbo-like tabu beam search algorithm and full-search algorithm increases. However, the complexity ratio between the proposed scheme and the conventional turbo-like tabu beam search algorithm (TS) becomes lower.
IV. SIMULATION RESULTS
In this section, we evaluate the achievable rates of the proposed initial beam selection scheme, the full-search algorithm and the conventional turbo-like tabu beam search algorithm in the Saleh-Valenzuela channel model [12]. We assume that AoAs and AoDs are uniformly distributed over [0, π] and the carrier frequency is 28 GHz. The simulation parameters related to the tabu beam search algorithm are shown in Table I.
Fig. 3 shows the achievable rates of the full-search algorithm, the conventional turbo-like tabu search algorithm, and the proposed scheme for Nt = Nr = 16 with

746

25 4-bit Full search algorithm

5-bit Full search algorithm

6-bit Full search algorithm

4-bit Conventional tabu beam search algorithm [11]

20

5-bit Conventional tabu beam search algorithm [11]

6-bit Conventional tabu beam search algorithm [11]

4-bit Proposed scheme, M 2 PS

5-bit Proposed scheme, M 2 PS

15

6-bit

Proposed

scheme,

M PS

2

Achievable rate (bps/Hz)

10

5

0

-30

-25

-20

-15

-10

-5

0

SNR (dB)

Fig. 4. Achievable rate of the full-search algorithm, the conventional tabu beam search algorithm [11], and the proposed scheme for Nt = Nr = 64 with NtRF = NrRF = Ns = 2.

NtRF = NrRF = Ns = 2. The conventional turbo-like tabu beam search algorithm executes M times initial beam selection to guarantee reliable performance since the initial beam selection is randomly selected. For the case of Bt = Br = 4, the proposed scheme has the lower achievable rates than the conventional turbo-like tabu beam search algorithm. However, for Bt = Br = 5 and Bt = Br = 6, the proposed scheme outperforms the conventional turbo-like tabu beam search algorithm. We can also observe that the proposed scheme for Bt = Br = 6 with only 0.2% complexity shows similar performances to the full-search algorithm for Bt = Br = 5.
Fig. 4 shows the achievable rates of the full-search algorithm, the conventional turbo-like tabu beam search algorithm, and the proposed scheme for Nt = Nr = 64 with NtRF = NrRF = Ns = 2. We can observe the similar trends as in Fig. 3. As shown in Fig. 4, the proposed scheme can achieve the 24% improved achievable rates at 0 dB SNR with 95.3% reduced complexity compared to the conventional turbo-like tabu beam search algorithm with Bt = Br = 6. According to the simulation results, we can conclude that the proposed initial beam selection scheme achieves both low complexity and achievable rate improvement over the conventional turbolike tabu beam search algorithm.
V. CONCLUSION
In this paper, we proposed an initial beam selection scheme for the tabu beam search algorithm using channel correlation matrix. The achievable rates and the complexity of the proposed scheme are evaluated. Simulation results show that the proposed scheme can achieve the reduced complexity by up to more than 95% and up to 24% improvement of achievable rate compared with the conventional turbo-like beam search algorithm. Therefore the proposed initial beam selection scheme converges compared with conventional turbolike tabu beam search algorithm to the optimal performance.

ACKNOWLEDGMENT
This work was partly supported by Institute for In-
formation & communications Technology Promotion(IITP)
grant funded by the Korea government(MSIT) (No.2014-0-
00282,Develop- ment of 5G Mobile Communication Tech-
nologies for Hyper- connected smart services) and Institute for
Information& com- munications Technology Promotion(IITP)
grant funded by the Korea government(MSIT)(No.2016-0-
00181,Developmenton the core technologies of transmission,
modulation and coding with low-power and low-complexity
for massive connectivity in the IoT environment)
REFERENCES
[1] Recommendation ITU-R M.2083: IMT Vision - ”Framework and overall objectives of the future development of IMT for 2020 and beyond”, Sep. 2015.
[2] A. D. L. Oliva, X. C. Perez, A. Azcorra, A. D. Giglio, F. Cavaliere, D. Tiegelbekkers, J. Lessmann, T. Haustein, A. Mourad, and P. Iovanna, ”Xhaul: toward an integrated fronthaul/backhaul architecture in 5G networks,” IEEE Wireless Commun., vol. 22, no. 5, pp. 32-40, Oct. 2015.
[3] Y. Niu, Y. Li, D. Jin, L. Su, and A. V. Vasilakos, ”A survey of millimeter wave (mmWave) communications for 5G: Opportunities and challenges,” arXiv preprint arXiv:1502.07228, Feb. 2015.
[4] Z. PiandF. Khan, ”An introduction to millimeter-wave mobile broadband systems,” IEEE Comm. Mag., vol. 49, no. 6, pp. 101–107, 2011.
[5] C. Sheldon, M. Seo, E. Torkildson, M. Rodwell, and U. Madhow, ”Fourchannel spatial multiplexing over a millimeterwave line-of-sight link,” IEEE Int. Microwave Symposium Digest, pp. 389–392, Jun. 2009.
[6] W. Roh et al., ”Millimeter-wave beamforming as an enabling technology for 5G cellular communications: Theoretical feasibility and prototype results,” IEEECommun. Mag., vol. 52, no. 2, pp. 106–113, Feb. 2014.
[7] T. Kim et al., ”Tens of Gbps support with mmWave beamforming systems for next generation communications,” in Proc. IEEE GLOBECOM, Dec. 2013, pp. 3685–3690.
[8] M. S. Rahman and K. Josiam, ”Low complexity RF beam search algorithms for millimeter-wave systems millimeter-wave systems,” in Proc. IEEE Global Telecommun. Conf. (GLOBECOM), 2014, pp. 3815–3820.
[9] W. Yuan, S. M. D. Armour, and A. Doufexi, ”An Efﬁcient and Lowcomplexity Beam Training Technique for mmWave Communication,” in PIMRC, 2015
[10] Lemasri Piniganti, ”A survey of Tabu Search in Combinatorial Optimization,” University of Nevada, Las vegas, United States, May. 2014.
[11] Xinyu Gao, Linglong Dai, Chau Yuen, and Zhaocheng Wang, ”Turbolike beamforming based on tabu search algorithm for millimeter-wave massive MIMO systems,”IEEE Trans. Veh. Technol., vol. 65, no.7, pp. 5731-5737, Jul. 2016.
[12] O. El Ayach, S. Rajagopal, S. Abu-Surra, Z. Pi, and R. Heath, ”Spatially sparse precoding in millimeter wave MIMO systems,” IEEE Trans. Wireless Commun., vol. 13, no. 3, pp. 1499–1513, Mar. 2014.
[13] M. M. Molu, P. Xiao, M. Khalily, K. Cumanan, L. Zhang , and R. Tafazolli, ”Low-Complexity and Robust Hybrid Beamforming Design for Multi-Antenna Communication Systems” IEEE Trans. Wireless Commun., vol. 17, no. 3, pp. 1445–1459, Mar. 2018.
[14] C. Balanis, Antenna theory. Wiley New York, 1997. [15] D. Gesbert et al., ”Outdoor MIMO wireless channels: models and
performance prediction,” IEEE Trans. Commun., vol. 50, no. 12, pp. 19261934, Dec. 2002.

747

