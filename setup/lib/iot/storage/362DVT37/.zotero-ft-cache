An image gradient based LED bit detection algorithm in vehicular optical camera communication

Trong-Hop Do and Myungsik Yoo School of Electronic Engineering, Soongsil University, 06978, Seoul, South Korea

Abstract—Information in vehicular optical camera communication (VOCC) systems is transmitted using LED arrays, which are also vehicle lights functioning both illumination and communication. Logical bits 1 and 0 are conveyed by the status On and Off of LED chips in the array. Cameras are installed in the receiving vehicles to capture the images of these LED arrays. These images are then processed to detect the status On and Off of LED chips and thus obtain the transmitted bits. In current LED bit detection algorithms, the grayscales of LEDs, which is an unreliable feature, is used to determine the LED status and thus have poor performances in unfavorable conditions. This study proposes a new LED bit detection algorithm that exploits gradient vectors in the image to signiﬁcantly increase the detection accuracy even in unfavorable conditions of VOCC system. Simulations are conducted to verify the performance of the proposed algorithm.
Index Terms—vehicular, communication, camera, LED, detection.
I. INTRODUCTION
In recent years, vehicular optical camera communication (VOCC) has appeared as a promising candidate for vehicular communication with many advantages [1]–[3]. In VOCC system, information is transmitted using LED array on vehicles and received using cameras on other vehicles. If it was RF, a precious spectrum must be reserved for vehicular communication to avoid interference with non-vehicular communication. However, the reserved spectrum in each country might be different. Many countries such as Australia even do not have any reserved spectrum for vehicular communication. Using OOC would alleviate this problem since no license is needed to use visible light. Existing lights in a vehicle such as head, tail lights, which serve illuminating purpose, and especially daytime running light (DRL) all can be used as transmitter in VOCC with an implementation of a few additional hardware. Cameras have also become available in most vehicles as dashboard cameras. The availability of LED light and cameras on vehicles would signiﬁcantly reduce the implementation cost of VOCC. However, the most important reason that motivate the use of VOCC is that once VOCC is implemented, vehicle tracking could be achieved easily just by implementing additional software. This is because vehicle identiﬁcation and image coordinate detections, which are major steps in vehicle tracking, are already achieved through VOCC. That is to say, implementing VOCC would bring the vehicle communication

and tracking, which are the two most demanding requirement in future transportation, all together.
Even though VOOC has many potentials, researches on VOCC is just in the beginning phase since the camera technology that allow the possibility of VOCC has just appear in recent years. Therefore, many aspects of VOCC has not been studied deeply. In VOCC, the logical bits 1 and 0 are usually represented by the status On and Off of LED chips in the array. All existing LED bit detection algorithms operate on the basis of comparing the LED grayscale to a threshold to determine the transmitted bits. The problem is that grey scale can be affected by interferences between LEDs in the array caused by many types of image blurriness. Because of this interference, LED chips conveying different logical bits on the same LED array might have similar grayscale, resulting in errors in LED bit detection. The problem is even exacerbated when different LED array from different vehicles might have different luminance which ends up in different grayscales for the same logical bits. All the aforementioned point to the fact that the grayscale is not a reliable feature of LED to rely on when it comes to LED bit detection.
This study does not try to implement a full VOCC system but focus on improving the performance at a single step: LED bit detection. More speciﬁcally, to address the drawback of existing LED bit detection algorithms, this study proposes a new algorithm for LED bit detection which uses the image gradient based feature of LED to distinguish the LED status. The proposed feature has substantially more discriminability of LED statuses than greyscale. Simulations are conducted to verify the performance of the proposed algorithm. The result shows that the proposed LED bit detection algorithm remarkably improves the bit error rate (BER) even in nonideal conditions.
II. FUNDAMENTAL OF VOCC SYSTEM
A. System architecture
A VOCC system with many steps is described in Fig. 1. As previously mentioned, the captured LED array image is processed to extract the transmitted data. There are two image processing steps: LED array coordinate detection and LED bit detection. In LED array coordinate detection, the captured image is processed to detect the coordinate of LED arrays. In LED bit detection, the statuses On or Off of each LED chips

978-1-7281-1340-1/19/$31.00 ©2019 IEEE

617

ICUFN 2019

Fig. 1: VOCC system architecture
in the LED array are detected to obtain the transmitted bits. This study focuses only on the LED bit detection algorithm, which is the most essential step to achieve high BER in VOCC. The LED array coordinate detection steps is assumed to be done beforehand and thus difﬁculties in this step would not be addressed in this study.
B. Existing greyscale based LED bit detection algorithms

C. LED interference caused by image blurriness
Images captured by cameras are subject to many types of blurriness including blooming effect and optical aberrations.
Blooming effect produces fringes of light extending from the borders of objects in the captured image. This phenomenon is caused by the diffraction of light waves when passing through the small apertures of the lens. The blooming effect can be mathematically described as convolving the incoming image with an Airy disk diffraction pattern. The result of the blooming effect is the increasing of greyscales of pixels surrounding an On LED in the captured image. In other words, the greyscale of an Off LED would be increased if due to its neighbor On LEDs.
Besides blooming effect, which is an unavoidable phenomenon caused by the wavelike nature of light, the greyscales of LEDs can also be affected by image blurriness caused by many optical aberrations. These optical aberrations are caused by either the imperfections of lens production as in cases of spherical, comatic, astigmatism, and chromatic aberration or faults in lens operation as in case of defocus aberration. Like blooming effect, these aberrations cause the light to be spread out over a region rather than focused to a point and thus causing the interferences between LEDs in the captured image.
While the lens production related aberrations can be improved by using a high quality lens, defocus aberration is inevitable in the operation of a VOCC system since a lens can focus at only vehicles inside its plane of focus and leave other vehicles in the street unfocused as illustrated in Fig. 3.

Fig. 2: Grayscale based LED bit detection

Indeed, detecting the status On and Off of LEDs in a clear image is fairly easy once the LED array is located. As described in Fig. 2, the status of each LED chips can be determined simply by comparing the grayscale of each LED chip to a predetermined threshold. The grayscale of LED chip can be either the grayscale of the center pixel or the weighted average grayscale of all pixels of the LED chip. The threshold can be a ﬁxed ofﬂine value determined through experiments or an adaptive online value determined through preamble frames while the system is running.
All LED bit detection algorithms in existing works on OOC are just that simple. This is reasonable since the focuses of these works is not on LED bit detection. Also, simulations and experiments in these works were conducted in controlled environments favorable to the LED bit detection and thus the simple grayscale based algorithm is sufﬁcient for LED bit detection. However, in unfavorable condition, the grayscale of LED is affected by many noise sources, which are explained in the following section, and results in error it bit detection.

Fig. 3: Defocus blur of objects outside the focus plane

III. PROPOSED ALGORITHM
The greyscale of LED is affected by neighbor LEDs due to LED interference. To deal with this problem, the image gradient vectors of LED are used to measure the impacts of neighbor LEDs. Image gradient vectors represent directional change in the greyscale of an image calculated as:

∇f (x, y) =

DX DY

,

(1)

where f (x, y) is the greyscale at the coordinate (x, y) in the image, DX and DY are partial derivatives of the image greyscale in horizontal and vertical dimension.
Image gradient vectors have the direction from dark pixels to bright pixels in the image. Therefore, an On LED should have gradient vectors pointing inward while an Off LED should have gradient vectors pointing outward. The difference

618

in the overall direction of gradient vectors of On and Off LEDs can be measured by calculate the dot product between the gradient vector and the normalized radial inward vector at each pixel of LED. Consequently, the image gradient feature (IGF) is deﬁned as:

IGF = ∇g(x, y) · r(x, y) , number of pixels

(2)

where ∇g(x, y) is the gradient vector in each pixel inside the LED region, (·) represents the dot product operation, and r(x, y) is the normalized radial inward vector at the corresponding pixel given by:

r(x, y) = (xc − x, yc − y)

(3)

(xc − x, yc − y)

where (xc, yc) is the coordinate of the center pixel of the LED and v denotes the magnitude of a vector v. In other words, normalized radial inward vectors are unit vectors with the magnitude of one and the direction pointing to the LED center. Since the dot product of two vectors is positive when they are codirectional and negative when they are contradirectional, On LEDs tend to have positive IGF while Off LEDs tend to have negative IGF.

IV. SIMULATION
The simulations are conducted with an 1-inch (13.2mm × 8.8mm) sensor with Full-HD (1920 × 1080 pixels) video recording. The lens focal length is 18mm. The frame rate of the camera is 100fps. To avoid the motion blur effect, the exposure time is set to 1/1500s. LED is assumed to have a circular shape with diameter of 3cm. The inter-distance between LEDs in the array is 3cm. The LED panel is assumed to consist of 8 × 8 LEDs. The LED luminance ranges from 2000 to 4000cd/m2. The illuminance of ambient light ranges from 1000 to 32000lux. The average reﬂectance of background is assumed to be 0.18. The testing communication distance in the simulation ranges from 30 to 70m. The blooming and blurriness level of replicated images in the simulation is assumed to be 1.5pixels.
To evaluate the performance of the proposed algorithm, 20000 LED panel frames are replicated with system parameters randomly set within the ranges explained above. The BERs of the proposed algorithm and the existing greyscale based algorithm are calculated at different range of contrast level between On and Off LED. The simulation results is shown in Fig. 4. It can be seen that the proposed algorithm achieves much lower BER at all level of contrasts.

Fig. 4: BERs at different contrasts
of the proposed algorithm. Since the proposed image gradient based feature has much more discriminability of LED status, the proposed algorithm achieves much lower BER in all situations of the system.
ACKNOWLEDGMENT
This research was supported by the Basic Science Research Program through the National Research Foundation of Korea (NRF), funded by the Ministry of Education, Science and Technology (NRF-2018R1A2B6004371)
REFERENCES
[1] Yamazato, Takaya, et al. Image-sensor-based visible light communication for automotive applications. IEEE Communications Magazine 52.7 (2014): 88-97.
[2] Goto, Y., Takai, I., Yamazato, T., Okada, H., Fujii, T., Kawahito, S., Arai, S., Yendo, T. and Kamakura, K., 2016. A new automotive VLC system using optical communication image sensor. IEEE photonics journal, 8(3), pp.1-17.
[3] Takai, Isamu, et al. Optical vehicle-to-vehicle communication system using LED transmitter and camera receiver. IEEE Photonics Journal 6.5 (2014): 1-14.

V. CONCLUSION
This paper proposed an image gradient based LED bit detection algorithm in vehicular optical camera communication. All existing algorithms use the greyscale of LED as the discriminant feature. However, the greyscales of LEDs are greatly affected by the interference from neighbor LEDs and hence existing algorithms have poor performance in non-ideal condition. Simulations are conducted to verify the performance

619

