Automatic Sleep Stage Classification using EEG and EMG signal

Hyungjik Kim Dept. of Secured Smart Electric Vehicle
Kookmin University Seoul, Korea
bluenara1004@nate.com

Sunwoong Choi Dept. of Electrical Engineering
Kookmin University Seoul, Korea
schoi@kookmin.ac.kr

Abstract— Sleep is a primary constituent of human life. It is important to maintain good sleep efficiency because some problems occur when sleep efficiency is low. Sleep efficiency is calculated by the ratio of sleep stages. Sleep stages can be classified using Polysomnogram (PSG), which includes information of EEG, EMG and EOG. There have been many studies to classify sleep stages automatically using EEG signal. They, however, have difficulty in classifying several sleep stages because of the resemblance of EEG signals, especially, REM and Non-REM1 (N1) stage. We propose to use EMG signal in addition to EEG signal to improve the accuracy of sleep stage classification. EMG signal is useful for classifying REM stage and Non-REM stages. We propose a machine learning model of Support Vector Machine (SVM) using EEG and EMG signal. The proposed model shows higher classification rate for REM and N1 stage than EEG only model.
Keywords. Sleep Stage Classification, SVM, EEG, EMG.
I. INTRODUCTION
Sleep is a primary constituent of healthy life. Analyzing sleep efficiency, we predict whether a person has to live a healthy life. If sleep efficiency is low, some problems occur in human life. [1][2]. Major depressive disorder, bipolar disorder, and schizophrenia can be occurred by sleep efficiency problems. It is important to maintain good sleep efficiency because these problems cannot lead to normal life.
Sleep efficiency can be determined by analyzing Polysomnogram (PSG). PSG includes information of electroencephalogram (EEG), electromyogram (EMG), electrooculogram (EOG). We can analyze this information to classify sleep stages. Sleep stages are classified five stages, Wake (W), Non-REM1 (N1), Non-REM2 (N2), Non-REM3 (N3) and Rapid Eye Movement (REM) stage, based on American Academy of Sleep Medicine (AASM) manual [3]. Each sleep stage is classified every 30 seconds of information in PSG and 30 seconds is called an epoch [4]. Sleep efficiency is calculated by the ratio of sleep stages above process. However, sleep stage classification takes a long time consuming because experts analyze PSG, so it is necessary automatic sleep stages classification.
Many studies use EEG signal to classify sleep stages automatically [5-7]. EEG signal contains information to classify sleep stages. However, using an EEG signal is difficult to classify all sleep stages because of insufficient information. It is difficult to classify sleep stages accurately using EEG only

signals because there are sleep stages where the EEG signal exhibit similar characteristics. EEG signal of REM, N1 and N2 in sleep stages is especially very similar. N1 stage can be misclassified as REM and N2 can be misclassified as REM. Consequently, other information besides the EEG signal for classification of REM, N1 and N2 stages in needed to improve the accuracy of the sleep stage classification.
In this paper, we propose to use EMG signal in addition to EEG signal to improve sleep stage classification accuracy for REM, N1 and N2 stages. We also use the EEG signal because EEG is the most important indicator for the sleep stage classification. EEG signals have different characteristics in frequency bands at each sleep stages, we use EEG signal by frequency bands. In addition, we use EMG signal because EMG signal is an optimal factor for classifying REM stage and Non-REM stages. REM stage can be easily classified as NonREM stages because the amplitude of EMG signal at REM stage is smaller than N1 and N2 stages. Therefore, we use EEG signal and EMG signal to improve sleep stage classification accuracy about REM, N1 and N2 stages. We improve sleep stage classification accuracy of N1, N2 and REM stages and maintain the accuracy of the well-classified sleep stages W and N3 in previous studies.
The subsequent structure of this paper is as follows: Section II describes the feature of sleep stages in EEG signal and EMG signal. Section III describes the process for creating the automatic model of sleep stage classification proposed in this paper. Section IV presents and discusses the experimental and comparison results of the proposed method. Finally, Section V describes the conclusion.
II. CHARACTERISTICS OF SLEEP STAGE WITH EEG AND EMG
EEG signal is the most important indicator for the sleep stage classification. EEG signal have different characteristics in terms of sleep stages. The amplitude of the EEG signal may vary from person to person, but the forms seen by each sleep stages are similar.
EEG signal has have different characteristics in frequency bands at each sleep stage as shown in Table 1 and Fig. 1 [8]. Table 1 shows which frequency bands are characteristic at each sleep stages. EEG signal in the W stage is faster than that of other sleep stages in Fig. 1. Alpha (>50%) and beta frequency

978-1-5386-4646-5/18/$31.00 ©2018 IEEE

207

ICUFN 2018

appear in W stage. N1 stage is a light sleep at beginning of sleep. N1 stage is low-amplitude, mixed-frequency EEG signal activity. EEG signal in the N1 stage is slower than that of W stage. Alpha (<50%) and theta frequency appear in N1 stage. N2 stage is an intermediate between light sleep and deep sleep. N2 stage occupies the largest portion of the total sleep stages. The sleep spindle and theta frequency band appear. The sleep spindle is well-defined waves in the range 11-15 Hz with time duration of more than 0.5 seconds. There is no criterion for the amplitude of a spindle. N3 stage is a state in which a person sleeps deeply. EEG signal in the N3 stage is slower than that of other sleep stages. Slow wave and delta frequency (>20%) band appear in an epoch. REM stage is a light sleep. EEG signal in the REM stage is low-amplitude, mixed-frequency by the EEG signals in the N1 and N2 stages. Theta and sawtooth frequency band appear in REM stage. REM stage is difficult to classify with the N1 and N2 stages in Fig. 1.

Table 1. Characteristics of EEG signal frequency band.

Frequency Band Bandwidth (Hz)

Sleep Stage

Alpha

8.0 - 13.0

Wake, N1

Beta

12.0 - 30.0

Wake

Delta

0.5 - 2.0

N3

Theta

4.0 - 8.0

N1, N2, REM

Sawtooth

2.0 - 6.0

REM

Spindle

12.0 - 14.0

N2

We propose to use EMG signal in addition to EEG signal. EMG signal shows characteristic of power in Fig. 1. Power of EMG signal in the W stage is larger than the power of other sleep stages in Fig. 1. The amplitude of the EMG signal decreases as the sleep progresses from light sleep stage N1 to deep sleep stage N3. REM stage is a light sleep, but the power of EMG signal is smaller than the power of other sleep stages. Therefore, we propose to use both EEG signal and EMG signal for improving the accuracy of sleep stage classification, especially, REM, N1 and N2 stages.
III. METHOD
In this paper, we use EEG and EMG signal and classify the sleep stages automatically through the process of Fig. 2. The input data is one channel of EEG signal and one channel of EMG signal. The input EEG signal is decomposed into frequency bands using a bandpass filter and extracted 12 features. The input EMG signal extracted 1 feature without decomposing into frequency bands. Lastly, we classify the sleep stages using SVM.
Input Data 1 EEG Signal, 1 EMG Signal

EEG Signal

EMG Signal

Temporal Decomposition

Temporal Decomposition

Spectral Decomposition [Bandpass Filter]
F = {Alpha, Beta, Delta, Theta, Sawtooth, Spindle}

EEG Feature Extraction 12 Features
(Powerf F , Movement f F )

EMG Feature Extraction 1 Feature
(Poweremg )

Figure 1. Sleep stages and characteristics of EEG and EMG signal.
However, there is a limit to accurately classifying all sleep stage using EEG only signal. EEG signals in REM, N1 and N2 stages are very similar in Fig. 1 and previous studies show low classification accuracy of REM, N1 and N2 stages [5-7].

Sleep Stage Classification [Support Vector Machine]
Figure 2. Flowchart of sleep stage classification process.

208

A. Temporal and Spectral and Decomposition
First, we extract features for the classification of the sleep stage in the decomposed EEG signals. In addition, we decompose EEG and EMG signal data into each epoch for classifying sleep stage. Sleep stages are classified 30 seconds as one epoch. Then we decompose EEG signal because the EEG signal has different frequency band characteristics for each sleep stage. We decompose EEG signal to 6 frequency bands using a bandpass filter. Decomposed frequency bands are F, F = {Alpha, Beta Theta, Delta, Spindle, Sawtooth}, and shown in Table 1.

B. EEG Feature Extraction
We extract features for the classification of the sleep stage in the decomposed EEG signals. The feature of sleep stage for classification is calculated 30 seconds as one epoch. First, we use the power of EEG signal for each frequency bands. It is shown in equation (1).

n

 Powerf  (xif )2　

(1)

i 1

In equation (1), xif is the EEG signal's i-th amplitude value
of frequency band f. n is the number of sampled values contained in one epoch. We extract 6 features of power for each frequency bands using the equation (1). We can know the difference of power for each frequency bands analyzing the extracted features. For example, the power of alpha and beta frequency bands in W stage is higher than other stages and power of delta frequency bands in N3 stage is higher than other stages.

Next, we use the movement of EEG signal for each frequency bands. Movement is the feature that can identify the movement of the EEG signal. As with the above feature, we extract features in the decomposed EEG signals. We use the difference of amplitude of EEG signal and it is shown in equation (2).

n1

 Movem ent f

xf i 1



xif

(2)

i 1

We extract 6 features of movement for each frequency bands using the equation (2). We can know the movement of EEG signal for each frequency bands analyzing the extracted features. For example, if the value of movement is higher, it is a fast wave. In the opposite case, it is a slow wave.

C. EMG Feature Extraction
In the EMG signal extraction process, we extract feature in EMG signal without decomposing frequency bands. The amplitude of REM stage in EMG signal is lower than other Non-REM stages in Fig. 1. Therefore, EMG signal can be classified REM stage and Non-REM stages simply by the amplitude of EMG signal without decomposing frequency bands. We use the power of EMG signal in equation (3).

n

 Poweremg  ( yi )2

(3)

i 1

In equation (3), yi is the EMG signal's i-th amplitude value.
If the result of equation (3) is close to zero at any epoch, the epoch is REM stage. In the opposite case, it is Non-REM stage. REM and N3 stage is very similar to EMG signal. However, we can classify REM and N3 stage because of using EEG signal.
D. Classification
We train a model for automatic sleep stage classification using Support Vector Machine (SVM) of machine learning algorithm [10]. Then we use the model to training and testing. SVM is one of the algorithms of machine learning. It is a supervised learning model for data analysis. It is mainly used for classification. Given a set of data belonging to one of two categories, the SVM algorithm creates a linear classification model based on a given set of data to determine which category the new data belongs to. The SVM of the classification model is the algorithm to find the boundary with the largest width. The SVM can be used in nonlinear classification as well as linear classification. In order to perform nonlinear classification, it is necessary to map the given data to the high dimensional feature space. In order to do this efficiently, a kernel trick is used.
We use polynomial kernel function in Matlab for training. Polynomial kernel function represents the similarity of vectors in a feature space over polynomials of the original variables.

IV. PERFORMANCE EVALUATION
A. Dataset
We use the Sleep-EDF dataset to extract feature for sleep stage classification from physio-bank [11-13]. There are two datasets of subjects from two studies, healthy subjects (SC) and Temazepam effects on sleep (ST). SC provides 20 subjects (2 days data of 10 person) Sampling rate of SC is 100Hz and SC contain 2 EEG (Fpz-Cz/Pz-Oz) channels, 1 EMG channel and 1 EOG channel.
We use 1 EEG (Fpz-Cz) and 1 EMG channel in 5 subjects (1-day data of 5 person) from SC. We compose dataset to contain 13 features for sleep stage classification from EEG and EMG signal in 5 SC.

B. Results
We train a model for automatic sleep stage classification through machine learning using the dataset composed above. We use Matlab and SVM for machine learning for evaluating. 10-fold validation scheme is used for evaluating. First, we evaluate the performance of our EMG+EEG model and EEG only model using Confusion Matrix and precision. Then, we evaluate the performance of our EMG+EEG model and other

209

studies using overall accuracy, per-class F1-score and Cohen’s Kappa coefficient [13-15]. Overall accuracy is used for measuring the accuracy of the whole sleep stage classification. The per-class F1 score is used for measuring the accuracy of each sleep stage classification. Cohen's kappa coefficient is used for analyzing the agreement between actual data and predicted data.
First, we evaluate the performance of our EMG+EEG model and EEG only model using Confusion Matrix. This result is shown in Table 2. In Table 2, Confusion Matrix (a) is the result of using EEG only model and Confusion Matrix (b) is the result of using EMG+EEG model. When comparing Confusion Matrix (a) and (b), the accuracy of the sleep stage W, N2 and N3 stage is similar. However, EMG+EEG model is better than EEG only model to classify N1 and REM stage. EEG only model misclassifies N1 as REM and REM as N2 in Confusion Matrix (a), but EMG+EEG model classifies at each case better than EEG only model in Confusion Matrix (b). Next, we evaluate recall, precision and per-class F1-Score per sleep stage using Confusion Matrix (a) and (b) and it is shown in Fig. 3, Fig. 4 and Fig. 5. Fig. 3 shows recall per each stage; it shows that the recall of EMG+EEG model is similar in W, N2, N3 and it improved 8.7% in N1 stage and 8.0% in REM stage. Fig. 4 shows precision per each stage; it shows that the precision of EMG+EEG model is similar in W, N3 and it improved 6.5% in N1 stage, 8.1% in REM stage and especially 4.1% in N2 stage. Fig. 5 shows F1-Score per each stage; it shows that it improved almost all stages, 8.3% in N1 stage, 2.1% in N2 stage and 8.0% in REM stage.

Table 2. Confusion Matrix (a) EEG only model and (b) EMG+EEG model.

(a)

Predicted class

W

N1

N2

N3 REM

W

8937

36

192

7

42

Actual N1

39

102

47

0

76

class

N2

125

15

2249

38

119

N3

27

1

95

507

0

REM 33

16

169

0

674

(b)

Predicted class

W

N1

N2

N3 REM

W

9070

30

105

5

4

Actual N1

50

125

51

0

38

class

N2

108

18

2247

52

121

N3

21

2

92

515

0

REM

9

13

124

0

746

Figure 3. Recall per each stage. Figure 4. Precision per each stage. Figure 5. F1-Score per each stage.

210

Table 3. Comparison between EMG+EEG model, only EEG model and other studies.

Overall Metric

Per-class F1-Score (F1)

Methods Data Channel Test Epochs

Accuracy

Cohen’s Kappa

W

N1

N2

N3

coefficient

Ref. [6]

EEG

15136

91.3

0.86

97.8

30.4

89.0

85.5

REM 82.5

Ref. [7]

EEG

7596

90.8

0.85

96.9

49.1

89.0

84.2

81.2

SVM

EEG

13546

92.0

0.92

97.3

47.0

84.9

85.8

74.8

SVM EEG, EMG

13546

93.8

0.94

98.2

55.3

87.0

85.7

82.8

We evaluate the performance of our EMG+EEG model and other studies and it is shown in Table 3. We compare the performance of our EMG+EEG model and other studies using overall accuracy, per-class F1-score and Cohen’s Kappa coefficient. Other studies are shown higher accuracy more than 90%, but F1-Score of N1 stage is shown lower less than 50. Even F1-Score of N1 stage in [6] is shown 30.4. The result of our EEG only model is similar with other studies for three indicators, overall accuracy, per-class F1-score and Cohen’s Kappa coefficient. In the case of REM stage, the accuracy is lower than other studies. Table 3 is shown that EEG only models are shown lower F1-Score. Our proposed EMG+EEG model classifies better than other studies and our EEG only model. W, N2, N3 and REM stages are classified similar in F1-Score. However, especially, N1 stage is classified better than other studies and our EEG only model. We show that the EMG+EEG model improved 6.2-24.9 in N1 stage for F1Score in Table 3. The overall accuracy of our proposed model is higher than other studies and EEG only model. Our proposed model improved 1.8-3% for overall accuracy in Table 3. The Cohen’s Kappa coefficient of our proposed model also is higher than other studies and our EEG only model.

Table 4. Interpretation of Cohen’s Kappa.

Value of Kappa
0 - 0.19

Level of Agreement
None

% of Data that are Reliable 0 - 4%

0.20 - 0.39

Minimal

4 - 14%

0.40 - 0.59

Weak

15 - 34%

0.60 - 0.79

Moderate

35 - 63%

0.80 - 0.90

Strong

64 - 81%

Above 0.90

Almost Perfect

82 - 100%

Interpretation of Cohen’s Kappa coefficient shown in Table 4. The value of Kappa is close to 1, it is a reliable result. Other studies are shown high accuracy, but the value of Cohen's Kappa coefficient is lower than 90. The value of Cohen's Kappa coefficient in our proposed model is 0.94, so it is a reliable model because of above 0.90. Our proposed model improved 0.07-0.08 for Cohen’s Kappa coefficient in Table 3.
Therefore, using EMG signal in addition to EEG signal to improve sleep stage classification accuracy for N1, N2 and REM stages.
V. CONCLUSION
Sleep is a primary constituent of healthy life. It is important to maintain good sleep efficiency because some problems occur when sleep efficiency is low. Thus, it is necessary to analyze and evaluate sleep efficiency for living a healthy life. Sleep efficiency can be determined by the ratio of sleep stages. Sleep stage classification takes a long time consuming because experts analyze PSG, thus researches are being conducted to automatic classification for sleep stages.
In this paper, we propose to classify the sleep stage using EMG and EEG signal. We train the model using SVM of machine algorithm and automatically classify sleep stages. We show that our proposed model classifies for sleep stages better than using EEG only models. Especially, our proposed model improves the accuracy of N1 stage.
In the future, we plan to make a model of Convolutional Neural Network (CNN) for improving the accuracy at each sleep stages. Our proposed model improved the accuracy of N1 stage, but it is still insufficient compared to the accuracy of other sleep stages. We will use CNN in deep learning algorithm to improve the accuracy of sleep stage classification. CNN is a feed-forward artificial neural network that has

211

successfully been applied to analyzing a visual image. EMG and EEG signals are similar as an image, we plan to improve the accuracy by applying CNN.
ACKNOWLEDGMENT
This research was supported by the National Research Foundation of Korea (NRF) Grant funded by the Korean Government (MSIP) (No.2016R1A5A1012966).
REFERENCES
[1] K. Aboalayon, H. T. Ocbagabir, and M. Faezipour. “Efficient sleep stage classification based on EEG signals.” Systems, Applications and Technology Conference (LISAT), Long Island. IEEE, pp. 1-6, 2014.
[2] K. Wulff, S. Gatti, J. G. Wettstein, and R. G. Foster, “Sleep and circadian rhythm disruption in psychiatric and neurodegenerative disease,” Nature Rev. Neurosci., vol. 11, no. 8, pp. 589-599, 2010.
[3] C. Iber, S. Ancoli-Israel, A. L. Chesson, Jr., and S. F. Quan, “The AASM Manual for the Scoring of Sleep and Associated Events”, Westchester, IL, USA: American Academy of Sleep Medicine, 2007.
[4] M. G. Terzano, L. Parrino, A. Smerieri, R. Chervin, S. Chokroverty, C. Guilleminault, M. Hirshkowitz, M. Mahowald, H. Moldofsky, A. Rosa, R. Thomas, A. Walters, “Atlas, rules, and recording techniques for the scoring of cyclic alternating pattern (CAP) in human sleep”, Volume 3, Issue 2, pp. 187-199, March 2002.

[5] R. Sharma, R. B. Pachori, and A. Upadhyay, “Automatic sleep stages classification based on iterative filtering of electroencephalogram signals,” in Neural Computing and Applications. London, U.K.: Springer, pp. 1–20, 2017
[6] A. R. Hassan and A. Subasi, “A decision support system for automated identification of sleep stages from single-channel EEG signals,” Knowl.Based Syst., vol. 128, pp. 115–124, July 2017.
[7] Y. L. Hsu, Y. T. Yang, J. S. Wang, and C. Y. Hsu, “Automatic sleep stage recurrent neural classifier using energy features of EEG signals,” Neurocomputing, vol. 104, pp. 105–114, March 2013.
[8] S.T. Pan, C.E. Kuo, J.H. Zeng, and S.F. Liang, "A transitionconstrained discrete hidden Markov model for automatic sleep staging.", BioMedical Eng OnLine. 11:52–71, 2012.
[9] A. L. Goldberger et al., “PhysioBank, PhysioToolkit, and PhysioNet: Components of a new research resource for complex physiologic signals,” Circulation, vol. 101, pp. e215–e220, June 2000.
[10] C. Cortes, C., and V. Vapnik, “Support vector networks”. Machine Learning, vol. 20, no. 3, pp. 273–297, 1995.
[11] B. Kemp, A. H. Zwinderman, B. Tuk, H. A. C. Kamphuisen, and J. J. L. Oberyé, "Analysis of a sleep-dependent neuronal feedback loop: The slow-wave microcontinuity of the EEG," IEEE Trans. Biomed. Eng.,vol. 47, no. 9, pp. 1185–1194, September 2000.
[12] J. Cohen, “A coefficient of agreement for nominal scales,” Edu. Psychol. Meas., vol. 20, no. 1, pp. 37–46, 1960.
[13] “The Sleep-EDF Database [Expanded]”, https://physionet.org/physiobank/database/sleep-edfx/
[14] M. Sokolova and G. Lapalme, “A systematic analysis of performance measures for classification tasks,” Inf. Process. Manag., vol. 45, no. 4, pp. 427–437, Jul 2009.
[15] M. L. McHugh, “Interrater reliability: the kappa statistic”, Biochem Med (Zagreb). Vol. 22 no. 3 pp. 276–282, October 2012.

212

