Constructive Interference Optimization for Hybrid Beamforming with Data-aided Symbol-level Precoding in Multi-user MISO System
Jae Won Lee, & Chung G. Kang School of Electrical Engineering Korea University Seoul, Korea, Republic of
Email:{lijrew, ccgkang}@korea.ac.kr

Abstract—The data-aided symbol-level precoding scheme has been known as a useful means of improving the system efﬁciency in multi-user multi-input single-output (MISO) system, especially with a full digital beamforming. As the number of antenna elements increases, it must be extended to hybrid beamforming with a limited number of radio frequency (RF) chains, while degrading its performance. In this paper, we provide a solution approach to the minimum mean-square estimation (MMSE)based constructive interference optimization (CIO) problem for hybrid beamforming. As it has to resort to the local optimal solution with hybrid beamforming with a limited number of RF chains, its performance turns out to be much worse than that of full digital beamforming. However, its capacity has been shown to exceed that of the existing scheme, indicating that the dataaided symbol-level precoding would be still useful for a massive number of antenna elements in practice.
Index Terms—multi-user MISO system, data-aided precoding, constructive interference gain, constructive interference optimization (CIO), hybrid beamforming
I. INTRODUCTION
As opposed to the conventional block-level precoding ap-
proach to avoid the inter-user interference (IUI) in the multi-
input single-output (MISO) system, symbol-by-symbol data-
aided precoding has been proposed to exploit the constructive
multi-user interference that pushes the detected constellation
point deeper into detection region. For example, detection
performance of phase-shift-keying (PSK) modulation can be
signiﬁcantly improved by creating the phase and amplitude
of inter-user interference that can be leveraged to improve
the overall performance when both data and channel state
information (CSI) are simultaneously exploited on a symbol-
by-symbol basis [1-6]. In [1] and [2], a modiﬁed symbol-level
zero-forcing beamforming (ZFBF) using the phase informa-
tion of IUI is applied. Optimization has been performed to
minimize the transmission power while satisfying the signal-
to-interference-and-noise ratio (SINR) constraint for each user
by simultaneously designing the phase and size of the IUI for
all users [3-5]. It has been known that the data-aided symbol-
level precoding scheme outperforms the block-level scheme,
e.g., 3dB gain in [4]. In particular, [5] optimizes the problem
of minimizing power while aligning the interference signal to
the same phase as the target signal. However, this method does

not utilize the whole link performance because the interference signal is projected only to a speciﬁc vector. In order to solve this problem, the CIO method of [6] speciﬁes a relaxed interference area which called constructive interference region (CI region), instead of a strict projection so as to alleviate the phase to the target signal to obtain more cumulative constrictive interference gain (CCIG).
In the previous work [6], we have formulated a constructive interference optimization (CIO) problem that minimizes a sum of minimum mean square error (MMSE) for all users to achieve the target constructive interference gain subject to the ﬁxed total power constraint. As opposed to the existing symbol-level precoding approaches, it exploits a full range of relaxation for constructive region, so as to improve the linklevel performance by minimizing the sum of mean square error (MSE) for all users. Due to the convexity of the proposed formulation, our MMSE-based optimization approach allows for a semi-closed-form optimal solution that leads to a more CCIG without incurring unacceptable complexity than other stateof-the-art schemes. However, note that our previous system model deals with the full digital beamforming, which might involve too much complexity, especially when the number of antennas increases. In this paper, we attempt to extend the previous approach to hybrid beamforming. In fact, we ﬁnd that the previous approach can be still applicable to computing the analog and digital precoding matrices for hybrid beamforming. Furthermore, we evaluate its performance to be compared with that for full digital beamforming.
The rest of the paper is organized as follows: We present a system model for hybrid beamforming in the multi-user MISO system, in which MMSE-based CIO problem is formulated to ﬁnd the optimal hybird precoders in Section II. Section III provides a solution approach to the MMSE-based CIO problem, which exploits the existing solution combined with orthogonal matching pursuit (OMP) algorithm. In Section IV, we give simulation results for performance comparison with one with full digital beamforming-based CIO schemes. Finally, in the last section, conclusion is made and future works are suggested.

978-1-7281-1340-1/19/$31.00 ©2019 IEEE

510

ICUFN 2019

II. SYSTEM MODEL & PROBLEM FORMULATION

We consider a downlink for multi-user MISO system with a uniform linear array (ULA) of M transmit antennas and K simultaneous users, each with a single receive antenna. Let θk, and βk, denote the angle of departure (AoD) and gain for the th path of user k, respectively. The steering vectors with M antenna elements with AoD of θ, denoted as g(θ), is modeled as

g(θ) =

1,

e−i2π

d λ

sin

θ,

...,

e−i2π(M −1)

d λ

sin

θ

T

(1)

where d and λ are the distances between two adjacent antenna
elements and the carrier wavelength, respectively. Then, the generic channel model for user k, hk ∈ CM×1, using the steering vector representation can be expressed as

L

hk = βk, g(θk, )

(2)

=1

where L is the number of multi-paths with the AoD θk, i.∼i.d. unif [−π/2, π/2] and path gain βk, i.∼i.d. CN 0, σh2 · 1/L . Note that we use a lower-case boldface to denote a column vector.
For the k-user MU-MISO system, let H = [h1, ..., hK ]H ∈ CK×M represent a channel matrix of the users. Let wk ∈ CM×1 denote the precoding vector of user k, forming a precoding matrix W = [w1, ..., wK ] ∈ CM×K . For a narrow-
band block-fading propagation channel, the signals received by users, y ∈ CK×1, are expressed as

y = HWd + n

(3)

where d ∈ CK×1 denotes the data vector with E ddH = IK and n˜CN (0, IK ) is the corresponding additive white Gaussian noise vector.
In this paper, we assume that Ω-ary PSK (Ω-PSK) modulation is employed. Let ΦΩ be a set of angles for the ΩPSK. A target constellation point for user k is then represented by dk = ejφk where φk ∈ ΦΩ denotes the angle of Ω-PSK modulation symbol. A decision region for user k is given by
θ| θ k ≤ θ ≤ θ k where θ k = φk + θΩ and θ k = φk − θΩ
are the decision boundaries with θΩ = π/Ω. From a symbol detection perspective, the received signal yk must be placed in the decision region to correctly detect the symbol, i.e.,
θ k ≤ angle(yk) ≤ θ k. The idea is to design the inter-user interference in each symbol such that it can be beneﬁcial to symbol detection.
If all other signals for user k can be constructed such that

θ k ≤ angle hHk wk dk ≤ θ k, k = k

(4)

inter-user interference {hHk wk dk }k =k is turned into a constructive interference gain for user k. Subsequently, cumulative
constructive interference gain (CCIG) for user k is given by |hHk Wd|2, whose target range is supposed to be prespeciﬁed. The constructive region for user k, denoted as Xk,
is deﬁned as a decision region which achieves the improved

Im

f1,k x  0 k

dˆk

 k

/

2

C

 A

  k

B

O

 k

/2

 f2,k

x  0

Re

Fig. 1. Constructive interference design for user k: Ω = 4 [6]

CCIG speciﬁed for the transmitted signal x = Wd ∈ Xk. More speciﬁcally, we specify the lower-bound constellation
point of constructive region, denoted as A, with its amplitude
γ k, i.e., A = γ kejφk for φk ∈ ΦΩ. Referring to illustration for Ω = 4 in Fig. 1, the constructive interference region is given by Xk = {xk = (x(1k), x(2k))|x(1k), x(2k) ≥ γ k/2}. On the other hand, since the SINR and rate have a nonconvex form with respect to the precoding vectors, it is not straightforward to solve the weighted sum-rate maximization, sum-rate maximization, or worst-SINR maximization problem. From the fact that the MSE is closely connected with other important performance measures such as SER and capacity (see, e.g., [7] and [8]), therefore, we resort to minimizing a sum of MSE for the symbol-level enhancement [6]. As in [6], we employ the minimum mean-square error (MMSE) approach to determine the precoding vector. Let γˆk and dˆk ddˆeknote√aγˆktaerjgφekt. CCIG and its corresponding signal point, i.e.,
As opposed to full digital beamforming in [6], we consider hybrid beamforming with NRF RF chains (K ≤ NRF ). Then, the precoding matrix can be represented as W = WRF WBB where WRF ∈ CM×NRF and WBB ∈ CNRF ×K denote the precoding matrices for analogy beamforming and digital beamforming, respectively. We assume that the analog precoder is selected from the given beam book G. Then, our objective is to determine WRF and WBB that minimize the sum of MSE for all users as follows:

min En dˆ − (HWRF WBBd + n) 2

WRF ,WBB

subject to WRF ∈ G,

WRF WBB d

2 F

≤P

(5)

and WRF WBBd ∈ Xk for ∀k.

511

III. CONSTRUCTIVE INTERFERENCE OPTIMIZATION

For Ω-PSK modulation, the optimal transmit signal vector x = Wd was derived in [6] as

x∗ (τ, {λi,k}) = HH HHH + τ I −1

(6)

·ϕ {0.5 (c2λ1 + c1λ2) + ηˆ} .

where ηˆ =

√

√

γˆ1, ..., γˆK

T

and

ϕ

=

diag

ejφ1 , ..., ejφK

with c1 = tan θΩ + j and c2 = tan θΩ − j, while τ and

{λi}i=1,2 are the Lagrange multipliers. In order to compute the optimal values of the Lagrange multipliers, a modiﬁed

bisection search algorithm has been proposed in [6]. For hybrid

beamforming, (5) is a not convex problem and thus, we will

just focus on ﬁnding for local optimal solution. However, it is

still not straightforward to determine WRF and WBB at the same time. We ﬁrst ﬁnd x∗ by assuming that WR∗ F is known. In other words, x∗ is found by solving the following problem:

min
x

xH WRF H HH HWRF x − 2 Re ηˆT ϕH HWRF x

subject to

WRF x

2 F

≤P

and

WRF x ∈ Xk

for

∀k.

(7)

Let H˜ = HWRF by (6), then, solution to (7) is given as x∗ (τ, {λi,k}) = H˜ H H˜ H˜ H + τ I −1

·ϕ {0.5 (c2λ1 + c1λ2) + ηˆ} .

Assuming that the beam book is pre-speciﬁed as G = [g1, g2, ..., gB] ∈ CM×B, WBB ∈ CNRF ×K can be found by solving the following problem for x˜ = WBBd:

min x˜H GH HH HGx˜ − 2 Re ηˆT ϕH HGx˜
x˜∈CB×1

subject to diag x˜x˜H

0 = NRF ,

Gx˜

2 F

≤P

(8)

and Gx˜ ∈ Xk for ∀k

Since NRF << B in general, i.e., x˜ is sparse, a suboptimal solution to (5) can found by orthogonal matching pursuit (OMP) [9-11]. That is, due to the condition of diag x˜x˜H 0 = NRF , only NRF columns in the given beam book G are selected through OMP, so as to form WRF . The overall solution approach to our MMSE-based constructive interference
optimization for can be summarized by Algorithm 1:

Algorithm 1 Proposed MMSE-CIO Precoding for Hybrid

Beamforming

1: Input H, G

2: Wres = ηˆT I & WRF = Empty

3: For r ≤ NRF do

4:

Φ = GH HH Wres

5:

b = arg maxb ΦΦH b,b

6:

WRF = WRF G(b)

7:

Calculate xˆ (τ ) using Algorithm 2.

8:

Update Wres = ηˆT I − HWRF xˆ∗ (τ )

9:

End for

10: Calculate x∗ (τ, {λi,k}) using Algorithm 1 in [6]. 11: output: WRF , x∗ (τ, {λi,k})

Note that the following bisection algorithm is employed to compute xˆ∗(τ ) in Algorithm 1:

Algorithm 2 Bisection algorithm for xˆ∗ (τ )

1: While τmax − τmin ≥ ε do

2:

Update τ ← (τmax + τmin) /2

3:

Calculate xˆ (τ ) = H˜ H

H˜ H˜ H + τ I

−1
ϕηˆ.

4:

If xˆ 2 − P < 0 then τmax = τ

5:

Else if xˆ 2 − P ≥ 0 then τmin = τ

6:

End if

7: End while 8: output: xˆ∗ ← xˆ

IV. PERFORMANCE ANALYSIS

The objective of performance analysis is to evaluate how much our solution to CIO for hybrid beamforming is compatible with that for full digital beamforming. We compare the symbol error rate (SER) and mutual information (MI) between the different beamforming types under the same simulation assumptions and model in [6]. We consider a single-cell system of M = 1024 antenna elements at the BS with NRF = 32 or 64 and a single antenna at the receivers. We also assume each channel in (2) has L = 5 paths and non-homogeneous environment with ρkhk where ρk ∼ unif(0, 1) is large-scale parameter. As same with [6], we set γ k = 1.2−αk · γk and γˆk = 2αk ·γk where αk ∼ unif(0, 1) is a relaxation factor. For simplicity, K users have the same target CCIG and relaxation factor, i.e., γk = γ, αk = α = 1.0, ∀k.
As in [12], MI per√bit in QPSK modulation scheme can be approximated to J 2 γ˜k where γ˜k is the received CCIG of user k achieved by MMSE-CIO and J(x) is given as follow:

J (x) =

a1x3 + b1x2 + c1x, 1 − exp(a2x3 + b2x2 + c2x + d2),

if x ≤ 1.6363 if 1.6363 < x

(9)

with a1 = −0.04210661, b1 = 0.209252, c1 = −0.00640081

for x ≤ 1.6363, and a2 = 0.00181492, b2 = −0.142675,

c2 = −0.0822054, d2 = 0.0549608 for x > 1.6363 [12].

For hybrid beamforming, DFT vector is generated as

gb

=

√1 M

1,

e−i2π

d λ

sin

θb ,

...,

e−i2π(M −1)

d λ

sin

θb

T
,

b = 1, 2, · · · , B

where with θb ∼ Unif [−π/2, π/2] by ﬁxing B = 60 or 120. Fig. 2 (a) and (b) show the average SER and cumulative
distribution function (CDF) of MI for full digital beamforming and hybrid beamforming, respectively, as increases. It also shows the performance of constructive interference power minimization (CIPM) approach for full digital beamforming in [5], which serves as a baseline performance for symbollevel precoding scheme. The CIPM scheme in [5] is a design approach to force the received signal to an exact data phase, while minimizing the transmit power subject to the target quality of individual user. The constraints can be transformed into afﬁne constraints, which makes the optimization problem

512

10-1

SER

10-2

Mutual information (bits/s/Hz)

10-3

Full digital beamforming (MMSE-CIO)

Full digital beamforming (CIPM)

Hybrid beamforming (B=60 / NRF=64)

Hybrid beamforming (B=120 / NRF=64)

Hybrid beamforming (B=120 / NRF=32)

10-4

-8

-4

0

4

8

(dB)

(a) Average SER

2

1.8

1.6

1.4

1.2

1

0.8

0.6 Full digital beamforming (MMSE-CIO)

0.4

Full digital beamforming (CIPM)

Hybrid beamforming (B=60 / NRF=64)

0.2

Hybrid beamforming (B=120 / NRF=64)

Hybrid beamforming (B=120 / NRF=32)

0 -10 -8 -6 -4 -2 0 2 4 6 8 10 12

(dB)

(b) System-level MI

Fig. 2. Performance Comparison

convex and thus, solvable through standard methods. In addition, since there is no constraint on the maximum allowed power, this problem is always feasible. However, the CIPM approach does not exploit the full performance on the varying link conditions among all users.
It is observed that the average SER performance of hybrid beamforming is worse than that of full digital beamforming in both cases. Particularly, a signiﬁcant difference, e.g., about 4dB, is observed for a small number of beams, e.g., B = 60, which limits the degree of freedom. However, both SER performance approach close to those for CIPM when B = 120 and NRF = 32. Furthermore, when NRF = 64, it outperforms CIPM, increasing the degree of freedom for digital precoding, especially as the size of G increases. We also observe over 4dB degradation in MI for hybrid beamforming as compared

to full digital beamforming at NRF = 32. On the other hand, only 2dB performance difference is shown at NRF = 64. The performance degradation would be mainly attributed to the limited accuracy of solution approach, e.g., possibly due to the local optimality, as well as the nature of hybrid beamforming.
V. CONCLUSION
We provided a solution approach to the MMSE-based CIO problem for hybrid beamforming with data-aided symbol-level precoding in multi-user MISO system. The current OMP-based solution to MMSE optimization problem for hybrid beamforming suffers from its performance and furthermore, more complexity. Therefore, it is still required to ﬁnd a low-complexity solution approach to make the symbol-level precoding more realistic in practice, while enhancing its performance as close to as full digital beamforming. As the symbol-level precoding can be considered as an ultimate form of non-orthogonal multiple access which is adaptive with channel variation, it can be served as a useful means of improving the bandwidth efﬁciency in the future mobile system by any feasible means of implementation.
ACKNOWLEDGMENT
This work was supported in part by Samsung Research in Samsung Electronics
REFERENCES
[1] C. Masouros and E. Alsusa, “Dynamic linear precoding for the exploitation of known interference in MIMO broadcast systems,” IEEE Trans. Wireless Commun., vol. 8, no. 3, pp. 1396–1404, Mar. 2009.
[2] C. Masouros, “Correlation rotation linear precoding for MIMO broadcast communications,” IEEE Trans. Signal Process, vol. 59, no. 1, pp. 252–262, Jan. 2011.
[3] M. Alodeh, S. Chatzinotas, and B. Ottersten, “Constructive multiuser interference in symbol level precoding for the MISO downlink channel,” IEEE Trans. Signal Process, vol. 63, no. 9, pp. 2239–2252, May 2015.
[4] M. Alodeh et al, “Symbol-Level and Multicast Precoding for Multiuser Multiantenna Downlink: A State-of-the-Art, Classiﬁcation, and Challenges,” IEEE Communications Surveys & Tutorials, vol. 20, no. 3, pp. 1733-1757, thirdquarter 2018.
[5] C. Masouros and G. Zheng, “Exploiting known interference as green signal power for downlink beamforming optimization,” IEEE Trans. Signal Process, vol. 63, no. 14, pp. 3628–3640, Jul. 2015.
[6] Yong In Choi, Jae Won Lee, Minjoong Rim, and Chung G. Kang, “Constructive Interference Optimization for Data-aided Precoding in Multi-User MISO System,” IEEE Trans. Wireless Commun., vol. 18, no. 2, pp. 1128-1141, Feb. 2019.
[7] S. Shi, M. Schubert, and H. Boche, “Downlink MMSE transceiver optimization for multiuser MIMO systems: Duality and sum-MSE minimization,” IEEE Trans. Signal Process, vol. 55, no. 11, pp. 5436–5446, Nov. 2007.
[8] R. Hunger, M. Joham, and W. Utschick, “On the MSE duality of the broadcast channel and the multiple access channel,” IEEE Trans. Signal Process, vol. 57, no. 2, pp. 698–713, Feb. 2009.
[9] O. El Ayach, S. Rajagopal, S. Abu-Surra, Z. Pi, and R. W. Heath, “Spatially sparse precoding in millimeter wave MIMO systems,” IEEE Trans. Wireless Commun., vol. 13, no. 3, pp. 1499–1513, Mar. 2014.
[10] A. Alkhateeb, G. Leus, and R. W. Heath, “Limited feedback hybrid precoding for multi-user millimeter wave systems,” IEEE Trans. Wireless Commun., vol. 14, no. 11, pp. 6481–6494, Mar. 2015.
[11] D. H. Nguyen, L. B. Le, and T. Le-Ngoc, “Hybrid MMSE precoding for mmWave multiuser MIMO systems,” IEEE ICC, May 2016, pp. 1–6.
[12] K. Sayana, J. Zhuang, and K. Stewart, “Link performance abstraction based on mean mutual information per bit (MMIB) of the LLR channel,” Tech. Rep. IEEE C802.16m-07/097

513

