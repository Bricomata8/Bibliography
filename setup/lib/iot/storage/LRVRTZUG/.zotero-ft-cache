Arrhythmia Classification System Using Deep Neural Network

EunKwang Jeon Dept. of Computer Science & Engineering
Soonchunhyang University Asan, South Korea imdae11@sch.ac.kr
MinSu Chae Dept. of Computer Science & Engineering
Soonchunhyang University Asan, South Korea cmspr90@gmail.com

Sangwook Han Dept. of Computer Science & Engineering
Soonchunhyang University Asan, South Korea sanguk@sch.ac.kr
HwaMin Lee Dept. of Computer Software Engineering
Soonchunhyang University Asan, South Korea leehm@sch.ac.kr

Abstract—Previous studies on arrhythmia were used to diagnose the abnormally fast, slow, or irregular heart rhythm through ECG (Electrocardiogram), which is one of the biological signals. ECG has the form of P-QRS-T wave, and many studies have been done to extract the features of QRS-complex and R-R interval. However, in the conventional method, the P-QRS-T wave must be accurately detected, and the feature value is extracted through the P-QRS-T wave. If an error occurs in the peak detection or feature extraction process, the accuracy becomes very low. Therefore, in this paper, we implement a system that can perform PVC (Premature Ventricular Contraction) and PAC (Premature Atrial Contraction) classification by using P-QRS-T peak value without feature extraction process using deep neural network. The parameters were updated for PVC and PAC classification in the learning process using P-QRS-T peak without feature value. As a result of the performance evaluation, we could confirm higher accuracy than the previous studies and omit the process of feature extraction, and the time required for the preprocessing process to construct the input data set is relatively reduced.
Keywords—arrhythmia; deep neural network; classification; premature ventricular contraction;

ECG signals represent a greater problem. The width of the normal QRS section as well as the size and position of the P wave and the T wave differ between individuals and, in severe cases, the P wave or T wave can hardly be distinguished. Therefore, monitoring of serious arrhythmia requires longterm measurements using advanced equipment in a stable environment [3]. Several methods for automatic detection and classification of cardiac arrhythmias have been reported in the literature, including algorithms based on self-organizing maps [4], filter banks [5], hidden Markov models [6], and neural networks [7-9]. In this paper, we developed a system to classify arrhythmias by updating the weights and bias values of deep neural networks using P-QRS-T peak values with the aim of developing a highly accurate arrhythmia classifier without requiring a feature extraction process.

I. INTRODUCTION
Coronary artery disease (CAD), arrhythmia, and heart failure are typical types of heart disease. Frequent monitoring of electrocardiogram (ECG) signals is necessary, especially when there is a history of related events [1,2]. In the study of the detection and classification of the arrhythmia, various features were extracted by processing the ECG signal, and the types of arrhythmia were classified according to the characteristics. However, accurate P-QRS-T peak detection is necessary for ECG signal feature extraction, which requires the use of advanced equipment and a stable measurement environment. Therefore, various complicated algorithms must be used for data processing. Interindividual differences in the

Fig. 1. Typical process flowchart of ECG based diagnosis

978-1-7281-1340-1/19/$31.00 ©2019 IEEE

111

ICUFN 2019

II. RELATED WORK
A. Classification of Existing ECG Signal
Diagnosis of heart disease using ECG signals requires sequential preprocessing, waveform detection and segmentation, feature extraction, and classification procedures, as shown in Figure 1. Compression of the signal for each step is an essential element for effectively storing and transmitting enormous amounts of ECG data and as each step progresses, ECG signal compression proceeds.

values were determined from data preprocessing through the Restricted Boltzmann Machines (RBM) learning method and the results were improved. In addition to the RBM, which has the disadvantage that preprocessing takes a long time, there are many methods available for specifying the initial values of other parameters. A typical example is the initialization process designed by He (2015) [13], which gives a random initial value of the parameter, but it determines the variance of the parameter’s initial value distribution considering the numbers of input nodes and output nodes. There are many ways to improve the performance of the neural network model, such as by using dropout and batch normalization.

B. QRS Peak Detection
The Pan & Tompkins QRS Peak Detection algorithm is a typical QRS peak detection algorithm, first published in 1985, which has been used in many subsequent ECG-related studies. The algorithm detection process is shown in Figure 2.

III. DEEP NEURAL NETWORK MODEL FOR ARRHYTHMIA CLASSIFICATION
The overall structure of the arrhythmia classification system based on the proposed neural network is shown in Figure 3. First, the noise is removed from the ECG signal by preprocessing, and then the R wave is detected, and Q and S waves are detected based on the detected R wave. Then, P and T waves are detected using the detected R, Q, and S waves. Learning and testing data sets consist of P, Q, R, S, and T waves, and label data in one file. The label data are configured in one-hot encoding format. The mini-batch is then obtained for the training data and the parameters are updated using the error backpropagation algorithm through the mini-batch data. After the learning process is completed, the updated parameters are evaluated using the test data set to verify the performance.

Fig. 2. QRS Detection Process
C. Deep Neural Network Model
Neural network models are among the most commonly used models in various fields, including pattern recognition. This type of model was first implemented by McCulloch and Pitts in 1943 [10]. However, because of the large number of parameters and complexity of the models, it was impossible to learn all of the parameters. Backpropagation subsequently developed by LeCun (1989) [11] enabled learning of parameters, and has been used in various fields, such as artificial intelligence, image processing, etc. However, the complexity of the 1990s models led to various problems, such as the existence of local minima. In addition, as the active function is sigmoid, it is more difficult to learn the parameters near the input layer for deeper layers. Therefore, these models fell out of use. Neural network models were reintroduced in 2000 because Hinton (2006) [12] solved the problem of local solutions through data preprocessing. In the past, the initial values of the parameters were set at random, but the initial

Fig. 3. Configuration of Arrhythmia Classification System
A. Training and Test Data Set Configuration The MIT-BIH Arrhythmia Database was used as a
data set for learning and testing. The data set used in this paper is shown in Table 1.

112

TABLE I.

MIT-BIH ARRHYTHMIA DATA SETS USED FOR TRAINING AND TESTING

100 Record 103 Record 106 Record 119 Record

200 Record 202 Record 203 Record 205 Record

209 Record 210 Record 213 Record 215 Record

220 Record 221 Record 228 Record 233 Record

and the output nodes were composed of two layers. We used the sigmoid function as the activation function in the hidden layer and the softmax function as the activation function in the output layer.
Figure 5 shows the structure of the proposed neural network. Previously, we used the features of the ECG signal for classification and detection of arrhythmia. Arrhythmias, such as premature ventricular contraction, could be easily identified by the RR Interval feature. However, extracting features is time consuming. Therefore, we designed to extract the features of the electrocardiogram signal during the learning process for arrhythmia classification.

In MATLAB, the length of data per record using the rdsamp library is 30 minutes. The total number of data per record is 650000 and the sample rate is 360 Hz. QRS peaks were detected after preprocessing by the Pan & Tompkins QRS Peak Detection algorithm. The results of QRS peak detection are shown in Figure 4.

Fig. 5. Proposed Deep Neural Network Model Configuration

Fig. 4. Example of QRS Peak Detection Results
The label data and the Q, R, and S peak data are integrated into a single csv file. The format of the label data is constituted by the one-hot encoding format. As the label data are in the one-hot encoding format, the signal is represented as 1,0,0 for normal waveforms, 0,1,0 for premature ventricular contraction, 0,0,1 for premature atrial contraction. In the deep neural network model, learning and test data from the first column to the fifth column, and learning and test target data from the sixth column to the eighth column are loaded. In the entire data set, the ratio of training data to test data was 7:3.
B. Implementation of Deep Neural Network Model
In this paper, a deep neural network model for arrhythmia classification was implemented in Tensorflow-GPU version and learning was performed through GPGPU (GeneralPurpose Computing on Graphics Processing Units).
The input nodes of the neural network were composed of three layers, the hidden nodes were composed of five layers,

IV. EXPERIMENT RESULTS
To evaluate the proposed system, we extracted a data set from the MIT-BIH Arrhythmia Database; 16 records were used for premature ventricular contraction and premature atrial contraction classification. Table 2 shows the records used for learning and testing. Normal Beats, PVC Beats, and PAC Beats refer to the number of waveforms.

TABLE II.

MIT-BIH DATASET USED FOR OUR EXPERIMENTS

Record
100 103 106 119 200 202 203 205 209 210 213 215 220

Normal Beats 2,239 2,082 1,507 1,543 1,743 2,061 2,529 2,571 2,621 2,423 2,641 3,195 1,954

PVC Beats
1 0 520 444 828 20 445 71 1 204 582 165 0

APC Beats
33 2 0 0 30 55 2 11 383 22 28 3 94

Total
2,273 2,084 2,027 1,987 2,601 2,136 2,976 2,656 3,005 2,649 3,251 3,363 2,048

113

221 228 233 Total

2,031 1,688 2,230 35,058

396 362 842 4,881

0

2,427

3

2,053

7

3,079

673

40,615

The final calculated values were used to determine the accuracy. The results of arrhythmia classification through the designed neural network are shown in Table 3. The proposed neural network showed 98.07% classification accuracy of normal waveforms, premature ventricular contraction waveforms, and premature atrial contraction waveforms.

TABLE III. ARRHYTHMIA CLASSIFICATION ACCURACY

Record 100 103 106 119 200 202 203 205 209 210 213 215 220 221 228 233
Average

Accuracy 97.92 99.85 100 99.49 96.33 96.49 96.66 100 99.16 97.33 93.33 99.83 96.82 96.58 100 99.33 98.07

V. CONCLUSIONS
In this study, we implemented a system that can classify arrhythmia without feature extraction using a deep neural network. In addition, time complexity was improved by using a mini-batch technique and GPGPU, and parameter classification was improved by error backpropagation. Previous studies detected P-QRS-T points in ECG signals and further extracted features corresponding to diseases related to arrhythmia. We attempted to classify arrhythmia using a machine-learning algorithm, with the extracted features as input values. In this paper, we used the MIT-BIH Arrhythmia Database to evaluate

the performance of the designed neural network. The proposed neural network is comprised of the input layer from the 0th layer to the output layer of the 6th layer, and the 1st to 5th layers comprise the hidden layer.
ACKNOWLEDGMENT
This research supported by the MSIT (Ministry of Science and ICT), Korea, under the ITRC (Information Technology Research Center) support program (IITP-2019-2014-1-00720) supervised by the IITP(Institute for Information & communications Technology Planning & Evaluation) and Basic Science Research Program through the National Research Foundation of Korea (NRF-2017R1A2B401 0570).
REFERENCES
[1] Enseleit, Frank, and Firat Duru. "Long-term continuous external electrocardiographic recording: a review." Europace 8.4 (2006): 255266.
[2] Finlay, Dewar D., et al. "Synthesising the 12-lead electrocardiogram: Trends and challenges." European journal of internal medicine 18.8 (2007): 566-570.
[3] Jung Hyoun Bae, et al. "The Classification of Arrhythmia Using Similarity Analysis Between Unit Patterns at ECG Signal" KIPS Journal D (2001 ~ 2012) , Vol. 19D, No.1, pp.105-112.
[4] Risk, Marcel0 R., Jamil F. Sobh, and J. Philip Saul. "Beat detection and classification of ECG using self organizing maps." Engineering in Medicine and Biology Society, 1997. Proceedings of the 19th Annual International Conference of the IEEE. Vol. 1. IEEE, 1997.
[5] Afonso, Valtino X., et al. "ECG beat detection using filter banks." IEEE transactions on biomedical engineering 46.2 (1999): 192-202.
[6] Cheng, W. T., and K. L. Chan. "Classification of electrocardiogram using hidden Markov models." Engineering in Medicine and Biology Society, 1998. Proceedings of the 20th Annual International Conference of the IEEE. IEEE, 1998.
[7] Inan, Omer T., Laurent Giovangrandi, and Gregory TA Kovacs. "Robust neural-network-based classification of premature ventricular contractions using wavelet transform and timing interval features." IEEE Transactions on Biomedical Engineering 53.12 (2006): 2507-2515.
[8] Shyu, Liang-Yu, Ying-Hsuan Wu, and Weichih Hu. "Using wavelet transform and fuzzy neural network for VPC detection from the Holter ECG." IEEE Transactions on Biomedical Engineering 51.7 (2004): 1269-1273.
[9] Hosseini, H. Gholam, K. J. Reynolds, and D. Powers. "A multi-stage neural network classifier for ECG events." Engineering in Medicine and Biology Society, 2001. Proceedings of the 23rd Annual International Conference of the IEEE. Vol. 2. IEEE, 2001.
[10] MLA McCulloch, Warren S., and Walter Pitts. "A logical calculus of the ideas immanent in nervous activity." The bulletin of mathematical biophysics 5.4 (1943): 115-133.
[11] LeCun, Yann, et al. "Backpropagation applied to handwritten zip code recognition." Neural computation 1.4 (1989): 541-551.
[12] Hinton, Geoffrey E., and Ruslan R. Salakhutdinov. "Reducing the dimensionality of data with neural networks." science 313.5786 (2006): 504-507.
[13] He, Kaiming, et al. "Delving deep into rectifiers: Surpassing humanlevel performance on imagenet classification." Proceedings of the IEEE international conference on computer vision. 2015.

114

