Multipath Scheduling for Energy Balancing and Reliable Transmission over 6TiSCH WSN

Donghwa Yoo, Sanghwa Chung, Yuvin Ha
Department of Electrical, Electronic and Computer Engineering Pusan National University Busan, South Korea
donghwayoo@pusan.ac.kr, shchung@pusan.ac.kr, yoobin1013@gmail.com

Abstract— Recent studies on IIoT (Industrial IoT) are drawing attention. IEEE 802.15.4e TSCH MAC technology is widely used because it requires high reliability and stability due to the characteristics of industrial environment. However, existing studies using TSCH take a single path transmission scheme. In terms of stability, the single path transmission scheme has disadvantages in that it transmits data using only the preferred parent node and takes much time to recover the path in case of failure. Therefore, we propose a multipath scheduling scheme for energy balancing and reliable transmission over 6TiSCH WSN.
Keywords—IEEE 802.15.4e; 6TiSCH; Multipath;TSCH; 6p Transaction; Balancing;fault-tolerant
I. INTRODUCTION
TSCH (Time Slotted Channel Hopping) MAC is a technology included in the IEEE 802.15.4e MAC revision [1] that provides high reliability and stability as a standard technology for industrial wireless sensor networks such as WirelessHART [2] and ISA100.11a [3]. [4] The slot offset within the slot frame promised between the two nodes to communicate with and the channel offset which is the index of the available channel list are shared with each other. Then, communication is performed from the promised slot offset to the corresponding channel offset. [5] By performing communication using different channels at each slot offset, stability is secured from physical characteristics such as multipath fading as compared with CSMA / CA, used in industrial environments.
RPL is a de facto routing method of WSN based on forming DODAG (Destination Oriented Directed Acyclic Graph), with border router as root. Routing of each node of DODAG consists of exchange of control message DIO (DODAG Information Object) and DAO (Destination Advertisement Object) [6]. The DIO allows the nodes to discover the RPL instance and selects the parent node through the included configuration parameters so that it can be configured as a DODAG. The selection of the parent node is based on the virtual distance from the root node, rank. And receives a DIO from neighboring nodes and selects a node having a smaller rank, that is, a node having a short virtual distance to the root node, as a parent node. The DAO propagates the destination information to the parent node. If the non-storing mode is used, it is sent to the root node of the DODAG. Then, it finds the subordinate node and finally constructs the path.

To avoid loops in constructing a DODAG in this way, each node chooses one preferred parent node for the path configuration and the remaining neighbor nodes are reserved for use in the failure of the preferred parent node. In the TSCHbased communication, except for the 0th slot offset, which is a beacon slot, cell allocation is required for communication between nodes. 6p Transaction of WG 6TiSCH (IPv6 over the TSCH mode of IEEE 802.15.4e) is made through a negotiation between the two nodes as 6TiSCH standards for cell assigned at TSCH environment [7]. It triggers when one of the two nodes using the same Scheduling Function triggers to add / delete / relocate one or more cells. If there is a dedicated cell between two nodes, a 6p transaction is made in the dedicated cell, otherwise it is done in a shared cell.
Currently, the IEEE 802.15.4e standard does not define the details of the scheduling scheme, and existing implementations support transmission using a single parent node. If a single path is used on a WSN, each node has a different amount of energy depending on the number of child nodes and the number of packets to be processed. This causes a specific node to be disconnected and has an overhead for path restoration.
On the other hand, if multipath scheme is used, it has advantages in terms of load balancing, energy balancing, and lifetime [8] of WSN by transmitting data using neighbor nodes
Fig. 1. An example of 2 – step 6p Transaction between node A and B [7].

978-1-7281-1340-1/19/$31.00 ©2019 IEEE

555

ICUFN 2019

in addition to the designated preferred parent node. Therefore, to utilize the advantages of multipath in TSCH environment, we propose a multipath transmission scheme using RPL and 6p transaction.
II. RELATED WORK
The transmission scheme that improves reliability by using multipath is considered by other researches. In this section, we analyze the advantages and disadvantages of the existing methods compared with the methods proposed in this paper.
A. Method for path recovery
In the WSN environment based on TSCH, 6p transaction is used to allocate resources and configure a path for communication. Except for not thinking about balancing issues and the inevitable node failure situations, this type of operation is not a problem in producing and processing data. Failure due to sudden structure disturbance or external interference that occurs during the operation of all the cell allocations is completed causes problems. The failed node first senses the ETX (Expected Transmission Count) increase from itself to the preferred parent node and attempts to change the preferred parent node accordingly. Therefore, it is required to allocate the cell to the next neighboring node by using the rank value calculated based on the DIO, and the existing cell is deleted. Once the cell assignment is successfully completed for the new preferred parent node, the data can be transmitted again. At this time, data can’t be transmitted during the selection of a new parent node for recovery and during the period in which a cell is allocated. This data blanking may be fatal depending on the requirements of the application.
On the other hand, the multipath scheme in the proposed paper can improve PDR and seamless data transmission because the cell is already allocated to the lane node even when the preferred parent node fails.
B. Multipath study using IEEE 802.15.4 Beacon mode
There are many studies on multipath on WSN. Most of them use the slotted CSMA / CA scheme using IEEE 802.15.4 Beacon mode. In [9], they proposed a method to maximize lifetime of all nodes on WSN using ELT metric. This maximizes the operating time of the bottleneck node using residual energy and ETX. However, in the experiment, the data rate is one packet per minute, and the critical condition requiring short data interval is not considered.
C. Multicast method using CSMA MAC
The 0th cell of TSCH is a shared cell and all nodes can communicate. Therefore, if an excessive amount of data is transmitted using the shared cell at one time, it may cause a lot of collisions. As in the experimental results of [10], the broadcast of the link layer causes a higher collision than the unicast of the link layer. Therefore, when receiving information for constructing a multipath from neighboring nodes, the link layer unicast is used to perform a time period in which the neighboring nodes do not overlap when receiving responses from multiple neighboring nodes.

III. PROPOSED APPROACH In the WSN environment using 6TiSCH's 6p transaction, the nodes are distributed and synchronized to RPL instance through EB (Enhanced Beacon) and constitute the path by exchanging RPL control message. Then it starts a transaction to allocate a designated cell to pass its data. At this time, since there is no cell assigned to each other between two nodes, information is exchanged using shared cells such as EB or DIO. The shared cell is a contention-based communication and all the nodes in the DODAG can communicate. Therefore, even if the neighboring node is not the preferred parent node, if the shared cell is used, the desired information can be transmitted and received.
A. Cell Information exchange for Multipath configurations In the conventional method using a single path, a dedicated
cell is allocated as described above, and the data of the own node is transmitted to the preferred parent node. The proposed scheme uses the neighbor candidate nodes with higher rank values than the candidate parent nodes. A candidate node with a rank value lower than its own as a target of multipath transmission is to prevent loop formation in data transmission on the DODAG. Only the cell for data transmission is added to the neighbor node while maintaining the information of the previously selected preferred parent node. Through this, multiple paths are constructed using nodes other than the preferred parent.
B. Information to calculate the balancing ratio In order to balance the traffic load and energy between the
preferred parent node and its neighbor nodes, the child node uses ETX indicating the communication quality in addition to the statistical information of the parent node.
As shown in Fig. 2., the most energy consuming part of the WSN is the radio part for communication [11]. In other words, the amount of energy used by nodes performing synchronized and specified operations at similar times is proportional to the number of packets received or transmitted by them [9]. In order to prevent energy imbalance between the two nodes, this information is used to increase the throughput to the node that
Fig. 2. Comparison of energy consumption according to each situation by using cc2538 radio chip.
.

556

consumed a relatively small amount of energy and to balance the energy side by reducing the transmission amount of the other node. Based on this goal, when the operation for multipath configuration is started, the candidate nodes send the number of packets processed by itself, that is, the total number of tx and rx generated by itself, in response.
The ETX is an index that indicating how many times a total transmission is performed when the node transmits itself to the correspondent node. It means that the closer the ETX is to 1, the better the communication state. Attempting to retransmit excessively to a node with poor communication may be an overhead, so that a node with a relatively high ETX has a low transmission opportunity.
C. Allocation of transmission rate using ASN The Absolute Slot Number (ASN) is the same value for all
nodes in a single WSN that are operating in synchronization with the number of slots started and the number of slots processed so far. The length of the slot frame defined by the standard is 101. The number of the last digit is 1, which is the generator number and can be summed to produce all numbers between 0 and 9 as the last digit. Fig. 3. shows the frequency of average occurrence of the last digit of ASN for one hour that repeated 10 times. At most 361.4 times 3 and at least 353.8 times 6 are appeared. The average value is 356.5 and the standard deviation is 6.555, which means that the last digit of all ASNs appears quite fairly.
Therefore, if the ASN is allocated as a resource for the transmission opportunity, the nodes that utilize the multipath transmission can control the transmission amount according to the rate determined by the equations. D. Equations for calculating transmission ratio
The lower the parameters for the ratio estimation are, the better the values are. Therefore, we use the inverse ratio as shown in below equations.
The total sum of the n packet throughputs of the candidate nodes and the total sum of ETX are obtained as in (1), (2).
The ratio of inverse is calculated by dividing its value by the result of (1), (2) in (3) and (4).
Fig. 3. Graph showing the average occurrence of the last digit of the ASN in the dedicated cell according to the experiment for 1 hour that repeated 10 times.







































 

Equation (5), (6) are the process of calculating the integer value that calculated as the inverse ratio to the integer ratio so that it can be used for the ASN allocation.
In (7), the  value is a parameter that can be tailored to your application's requirements. It is possible to satisfy the criteria of communication quality or energy consumption.

E. Fault-tolerant feature
Advantages of assigning resources to candidate nodes in advance by using multipath are flexibility in coping with the use of even energy usage and failure of an upper node. When a child node independently checks the transmission status of an upper node and a problem above a predetermined threshold occurs, the child node gets fault tolerance by transmitting all data to the candidate node that has been previously allocated and used.
When the existing method is used, if the communication with the parent node becomes worse, the update is executed, and a new parent node is selected and a 6p transaction is performed. On the other hand, in the proposed scheme, since both the candidate node and the parent node are performing the operation by allocating the cells, the seamless transmission can be performed except for the data lost in detecting the problem of the upper node.

F. Algorithms

557

Algorithm 1. Operation of nodes

1: Node already has dedicated cell

2: If (Have multiple neighbors) Then

3: If (LOWER_RANK) Then

4: for each # of neighbors do

5:

Propagate my schedule info using unicast

6: Else

7: If (Received schedule info packet

8:

AND don’t have schedule) Then

9:

Allocate Cell

10: End if

11: If (Have dedicated cell) Then

12:

Store sender info

13:

Get and response statistic info to sender

14: End if

15: End if

16: End if

17: If (Received statistic info from neighbors) Then

18: Get ETX of neighbor

19: Calculate balancing ratio using statistic info and ETX

20: Allocate ASN based on balancing ratio

21: Else

22: If (# of tries < MAX_TRIES) Then

23: Retransmit schedule info to neighbor node

24: End if

25: End if

26: If (ASN allocated) Then

27: Get next hop by assigned ASN

28: Send packet

29: End if

Algorithm 1 shows the operation of nodes. After compl-

eting the assignment of the dedicated cell from its preferred

parent, it searches for neighboring nodes that can be the targets

of the multipath. Basically, it requires two or more nodes in

order to construct multipath, so it checks the rank information

of the nodes and confirms the lower rank so that the data can be

normally transmitted to the upper traffic. When the above two

conditions are confirmed, the child node transmits the

scheduling information allocated by the child node to the MAC

layer unicast.

If the packet is received from a higher rank, it is checked whether it is containing the schedule information and that it does not currently have this schedule. In this case, to prevent the occurrence of loops, sender's rank information is checked and ignored if the schedule is not from the lower layers. After then, if the cell is normally allocated, it stores the information of the node that desires to use the multipath, calculates the number of its own Tx and Rx packets, and transmits it as a response.

Upon receipt of the response to the schedule information sent by itself, ETX information of the node is calculated. Also, statistical information of neighboring nodes received in packets is obtained. Based on these two pieces of information, the ratio to be transmitted to the candidate nodes is calculated. The result of this calculation is assigned as a ratio of transmission opportunities through the ASN. If the statistical information is not correctly received, the multipath configuration is retried until the maximum number of retries is exceeded.

Algorithm 2. Detect and detour failed node

1: Find Destination parent node

2: If (ACKed) Then

3: Decrease unstable counter

4: Else

5: Increase unstable counter

6: If (counter > FAILURE_THRESHOLD) Then

7: If (isPreferredParent) Then

8:

Change preferred parent node

9:

Detour traffic to the other parent nodes

10: Else

11:

Forwarding traffic to preferred parent node

12: End if

13: End if

14: End if

15: …

The failure of a parent nodes in the proposed scheme can be

considered as two cases. First, failure of the preferred parent

node. In this case, traffic is transmitted using a cell allocated in

advance to the candidate node, and at the same time, the parent

node is switched. If the parent node successfully changes, a 6p

transaction is performed to allocate the cell between the new

parent node and the child node, and the multipath schedule is

disabled. Second, the failure of the candidate node. In this case,

simply forward the traffic destined for the candidate node to

the preferred parent node and deactivate the multipath schedule.

IV. IMPLEMENTATION AND EXPERIMENT RESULT
A. Implementation
All the algorithms described in this paper are implemented in the OpenWSN stack [12]. The experiment was performed using Openmote-cc2538. The topology of the network is configured as shown in the following Fig. 4. One sink node, four relay nodes of layer 1, and three traffic nodes of layer 2 were used. The slot frame is composed of 101 slots as in the standard and uses 2.4 GHz frequency, and the length of one slot is 10ms. All nodes including the route record the ASN at each hop in transmission, measure the delay between each hop, and fix the payload size to 50 bytes. The packet interval is assumed to occur in 10 seconds. The value of , the parameter for rate adjustment, is used as 0.5, which takes both factors evenly into account.
In Fig. 4, the orange dotted line indicates the connection when configured as a single path and the blue dotted line indicates the path through which the data is transferred when the multipath is activated. The experiment uses the same topology and nodes, compares the case of using single path and the case of using multipath.
B. Experiment Result
The experiment was performed on topology as shown in Fig. 4. and each independent experiment was performed 15 times. The analysis of the experiment is as follows. The first experiment evaluates the performance of existing schemes when using proposed approach. The comparison is on the transmission delay between hop, PDR and finally whether the traffic is accurately distributed according to the ratio calculated

558

Fig. 4. The experimental topology consists of 8 nodes (1 sink node, 4 relay nodes, 3 traffic nodes).
on the node by the algorithm. In the second one, we experiment on reliability of data transmission in case of loss of connection due to poor communication of the preferred parent node.
Fig. 5. shows the average delay time from one traffic hop to the relay node. The orange bar is for single path transmission and the element containing * in the x axis of the blue bar is for multipath. Considering that the length of the slot frame is 101 and the length of one slot is 10ms, the result shows that both cases do not exceed the maximum delay time of 1.01 sec. The conventional method showed 0.948ms, 0.912ms, and 0.878ms, and the proposed method showed 0.888ms, 0.886ms, and 0.842ms, respectively. This is an improvement of 6.3%, 2.8% and 4.1% compared with the conventional method.
The reason for this reduction in delay is that the transmission opportunity is increased when retransmission occurs. An example is a situation in which a local interference occurs only in one of two parent nodes that can receive a packet. Using multipath, it is possible to attempt to transmit to another parent node in this situation using a random sequence of ASNs. Therefore, we can see the improved delay performance compared to the single path method in the transmission process in one hop.
Next is the analysis for the PDR. In Fig. 6, the PDR of the

conventional single path was 98.5%, 96.9% and 96.2% in orange bars. In case of using the multipath used by the proposed technique, the blue bars achieved 98.2%, 97.8% and 98.2%, respectively. In both cases, stable PDR of 96% or more was obtained using the characteristics of the TSCH MAC. Even when the transmission is performed using a plurality of parent nodes, a failure in the mac layer or a loop on the RPL is not detected. Therefore, it can be confirmed that the proposed technique operates without any abnormality and shows high stability.
At last, we look at the difference between the actual ratio of packets transmitted and the distribution ratio calculated by the algorithm. In general, the error is less than 5%, which is divided according to the intended ratio. The three nodes have error rates of up to 4.43%, 4.23%, and 4.62%, respectively, and when they are changed to the number of packets, they represent 15 to 16 packets. These results mean that proposed method distributes the sent or received packets as calculated to solve energy imbalance in WSN. Because the energy usage of a node is proportional to the number of packets it generates or relayed.
There are two reasons for the error in the transmission amount. The first is the retransmission, and the ASN is different if the transmission can’t be sent in the originally intended ASN time and the transmission is extended with the next slot offset. At this time, it is not a problem if the ASN is allocated to the same node, but if the ASN is allocated to another node, the transmission is performed differently from the rate calculated by the node. The frequency of occurrence of ASN with a standard deviation of about 6 also has a small effect. If observations are performed over a longer period of time, the final frequency of occurrence will be in convergence but will show a relatively small variation in short time.
In the second experiment, a total of 100 packets are transmitted. 40 packets normally perform transmission, and then assume that the node fails by dropping the packet on the preferred parent node side. Both cases were repeated 20 times with 10 minutes of period. The results of the conventional method are 67.75% and the proposed method is 93.15%.
In case of using a single path, it is impossible to perform data transmission while searching for a second-best node and allocating resources to it in case of detecting failure of an upper

Fig. 5. The following graph shows the average of one hop delay value in the experiment results. Each element A, B, and C represents the node in Fig. 4, and the result with * is the result of using the method proposed in this paper.

Fig. 6. The graph shows the PDR that the packet sent from each traffic node reaches the sink node. The orange bar is the result of a single path, and the blue is the result of multipath.

559

the energy imbalance of the nodes on the WSN can be reduced, and the performance improvement of the hop delay can be observed. In addition, even in the case of failure of an ancestor node, it is possible to achieve high reliability through the proposed scheme by performing continuous transmission using resources previously allocated.

Fig. 7. The error rate of the balancing ratio, which is obtained by analyzing the transmission rate distributed through the algorithm and the number of packets that transmitted.

ACKNOWLEDGMENT
This research was supported by the MSIT(Ministry of Science and ICT), Korea, under the ICT Consilience Creative program(IITP-2019-2016-0-00318) supervised by the IITP(Institute for Information & communications Technology Planning & Evaluation).
This work was supported by the Korea Institute of Energy Technology Evaluation and Planning(KETEP) and the Ministry of Trade, Industry & Energy(MOTIE) of the Republic of Korea (No. 20182020109660).

Fig. 8. Average PDR comparison of existing method and proposed method when communication problem with preferred parent node occurs.
node. Therefore, the data for the relevant time can’t be reached to the gateway. On the other hand, if resources are already allocated to candidate nodes, the loss of data can be reduced by detecting instability and forwarding traffic to other nodes accordingly. Also, in performing the process of allocating a new cell, transmission can be performed concurrently through the previously allocated cells, thereby achieving higher reliability.
V. CONCLUSION
In this paper, we propose a multipath transmission scheme in WSN using TSCH MAC. First, a single path is constructed using RPL control messages and a 6p transaction of 6TiSCH WG, and additional multipaths are constructed using the allocated cell information. After constructing the multipath, the amount of energy used by the parent nodes and ETX were used to calculate the ratio of load & energy balancing. In this way,

REFERENCES
[1] “IEEE Standard - Part 15.4: Low-Rate Wireless Personal Area Networks(LR-WPANs) Amendment 1: MAC sublayer,” IEEE Std 802.15.4e-2012(Amendment to IEEE Std 802.15.4-2011).
[2] HART Field Communication Protocol Specifications, Revision 7.1, HART Communication Foundation Std., 2008.
[3] Higyway Addressable Remote Tranducer, a group of specifications for industrial process and control devives administered by the HART Foundation. Available at: http://www.hartcomm.org.
[4] O. Iova, F. Theoleyre, T. Watteyne, and T. Noel, “The love-hate relationship between ieee 802.15. 4 and rpl,” IEEE Communications Magazine, vol. 55, no. 1, pp. 188–194, January 2017.
[5] T. Watteyne, S. Lanzisera, A. Mehta, and K. S. J. Pister, “Mitigating Multipath Fading through Channel Hopping in Wireless Sensor Networks,” in 2010 IEEE International Conference on Communications, pp. 1–5, May 2010.
[6] T. Winter et al., RPL:IPv6 Routing Protocol for Low-Power and Lossy Networks, RFC 6550, IETF, 2012.
[7] Q. Wang et al., 6TiSCH Operation Sublayer (6top) Protocol (6P), RFC 8480, IETF, 2018.
[8] R. Kacimi, R. Dhaou and A. Beylot, Load balancing techniques for lifetime maximizing in Wireless Sensor Networks, Ad Hoc Networks, 11(8):2172-2186, November 2013.
[9] O. Lova, F. Theoleyre and T. Noel, Using multiparent routing in RPL to increase the stability and the lifetime of network, Ad Hoc Networks, 29, pp. 45-62, February 2015.
[10] G. F. Lorente, B. Lemmens, M. Carlier, A. Braeken and K. Steenhaut, BMRF: Bidirectional Multicast RPL Forwarding, Ad Hoc Networks, 54, pp. 69-84, October 2016.
[11] CC2538 datasheet [online], Available at: http://www.ti.com/lit/ds/symlink/cc2538.pdf. April 2015.
[12] Berkeley’s openwsn [online], Available at: https://openwsn.atlassian.net/wiki/spaces/OW/overview

560

