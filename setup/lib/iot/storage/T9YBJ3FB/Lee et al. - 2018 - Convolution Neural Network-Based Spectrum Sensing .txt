Convolution Neural Network-based Spectrum Sensing for Cognitive Radio Systems using USRP
with GNU Radio

Gyu-Hyung Lee, Young-Doo Lee, In-Soo Koo
Dept. of Electrical Engineering University of Ulsan
Ulsan, Republic of Korea dlrbgud1004@ulsan.ac.kr, leeyd1004@naver.com, iskoo@ulsan.ac.kr

Abstract— Spectrum sensing is the core technology in cognitive radio systems to find the available channel. In spectrum sensing, the energy detection has a disadvantage that it is difficult to detect the signal of the primary user in the low SNR. In this paper, we use a convolution neural network to enhance the performance in low SNR. For the practical test, the proposed scheme is implemented with Universal Software Radio Peripheral National Instruments 2900 devices. The experimental results of the proposed scheme are compared with the energy detection using accuracy metric according to SNR. With simulation results, we demonstrate that the proposed scheme shows much better performance in low SNR.
Keywords— Cognitive radio networks; Spectrum sensing; Convolution neural network; USRP; GNU Radio
I. INTRODUCTION
As the 4th industrial revolution has progressed, the demand for frequency resources has also increased sharply as the number of devices using frequency increases exponentially. Because frequency is a finite resource, there is a limit to assign frequencies to all users and devices. According to the Federal Communications Commission (FCC) frequency use analysis, only about 15 to 80% of frequencies are actually used at a certain time and place for already allocated bands [1-2]. Cognitive radio (CR), which finds and communicates a spectrum hole, has been announced by the Notice of Proposed Rule Making (NPRM) [2] to efficiently use this idle frequency.
The cognitive radio technology allows a secondary user (SU) to use the frequency on condition that it does not interfere with communication of the primary user (PU) when the frequency allocated by the PU is not used. Spectrum sensing is one of the core technologies of cognitive wireless systems, which analyzes the frequency spectrum in the cognitive radio system and determines whether the PU is using the frequency. Spectrum sensing techniques include energy detection (ED), matched filters, and signal characterization detection [3].
One of the limitations of this energy detection is that as the signal to noise ratio (SNR) is lowered, the performance deterioration of the spectrum sensing occurs significantly.
In this paper, Convolutional Neural Network (CNN), one of the machine learning algorithms in artificial intelligence is

applied to spectrum sensing to improve the performance
deterioration of energy detection. CNN applies the convolution
concept to the neural network (NN) to learn the data patterns that
increase the classification performance and maximizes the
performance of the classifier based on this.
We implement a CR system by using the Universal Software Radio Peripheral (USRP) National Instruments 2900 devices and evaluate the sensing performance of spectrum sensing based on CNN in a real environment. The proposed method uses real signal data obtained from USRP as training data and test data of CNN to derive even larger performance improvement than energy detection in the low SNR band. The performance metrics are score calculations of how well spectrum sensing distinguishes the frequency usage state of the PU, and the accuracy of the calculated results is used to calculate the performance of the energy detection and the proposed spectrum sensing based on CNN. We compare and analyze spectrum sensing performance of the CNN based on spectrum sensing and the energy detection according to SNR.

II. SYSTEM MODEL
In this paper, we propose spectrum sensing based on CNN using a USRP 2900 device with GNU used to collect the sensing signal data. For spectrum-sensing two hypotheses are modelled as follows: the PU signal absence :  and presence : . The received signal () at the SU can be expressed as [1-3]:

() = (()) + ()

∶  ∶ 

(1)

where =1, …, N, N is the number of samples, () is AWGN with zero mean and variance , and () is a signal transmitted from the PU.
The SU senses the channel assigned by the PU user and obtains the sensing signal data. This signal data is divided into training data and testing data. The training data is used for model learning of the CNN through convolution layer, pooling layer and fully connected layer. Testing data is used to evaluate performance of the CNN model obtained through the above process.

978-1-5386-4646-5/18/$31.00 ©2018 IEEE

862

ICUFN 2018

Fig. 1. PU transmitter and SU receiver with USRP hardware

Fig. 2. The block for generating the PU signal

A. Data acquisition
In our experiments, two USRP boards are used: the PU signal is a generated signal for the first board, whereas the second is used for spectrum sensing and acted as the SU. Fig. 1 shows PU transmitter and SU receiver with USRP hardware. Each device represents a transmission part (Tx) and a receiver part (Rx) and is separated by 50cm. All software processing is realized in the open-source GNU Radio environment [4]. The block for generating the PU signal is shown in Fig. 2, and the block for the SU to sense and store the PU signal is shown in Fig. 3. The center frequency of USRP is set to 2.48GHz to avoid interference. The signal source is mapped to a QPSK symbol and modulated based on OFDM. The signal is obtained by turning on both the USRP devices acting as the PU and the SU. The signal is obtained by turning off the USRP device acting as the PU and turning on only the USRP device acting as the SU.
B. Maintaining the Integrity of the Specifications
CNN is one of the deep learning technologies and has the structure of multilayer artificial neural network [5-7]. CNN consists of convolution layer, pooling layer, and fully connected layer and shows difference in learning time and performance depending on many parameters such as the configuration of each layer, size of the filter, initial weight, and so on. Fig. 6 shows a CNN model designed for spectrum sensing.
In the convolution layer, the features of the sensing signal data are extracted using the convolution method. The convolution operation is performed between the sensing signal data and the two-dimensional filter. The size of the feature map, which is the output of the convolution operation, is determined by the size, stride, and padding of the filter applied in each convolution layer. The result filtered by the convolution operation is used as an input to the ReLu function [6], which is one of the activation functions, and then passes to the pooling layer.
The pooling layer performs subsampling to reduce the size of the feature map of the convolution layer. Main methods such as max pooling and average pooling are used, and robust feature vectors can be extracted from the feature map.
All nodes used in the fully connected layer are connected to all the nodes in each layer and perform internal operations.
Finally, the state of the channel is determined by using the features obtained from the pooling layer as input.

Fig. 3. The block for the SU to sense and store the PU signal
EXPERIMENTS AND RESULT
We have tested a QPSK signal centered on the 2.48 GHz carrier frequency. On the receiver side, the sensing signal data when PU is absent is shown in Fig. 4. Fig. 5 shows a sensing signal on the receiver side when the PU is present.
In GNU Radio, we can observe received signals based on the FFT sink block. Moreover, the processed signal at the SU is stored in a data file through the File Sink block, and then, we use this data file for analysis in MATLAB and for CNN based on spectrum sensing in Python.
In order to evaluate the performance of spectrum sensing according to SNR, we performed experiments at SNR band from -5dB to -9dB by 1dB intervals. For the learning and performance evaluation of CNN, total 20,000 datasets were made by USRP for each SNR band with 10,000  and . The 60% of data was used to train CNN. The remaining 40% was used for performance evaluation. In this experiment, the number of samples for the sensing signal in spectrum sensing was set to 300.
The implemented CNN model consists of 3 convolution layer, 3 pooling layer and a fully connected layer. The size of the filter used in each layer of the convolution layer is 3x3, the stride is 1, and zero padding is used. 30 feature maps were used for the first convolution layer, and 60 and 90 feature maps were used for the second and third feature maps, respectively. In the pooling layer, the max pooling method was used and subsampling was performed in 2x2 size. The fully connected layer consists of a hidden layer with 400 nodes and an output layer with 2 outputs.
ADAM optimization was used in back-propagation to train CNN and dropout was used with a probability of 0.7 to prevent over-fitting.

863

Fig. 4. The plot of the sensing signal data, when PU is absent.

Fig. 6. The structure figure of CNN

Fig. 5. The plot of the sensing signal data, when PU is present.

The conventional energy detection method estimates the square sum energy for the sampled signal and compares it with the threshold value to determine the PU’s frequency use [2]. If the estimated energy is larger than the threshold value, it is determined that the PU is using the frequency, and otherwise, it is determined that the frequency is not used by the PU. In this experiment, as shown in Eq. (2), we use the optimal threshold to minimize the error probability.

ℎ =  min( + 1 − )

(2)

where ℎ is the optimal threshold,  is the probability of false alarm, and  is the probability of detection.
Fig. 7 shows the performance of spectrum sensing based on CNN and energy detection. The accuracy of the proposed method is higher than energy detection. Energy detection shows deeply a decline from -5dB to -9dB. However, the spectrum sensing based on CNN maintains steady performance close to 100%.

III. CONCLUSION
In this paper, we proposed a spectrum sensing based on CNN to improve performance at low SNR comparing with energy detection in the cognitive radio system. To show a performance, we used the accuracy. We compared the proposed method and the energy detection using the real data created by USRP. Simulation results show that spectrum sensing based on CNN at low SNR band has improved accuracy compared to energy detection method. This experiment only showed results for the SNR band from -5dB to -9dB. Future work will be to increase the SNR range to -20 dB and then show the performance of spectrum sensing based on CNN

Fig. 7. The accuracy of CNN and energy detection
ACKNOWLEDGMENT
This research was supported by Basic Science Research Program through the National Research Foundation of Korea(NRF) funded by the Ministry of Education(2015R1D1A1A09057077) as well as by the Korea government(MSIT)(2018R1A2B6001714)
REFERENCES
[1] Oh-Soon Shin and Yo-An Shin, “ An Improved Combining of Hard Decisions for Cooperative Spectrum Sensing in Cognitive Radio Systems ” , The Journal of The Korean Institute of Communication Sciences, Vol. 34, No. 2, pp. 132-138, Feb 2009.
[2] So-Young Lee and Jin-Young Kim, “ Optimal Soft Decision for Cooperative Spectrum Sensing in Cognitive Radio Systems”, The Journal of Korean Institute of Electromagnetic Engineering and Science, Vol. 22, No. 4, pp. 423-429, Apr 2011.
[3] Jun-Ho Baek, Jong-Hwan Lee, Hyeong-Joo Oh and Seung-Hoon Hwang, “Performance Improvements of Energy Detector for Spectrum Sensing in Cognitive Radio Environments: Verification using Time delay” , The Institute of Electronics Engineers of Korea, Vol. 45, No. 1, pp. 72-77, Jan 2008.
[4] Gnu radio - the free and open software radio ecosystem. [Online]. Available: http://gnuradio.org/
[5] Shahrzad Faghih-Roohi, Siamak Hajizadeh and Alfredo Núñez, "Deep Convolutional Neural Networks for Detection of Rail Surface Defects", International Joint Conference on In Neural Networks (IJCNN), pp. 25842589, 2016.
[6] Dean Lee, Vincent Siu, Rick Cruz, and Charles Yetman, "Convolutional Neural Net and Bearing Fault Analysis", in Proc. Int. Conf. Data Min., Las Vegas, NV, USA, pp. 194–200, 2016.
[7] Min Meng, Yiting Jacqueline Chua, Erwin Wouterson, and Chin Peng Kelvin Ong, "Ultrasonic signal classification and imaging system for composite materials via deep convolutional neural networks", Neurocomputing, Vol. 257, pp. 128-135, 2017

864

