Tone mapping High Dynamic Range Image using Cone Response Function based on CAM16

Ho-Hyoung Choi
Advanced Dental Device Development Institute (A3DI), Kyungpook National University, 2177 Dalgubeol-daero, Junggu, Daegu 41940, Republic of Korea
chhman2000@msn.com

Eung-su Kim
School of Computer Science and Engineering, Kyungpook National
University, Daegu 41566, Republic of Korea
jsm80607@gmail.com

Byoung-Ju Yun
School of Electronics Engineering, College of IT Engineering,
Kyungpook National University, Daegu 41566, Republic of Korea
bjisyun@ee.knu.ac.kr

Abstract— This article presents a tone mapping approach to overcome several problems in the conventional tone mapping methods. The proposed tone mapping method is composed of tone mapping operator and cone response function based on CAM16 using CIE XYZ tristimulus values. In order for the resulting image to represent the detail information and to achieve the one-to-one correspondence without color distortion like color leakage, hue shift, and luminance shift, the proposed tone mapping operator consists of two parameters by using logarithmic function and power function, respectively. In addition, the adaptive gamma correction is used to control the dynamic range in the given image, parameter free. Thereafter, the resulting image is finally processed by using CAM16 to deal with mismatch between real-life scene and displayed image. The experimental results show that the proposed method yields better performance of the tone mapping over the conventional method in subjective and quantitative quality and color reproduction.
Keywords— XYZ tristimulus value, color distortion, detail information, tone mapping operator, cone response function
I. INTRODUCTION
The human visual system (HVS) consists of two types of photoreceptors. The retina features cones and rods with different spectral sensitivity; rods are geared towards low luminance level; cones are involved in a case of high luminance level. The function of these photoreceptors supports visual adaptation, which allows human vision to perceive a wide range of luminance in real-life scene. A large luminance change influences the quality of the captured image using an imaging system now that the dynamic range of the imaging systems and current display devices is limited. For this reason, the captured images (or displayed images) are over or under-saturated in daylight conditions and then the saturated images lose color appearance information such as hue, colorfulness, chroma, brightness, and lightness. The objective of HDR imaging is to overcome the limitation of the current imaging techniques and low dynamic range (LDR) display devices as well as to improve these problems. Thus, in recent years, researchers and institution begin to emphasize on generating HDR imaging from low dynamic range images (LDRIs) [1],[2].

HDR imaging is composed of tools and techniques to capture, store, transmit, and display images with considerably higher fidelity than can be achieved with conventional imaging techniques. Thus, an important aspect of HDR imaging involves the reproduction of images on conventional displays. Now that in such cases, the dynamic range of image can be much higher than the display device can accommodate, dynamic range reduction techniques need to be employed [36]. So, high dynamic range images (HDRIs) should be reshaped so that output image follows the dynamic range of conventional LDR displays, which is called tone mapping operator (TMO) [7]. In order to do this, many algorithms have been proposed by researcher and institution. However, the conventional methods are of several problems such as color leakage, luminance shift, hue shift and so forth.
Accordingly, this article presents a tone mapping approach for HDRIs, which consists of the TMO and chromatic adaptation transform (CAT) based on CIEXYZ tristimulus values. The contribution of the proposed tone mapping method is to represent the detailed information and to enhance the contrast based on the human visual perception in the given HDRIs without color distortions by using TMO and CAM16 instead of the CIECAT02.

II. PROPOSED METHOD

The tone mapping operator is to control the dynamic range

and to represent detailed information in the given HDRI. To

do this, the input image in the proposed tone mapping operator

is presented in CIE XYZ tristimulus value that ideally would

be linear and specified in absolute value. It is assuming that

the image is given in the CIE XYZ tristimulus values and that the absolute luminance Y channel is expressed in cd/m2. The

proposed tone mapping operator is of two parameters based on

logarithmic function and power function to represent detailed

information and one-to-one correspondence in the given

HDRIs. Based on the absolute luminance Y channel ( , the

parameters,

and

, are calculated as

follows:

978-1-7281-1340-1/19/$31.00 ©2019 IEEE

639

ICUFN 2019

where rounds to the nearest integer greater than or equal to , and rounds to the nearest integer less than or equal to . In Eq. (1), the logarithmic function approximates the transformation performed by the retina of the HVS. Therefore, the detailed information in the given HDRI will be well represented in the resulting image. In Eq. (2), the power function is adopted to achieve the one-to-one correspondence, as mentioned above. From the Eq. (1) and Eq. (2), the tone mapping operator is described as follows:
(3)

where

refers to the input luminance

based on CIE XYZ tristimulus value. is defined as the

adaptive gamma correction.

The CAM16 model is then adopted to deal with the mismatch

between the real-life scene and the displayed image based on

HVP.

(e) Fig. 1. “Montreal_float_o935” image with (a) Original image (b) iCAM06, (c) Reinhard’s method, (d) Choi’s method, and (e) Proposed method.

(a) is original image which is widely used to access the

performance. In addition, now that these images influence

over-illumination condition, these images are of high contrast.

(b), (c) and (d) show the resulting image based on the

conventional methods. As result, the conventional methods are

of colour distortion in the entire resulting image. (e) is the

resulting image from the proposed method. The colour

distortion problem overcomes in the resulting image.

The captured images under five standard illuminations (A,

CWF, TL84, UV, and D65 illumination) are used to

objectively conduct quantitative measurement of the

performance. Figure 2 and Table 1 are the result of the colour

difference (

)[11] based on

IPT colour space so as to measure the colour reproduction

degree after correcting the colour. The colour space is based

on the human visual perception (HVP).

III. EXPERIMENTAL RESULTS
For feasible experiment, a number of well-known HDRI and the captured images under five different standard illumination (A, D65, TL84, UV, CWF) are presented. These HDRIs are publicly available, and widely used to access performance for the tone mapping method. The resolution of the test images is 1025×769. The resulting images as shown in Figure 1 are obtained after performing the tone mapping method such as iCAM06[8], Reinhard’s method[9], Choi’s method[10], and proposed method.

(a)

(b)

(c)

(d)

Fig. 2. Color difference ( space using IPT color space.

) based on uniform color

Table 1. Color difference ( color space using IPT color space
iCAM06 Reinhard

) based on uniform
Choi Proposed

A_illumin 36.158 35.1391 35.5482 35.0713

CWF_illumin 36.1468 36.1597 35.8051 35.4803

D_65

36.1512 35.1368 35.3923 35.1892

TL84_illumin 36.2546 36.2667 35.7471 35.7176

UV_illumin 36.2694 36.2738 35.8144 35.7314

The proposed method is of the state of the art performance in that the proposed method is of lower scores in the assessment of the error, compared with conventional method.

640

IV. CONCLUSIOIN
HDR content can be visualized only on specialized displays with much higher luminance range and contrast ratio. Given that this technology is still in its infancy, the only way to visualize HDR content on conventional display devices is through tone mapping. In addition, tone mapping can also help in HDR content compression. As a result, it is an important and indispensable tool in HDR processing. Unfortunately, even if much work achieved by the researchers and institutions has been done on the tone mapping technique to enhance contrast, brightness, and visibility of LDRIs, the effective method has yet to be developed. That is, local tone mapping and global tone mapping techniques are of several problems such as color shift, luminance changes, and hue shift and so on.
Accordingly, this article presents a tone mapping approach to overcome these problem in the conventional tone mapping technique, which consists of tone mapping operator and cone response function based on CIE XYZ tristimulus values.
In the experimental results, several well-known HDRIs are used to assess the performance. The detailed information in the resulting image is well represented after tone mapping operator by using two parameters. Also, the contrast is well scaled by using adaptive gamma correction. In addition, color difference which is based on the Euclidian IPT color space is adopt to assess the color reproduction degree. The Euclidian IPT color space is adopted to measure the color difference based on HVP. In the results, the proposed method is of lower score than conventional methods except for some illumination images. However, even if the proposed method yields better performance, the proposed method is of somewhat low quality in the case of D 65 illumination image. We will make a study in order to solve this problem, in the timeline of the near future, continuously.

ACKNOWLEDGMENT
This work was supported by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. NRF-2018R1D1A1B07040457).
REFERENCES
[1] Shih-Chang Hsia, and Ting-Teng Kuo, “High-performance high dynamic range image generation by inverted local pattern,” IET Image Processing, vol. 9, no. 2, pp.1083-1091, 2015.
[2] Huo, Y., and Yang, F. “high-dynamic range image generation form single low-dynamic range image,” IET Image Process., vol. 10, no. 3, pp.198-205, 2016.
[3] Erik Reinhard, Wolfgang Heidrich, Paul Debevec, Sumanta Pattanaik, Greg Ward, Karol Myszkowski, High Dynamic Range Imaging: Acquisition, Display and Image-based Lighting, 2nd ed., Morgan Kaufmann, 2010.
[4] Francesco Banterle, Alessandro Artusi, Kurt Debattista, and Alan Chaimers, Advanced High Dynamic Range Imaging: Theory and Practice, CRC press, 2011.
[5] Johnson, G.M., and Fairchild, M.D., “Rendering HDR Images”, Proc. IS&T/SID 11th Color Imaging Conf., Scottsdale, pp.36-41, 2003.
[6] Ronan Boitard, Mahsa T. Pouzarad, Panos Nasiopoulos, and Jim Slevinsky, “Demystifying High-Dynamic Rnage Technology: A new evolution in digital media,” IEEE consumer Electronic Magazine, pp. 73-86, 2015.
[7] Dong, Y., Nasiopoulos, P., and Pourazad, T.M., “HDR video Compression using High efficiency video coding,” UBICOMM 2013, Barcelona, Spain, pp. 205-209, 2013.
[8] Kuang, J., Johnson, G.M., and Fairchild, M.D., “iCAM06: A refined image appearance model for HDR image rendering,” J. Vis. Commun. Image Represent., vol.18, no. 5, pp.406-414, 2007.
[9] Reinhard, E., Pouli, T., Kunkel, T., Long, B., Ballestad, A., and Damberg, G., “Calibrated Image Appearance Reproduction,” ACM Trans. On Graph., vol. 31, no. 6, 2012.
[10] Ho-Hyoung Choi, Gi-Seok Kim, and Byoung-Ju Yun, “Modeling a Color-rendering operator for high dynamic range images using a coneresponse function,” Journal of Electronic Imaging, vol. 24, no. 5, 2015.
[11] Shizhe Shen, Color difference formula and uniform color space modeling and evaluation, Thesis, Rochester Institute of Technology, 2009.

641

