Real-time Drowsiness Detection Algorithm for Driver State Monitoring Systems

Jang Woon Baek, Byung-Gil Han, Kwang-Ju Kim, Yun-Su Chung, Soo-In Lee
Electronics and Telecommunications Research Institute Korea
{jwbaek98, kilyhan, kwangju, yoonsu, silee}@etri.re.kr

Abstract—In this paper, we proposes a novel drowsiness detection algorithm using a camera near the dashboard. The proposed algorithm detects the driver’s face in the image and estimates the landmarks in the face region. In order to detect the face, the proposed algorithm uses an AdaBoost classifier based on the Modified Census Transform features. And the proposed algorithm uses regressing Local Binary Features for face landmark detection. Eye states (closed, open) is determined by the value of Eye Aspect Ratio which is easily calculated by the landmarks in eye region. The proposed algorithm provides realtime performance that can be run on the embedded device. We obtained the dataset using video records from the infrared camera which is used the real-field. The proposed algorithm tested in the target board (i.mx6q). The result shows that the proposed algorithm outperformed in the speed and accuracy.
Keywords—face detection; face landmark; drowsiness; driver state monitoring
I. INTRODUCTION
In order to reduce the accidents due to driver’s drowsiness, the needs of Driver States Monitoring (DSM) systems increases. DSM systems provide the drivers with warning for the drowsiness or fatigue. The DSM systems mainly uses a camera sensor installed on near dashboard, which estimates the eye blink, head poses, or pupil states in the image from the camera [1, 2]. Figure 1 shows an example of the driver state monitoring system which detects the drowsiness or inattention of the driver, and alarm the driver to be attention to driving.
Recently, CNN (Convolutional Neural Network) based face detection methods are proposed, which identifies candidates with RP (Region Proposals) and verifying the candidates based on CNN framework [3-5]. The CNN based detection method has high detection accuracy, however, it requires a long processing time. It takes several seconds to process one frame in the current DSM system which does not have high performance GPUs. The DSM system must provide a warning to the driver to prevent accidents in the driving environment where the vehicle is moving at high speed, so the drowsiness detection algorithm have to provide high detection ratio and real-time processing. In this paper, we focused on more fast and accurate drowsiness detection algorithm using a camera sensor which senses the driver’s face region. Also, we use an infrared camera which can obtain stable image frames at night as well as daytime.

Fig. 1. Driver state monitoring system
II. PROPOSED ALGORITHM
The proposed algorithm uses MCT AdaBoost classifier for the face detection and LBF regressor for the face landmark detection because they are very fast and accurate so as to be running on the embedded device. Fig. 2 shows the flow diagram of the drowsiness detection algorithm. First, the video query process retrieves an image frame from the camera. The input image is pre-processed by Gaussian filtering to remove noise. The proposed algorithm detects the face in the preprocessed image using MCT AdaBoost classifier. MCT feature is robust to the lighting conditions [6, 11]. We uses two-stages cascade classifiers which is composed of weak classifiers. The first stage classifier consists of three pixel position weak classifiers which have the upper high weights. Almost all of the non-objects are filtered out by the first stage classifier. It is determined by the sum of the weights of three weak classifiers whether or not the vehicle is true. The second stage classifier consists of the remaining weak classifiers and determine whether or not the vehicle passed through the first stage classifier is true. And we use Correlation Filter in order to improve the reliability of the face detection [7]. The correlation filter tracks the object by applying a correlation filter to the image transformed into the frequency domain. If a detection miss is occurred, the tracked region is regarded as a face region. In the detected face region, the proposed algorithm finds the face landmark which represents the main point of the face. We use 68 landmarks of 300-w dataset [8]. There are many face alignment algorithms such as ensemble of regression tree [12], regressing local binary features [9], and so on. In order to detect the landmarks, the proposed algorithm uses a method of

978-1-5386-4646-5/18/$31.00 ©2018 IEEE

73

ICUFN 2018

regressing Local Binary Feature (LBF) which consists of local binary feature mapping and global linear regression using random forests [9]. Eye states (closed, open) is determined by the value of eye aspect ratio (EAR) which is easily calculated by the landmarks in eye region. And drowsiness is determined by PERCLOS (PERcentage eye CLOSure) which means the percentage of the time the eyes are closed.

suitable for the DSM systems. We make ground truths (Gt) for drowsiness detection from the video file which was recoded from IR cameras. The accuracy depends on the subjects because some people have large eyes but other people have small eyes. Figure 3 shows the result of accuracy based on PERCLOS, where accuracy is very different according to the subjects and PERCLOS. Accordingly, subject specific drowsiness detection is required. Figure 4 shows the results of the eye closed/open classification.


Fig. 4. Accuray based on PERCLOS(10%, 15%, 20%)
Fig. 2. Drowsiness detection algorithm
We collected the dataset using real video records from the infrared camera. We could not find IR camera based face and landmark datasets. Figure 3 shows the environments for collecting datasets, where we makes 5000 landmark samples.

Fig. 5. Result of eye closed/open classification

ACKNOWLEDGMENT
This work was supported by Electronics and Telecommunications Research Institute (ETRI) grant funded by the Korean government. [18ZD1110, Development of ICT Convergence Technology for Daegu-GyeongBuk Regional Industry]

Fig. 3. Result of eye blink
We tested our drowsiness detection algorithm at target board which has 1GHz i.MX6Quad and 1GB RAM. We evaluated the performance of the proposed algorithm in terms of processing time and detection ratio. At target board, processing time per an image frame is 62ms, which means that 16 frame per second can be processed. This processing time is

REFERENCES
[1] A. Rahman, M. Sirshar and A. Khan, “Realtime drowsiness detection using eye blink monitoring,” Proc. of National Software Engineering Conference, 2015.
[2] T. Danisman, I. Bilasco, C. Djeraba and N. Ihaddadene, “Drowsy driver detection system using eye blink patterns,” Proc. Of International Conference on Machine and Web Intelligence, 2016.
[3] J. Redmon, S. Divvals, R. Girshick, and A. Parhadi, “You Only Look Once: Unified, Real-Time Object Detection,” Proc. of International Conference on Computer Vision and Pattern Recognition 2016, pp. 779-788, Jun. 2016.

74

[4] W. Liu, D. Anguelov, D. Erhan, C. Szegedy, S. Reed, C. Fu, and A. Berg, “SSD: Single Shot MultiBox Detector,” Proc. of the European Conference on Computer Vision 2016, Oct. 2016.
[5] S. Ren, K. He, R. Girshick, and J. Sun, “Faster R-CNN: Towards Real-Time Object Detection with Region Proposal Networks,” IEEE Transaction on Pattern Analysis and Machine Intelligence, Vol. 39, pp. 1137-1149, 2016.
[6] C. Kublbeck and A. Ernst, “Face detection and tracking in video sequence using the modified census transformation,” Image and Vision Computing, Vol. 24, pp. 564-572, 2006.
[7] D. Blome, J. Beveridge, B. Draper, and Y. Lui, "Visual Object Tracking using Adaptive Correlation Filters," Proc. of Computer Vision and Pattern Recognition 2010, pp.2544-2550, Jun. 2010.

[8] C. Sagonas, G. Tzimiropoulos, S. Zafeiriou, M. Pantic, “300 Faces inthe-Wild Challenge: The first facial landmark localization Challenge,” Proc. of IEEE Int’l Conf. on Computer Vision, December 2013.
[9] S. Ren, X. Cao, Y. Wei and J. Sun, “Face alignment at 3000fps via regressing local binary features,” Proc. Of IEEE Conf. on Computer Vision and Pattern Recongnition, 2014.
[10] T. Soukupova and J. Cech, “Real-time eye blink detection using facial landmarks,” Proc. of Computer Vision Winter Workshop,2016.
[11] K. Ban, J. Kim, and H. Yoon, “Gender Classification of LowResolution Facial Image Based on Pixel Classifier Boosting,” ETRI Journal vol.38, no. 2, pp. 347-355. Apr. 2016.
[12] J. Jang, S. Jeon, J. Kim, H. a;nd Yoon, “Robust Deep Age Estimation Method Using Artificially Generated Image Set,” ETRI Journal, vol. 39, no. 5, pp. 643-651, Oct., 2017.

75

