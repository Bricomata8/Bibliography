1
Low Complexity Beam Searching Algorithm Using Asymptotic Property of Massive MIMO Systems
Heeyoung Kim∗, Jaemin Jung∗, Seongbae Han∗, Seokki Kim†, Seungkwon Baek†, and Sooyong Choi∗ ∗School of Electrical and Electronic Engineering, Yonsei University, Seoul, Korea. Email: {khy93, jjmm1000, hsb1531, csyong}@yonsei.ac.kr †Electronics and Telecommunications Research Institute (ETRI), Daejeon, Korea Email: {kimsk0729, skback}@etri.re.kr

Abstract—This paper considers a low complexity codebookbased beam searching algorithm for massive MIMO (Multiple Input Multiple Output) systems in limited scattering environments. Based on the asymptotic property of the massive MIMO systems that the channel array response vector converges to the optimal precoding vector derived from channel singular value decomposition (SVD), we propose a independent selection method for the transmitter (TX) and receiver (RX) beam vectors. Due to the independent selection of the Tx and Rx beam vectors from the asymptotic property, the proposed algorithm has a much lower complexity compared to the full search beam selection method. Furthermore, the proposed algorithm shows the similar data rates to the full search beam selection method at low signal to noise ratio regions in a 6-bit codebook system with 64×64 antennas and 2 RF chains at each TX and RX.
I. INTRODUCTION
In massive multiple input multiple output (MIMO) systems with limited scattering environment, channel array response vector can simply converges to optimal precoding based on channel singular vector as the number of antenna increases [1]. Therefore, the optimal precoding can be realized only with equal gain and analog phase shifters in massive MIMO systems [2], [3]. With such a constrained precoder and combiner architecture, we propose a low complexity codebook-based beam searching algorithm using the asymptotic property of massive MIMO systems.
Although several low complexity beam searching schemes have been proposed, they require several iterations to converge [4], [5]. By exploiting the asymptotic property of precoder and combiner in the massive MIMO systems, we can ﬁnd half of the beam combination in the analog codebook using the closed formula. That is, half of the beam can be obtained from the singular vector of the channel. Then, we are able to select the remaining beam combination with full search beam selection method. Therefore, we just investigate much smaller size of beam combination sets for half of the beam. The proposed scheme assumes environment such as Xhaul network where obtaining channel state information is possible [6].
Notation : We use the boldface uppercase and lowercase letters for matrices and vectors, respectively. The operators (.)T and (.)H denote transpose and conjugate transpose, respectively. A − B is the Euclidean distance between A and B. A is the determinant. IN is the N ×N identity matrices. E denotes the expectation operation. CN is a complex Gaussian.

II. SYSTEM MODEL

A. System Model

We consider a single user massive MIMO system as shown

in Fig. 1, where a base station is equipped with Nt TX antennas, Nr RX antennas and 2 RF chains [7]. Fig. 1

shows the simpliﬁed hardware architecture including RF signal

processing at TX and RX. We do not include the baseband

processing part since a phase shifter by itself can produce

optimal precoder at massive MIMO environment with limited

scattering environment [1]. Since we do not consider the base-

band processing, we assume that the number of data streams,

Ns, is equal to the number of RF chains as 2. Therefore, the

transmitted signal is FRF s where FRF is the Nt × Ns RF

precoder matrix with all elements having equal norm and s

is the Ns × 1 received signal

signal vector y is given by

syat=isfy√inρgΗEFR[sFs∗s]

=

1 Ns

ΙNs

.

+ n, where

The y is

the Nr × 1 vector, Η is the Nr × Nt MIMO channel matrix

and n is Nr × 1 additive white Gaussian noise vector with

CN (0, N0ΙNr ) where the N0 is noise variance. The processed

signal y at RX base station can be written as

y = √ρP∗RF ΗFRF s + P∗RF n,

(1)

where PRF is the Nr × Ns RF combiner with unit norm elements. In this paper, we represent the speciﬁc notation of codebook-based precoder FRF as W which is the Nt × Ns quantized precoder at TX. Also codebook-based combiner PRF is assigned to notation of C which is the Nr × Ns quantized combiner at RX. Since we consider 2 RF chains, let us represent W = [w1, w2] and C = [c1, c2] where w1 and w2 are the Nt × 1 beam vectors corresponding to each 2 RF chains at TX, respectively. In a similar way, c1 and c2 are the Nr × 1 beam vectors associated with each RF chain at RX.

B. channel model and analog codebook setup

In this paper, the Saleh Valenzuela model is considered for a clustered scattering environment. The Saleh Valenzuela model is often used in mmWave channel modeling [8], [9]. Therefore, the channel Η can be represented as

Η=

Nr Nt 2

L

αift(φti)fr(φri )∗,

i

978-1-5386-4646-5/18/$31.00 ©2018 IEEE

589

ICUFN 2018

2

TABLE I PROPOSED BEAM SEARCH ALGORITHM

Pre-step : Do singular vector decomposition of the channel Η

Pre-step solution : Right channel singular vector = v Left channel singular vector = u

Fig. 1. Hardware architecture of the massive MIMO systems with RF chains

where L is the number of propagation paths, αi ∈ CN is the channel gain of the ith path and φti and φri are the azimuths
of angle of departure (AoD) and angle of arrival (AoA) of the

ith path, respectively. As we consider uniform linear arrays (ULAs) in both TX and RX antennas, f(φti) is the TX channel array response vector and f(φri ) is the RX channel array response vector. f(φti) and f(φri ) are represented as

f(φti )

=

√1 [1, ejkdsin(φti), . . . , ej(Nt−1)kdsin(φti)]T , Nt

(2)

f(φri )

=

√1 [1, ejkdsin(φri )), . . . , ej(Nr−1)kdsin(φri )]T , Nr

(3)

where

k

=

2π λ

,

λ

denotes

the

wavelength

of

the

signal

and

d is the antenna spacing. Now let A denotes the analog

codebook matrix for both TX and RX. If we use a Bt-bit

analog codebook with N antenna array, A is represented as

Step1-1

:

w∗1

=

arg min
w1

w1 − v1

Step1-2

:

c∗1

=

arg min
c1

c1 − u1

Step 1 solution : W = [w∗1, w2], C = [c∗1, c2]

Step

2

:

(w∗2, c∗2)

=

arg max log2(
w2 ,c2

INs

+

R−N 1CH HWWH HH C

)

Final solution : W∗ = [w∗1, w∗2], C∗ = [c∗1, c∗2]

singular vector as v1 and a column of left singular vector as u1 which are the largest singular values.
TABLE I represents the proposed algorithm with system parameters such as W = [w1, w2] and C = [c1, c2]. As shown in TABLE I, we select the beam vector w1 and c1 in step 1 that satisfy the minimum distance with the channel singular vectors. Since we can search w1 and c1 independently in step 1-1 and step 1-2, we can obtain the computational complexity
gains compared to the joint search. Although we exploit the
full search beam selection method in step 2, we can reduce
the number of beam combinations to search by selecting ﬁrst w∗1 and c∗1 in step 1.

A = [a(φ1), . . . , a(φ2Bt )],

where each beam vector is represented as

a(φi)

=

√1 [1, ejkdsin(φi), . . . , ejk(N−1)dsin(φi))]T , N

where

φi =

2πi 2Bt

for

i ∈ 1, . . . , 2Bt .

III. PROPOSED LOW COMPLEXITY BEAM SEARCHING
ALGORITHM
The proposed beam searching algorithm combines a full search method with closed formula for the selection of beam vectors to reduce the computational complexity. The asymptotic optimal precoder (combiner) in massive MIMO system, i.e. right (left) channel singular vector, can be implemented only with phase shifters in massive MIMO systems [1]. Therefore, it can be assumed that the optimal analog beamformer with large antenna arrays are the channel singular vector. There is a constraint on quantization of codebook. In codebook-based communication, however, beam vectors can’t be exactly the same as the channel singular vector. Thus we independently select half of the codebook-based beam vectors at TX and RX which has the minimum Euclidean distance to channel singular vector based on the closed formula given in [1]. Then, the remaining beam vectors can be searched to maximize the data rate of (1) with full search beam selection method.
In the searching process, we need the full channel state information since we right singular vector for closed formula. For convenience, we use the notation of a column of right

IV. SIMULATION RESULTS

We evaluate the proposed algorithm in terms of the achiev-

able rates and complexity compared to the full search beam

selection method. The AoA and AoD in (2) and (3) are

generated randomly with uniform distribution within [0, π].

The channel gain αi follows CN (0, 1) and the number of

propagation path L is set to be 2.The antenna arrays at both TX

and

RX

are

ULAs

with

antenna

spacing

d

=

1 λ

.

The

number

of RF chain at both TX and RX is ﬁxed as 2. The achievable

data rate is measured as SNR increases from −20 dB to 0 dB.

We use the 5-bit and 6-bit analog codebooks.

Fig. 2 shows the achievable rates according to the number

of codebook bit such as Bt = 5 and Bt = 6 for 64 × 64

massive MIMO systems. As the number of antenna increases,

we can obtain the higher data rates of the proposed algorithm

with the 6-bit codebook system compared to the full search

beam selection method with the 5-bit codebook system. We

can observe that the proposed scheme follows the achievable

rates of the full search beam selection method regardless of

the number of antenna and codebook bit in Fig. 2.

To compare complexities of the full search beam selection

method and the proposed algorithm, the number of possible

beam combination that has to be considered in the 6-bit and

5-bit codebook-based beam searching with 2 RF chains is

presented in TABLE II. We ignore the complexity of SVD of

channel matrix because especially for 6-bit codebook systems,

it accounts for only about 0.21% of beam searching time using

MATLAB. In the 6-bit codebook-based beam searching, the

590

3

12

Proposed algorithm(6bit)

Proposed algorithm(5bit)

10

Full search(6bit) full search(5bit)

grant funded by the Korea government(MSIT)(No.2016-000181,Development on the core technologies of transmission, modulation and coding with low-power and low-complexity for massive connectivity in the IoT environment)

Achievable rate (bps/Hz)

8

6

4

2

0 -20 -18 -16 -14 -12 -10 -8 -6 -4 -2 0
SNR (dB)

Fig. 2. Achievable rate of the proposed algorithm according to the number of codebook bit for 64×64 massive MIMO systems

TABLE II COMPLEXITY OF THE PROPOSED ALGORITHM AND THE FULL SEARCH
BEAM SELECTION METHOD

The number of possible beam combination

Codebook bit Full search beam selection method
Proposed algorithm

5-bit 1.0 × 106 1.0 × 103

6-bit 1.6 × 107 4.2 × 103

proposed algorithm shows the 4.2×103 complexity, which can reduce the complexity of full search beam selection as much as 0.026%. In terms of the achievable rates, 6-bit codebookbased proposed scheme for 64 × 64 massive MIMO systems shows the higher data rates than the 5-bit codebook-based full search beam selection method with much lower complexity.

REFERENCES
[1] O. El Ayach, R. W. Heath, Jr., S. Abu-Surra, S. Rajagopal, and Z. Pi, “The capacity optimality of beam steering in large millimeter wave MIMO systems,” in Proc. 2012 IEEE International Workshop Signal Process. Advances Wireless Commun., pp. 100–104.
[2] X. Zheng, Y. Xie, J. Li, and P. Stoica, “MIMO transmit beamforming under uniform elemental power constraint,” IEEE Trans. Signal Processing, vol. 55, no. 11, pp. 5395–5406, Nov. 2007.
[3] X. Zhang, A. Molisch, and S.-Y. Kung, “Variable-phase-shiftbased RFbaseband codesign for MIMO antenna selection,” IEEE Transactions on Signal Processing, vol. 53, no. 11, pp. 4091–4103, Nov. 2005.
[4] X. Gao, L. Dai, C. Yuen, and Z. Wang, “Turbo-Like beam-forming Based on Tabu Search Algorithm for Millimeter-Wave Massive MIMO Systems,” IEEE Trans. Veh. Technol., vol. 65, no. 7, pp. 5731-5737, Jul. 2016.
[5] M. S. Rahman and K. Josiam, “Low complexity RF beam search algorithms for millimeter-wave systems,” in Proc. IEEE GLOBECOM, Dec. 2014, pp. 3815–3820.
[6] A. D. L. Oliva, X. C. Perez, A. Azcorra, A. D. Giglio, F. Cavaliere, D. Tiegelbekkers, J. Lessmann, T. Haustein, A. Mourad, and P. Iovanna, ”Xhaul: toward an integrated fronthaul/backhaul architecture in 5G networks,” IEEE Wireless Commun., vol. 22, no. 5, pp. 32-40, Oct. 2015.
[7] P. Xia, S.-K. Yong, J. Oh, and C. Ngo, “Multi-stage iterative antenna training for millimeter wave communications,” in Proc. Global Telecommun. Conf. ( GLOBECOM), New Orleans, LA, USA, 2008, pp. 1–6.
[8] O. E. Ayach, S. Rajagopal, S. Abu-Surra, Z. Pi, and R. W. Heath, Jr, “Spatially sparse precoding in millimeter wave MIMO systems,” IEEE Trans. Wireless Commun., vol. 13, no. 3, pp. 1499–1513, Mar. 2013.
[9] IEEE 802.15 WPAN Millimeter Wave Alternative PHY Task Group 3c. [Online]. Available: www.ieee802.org/15/pub/TG3c.html, Sept., 2011.

V. CONCLUSION
In this paper, we proposed a low complexity codebookbased beam searching algorithm for massive MIMO systems with limited scattering channels. The proposed algorithm can reduce the beam searching complexity by combining the closed formula with full search beam selection method. In the simulation result, the 6-bit codebook-based proposed algorithm shows the higher achievable rates than the 5-bit codebook-based full search beam selection algorithm with much lower complexity for 64 × 64 massive MIMO systems. If the antenna array size increases, the achievable complexity gains increase. Therefore, in massive MIMO systems, the proposed algorithm can lead to a better performance in the achievable rates with much lower complexity compared to the full search beam selection method. Our future work will be focused on extending to more general architectures.

ACKNOWLEDGMENT
This work was partly supported by Institute for Information & communications Technology Promotion(IITP) grant funded by the Korea government(MSIT) (No.2014-000282,Development of 5G Mobile Communication Technologies for Hyper-connected smart services) and Institute for Information & communications Technology Promotion(IITP)

591

