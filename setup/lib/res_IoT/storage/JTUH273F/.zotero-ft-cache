THE JOURNAL OF NAVIGATION (2003), 56, 257–275. f The Royal Institute of Navigation DOI: 10.1017/S0373463303002212 Printed in the United Kingdom
An Extended Kalman Filter Algorithm for Integrating GPS and Low Cost Dead Reckoning System Data for Vehicle Performance and
Emissions Monitoring
L. Zhao, W. Y. Ochieng, M. A. Quddus and R. B. Noland
(Imperial College of Science, Technology and Medicine)
This paper describes the features of an extended Kalman ﬁlter algorithm designed to support the navigational function of a real-time vehicle performance and emissions monitoring system currently under development. The Kalman ﬁlter is used to process global positioning system (GPS) data enhanced with dead reckoning (DR) in an integrated mode, to provide continuous positioning in built-up areas. The dynamic model and ﬁlter algorithms are discussed in detail, followed by the ﬁndings based on computer simulations and a limited ﬁeld trial carried out in the Greater London area. The results demonstrate that use of the extended Kalman ﬁlter algorithm enables the integrated system employing GPS and low cost DR devices to meet the required navigation performance of the device under development.
1. I N T R O D U C T I O N. Problems posed by the environmental impact of transport are serious, growing and constitute a major challenge to policy makers at all levels (DETR, 1999). The current array of technological, institutional and planning tools available to deal with these problems are inadequate and need urgently to be upgraded. A key feature of the problems is that they arise from the interaction of human behavioural systems and physical systems. Thus, to improve the understanding of environmental and health problems associated with vehicle emissions it is necessary to combine data on both travel and traﬃc behaviour with environmental data. There are currently no such databases available. A research and development project is currently underway which aims to contribute to the realisation of these data requirements by developing and applying state-of-the art environmental monitoring, positioning, communications, data mining and warehousing technologies to create and demonstrate the capabilities of an accurate, reliable and cost eﬀective real time data collection device, the vehicle performance and emissions monitoring system (VPEMS). The VPEMS will be ﬁtted on vehicles to monitor vehicle and driver performance and, the level of emissions and concentrations.
The navigation function of the VPEMS is responsible for the derivation of all spatial, temporal and spatial-temporal data about the vehicle including location in

258

L. Z H A O A N D O T H E R S

V O L. 56

3-D space, time, slope, speed and acceleration. The level of positioning accuracy for VPEMS has been speciﬁed at 50m (95 %) and 100m (99.9 %). The availability of the positioning system has been speciﬁed at 99%, corresponding to an outage of 14 minutes in 24 hours (Sheridan and Ochieng, 2000). To achieve this level of performance in built-up areas, where the impact of pollution from traﬃc is most serious, the navigation function cannot be supported by the global positioning system (GPS) alone. A solution under consideration is the integrated use of data from GPS with dead reckoning (DR) and map matching.
1.1. The Global Positioning System. The Global Positioning System (GPS) provides 24-hour, all-weather 3-D positioning and timing all over the world, with a predicted horizontal accuracy of 22m (95 %) (US DoD, 2001). However, because the system suﬀers from signal masking and multipath errors in areas such as urban canyons, densely treed streets, and tunnels, navigation with GPS requires a level of augmentation to achieve the required navigation performance (RNP). A recent study to characterise the performance of GPS in a typical urban area showed that the required accuracy was available 90 % of the time, based on a 4-hour trip in the Greater London area (Ochieng, 2002). The implication of the outage involved here (i.e. 10%) is a potential loss of navigation capability during a crucial period.
1.2. Dead Reckoning. Dead Reckoning (DR) is a positioning technique based on the integration of an estimated or measured displacement vector. It is not subject to signal masking or outages. However, its positioning errors accumulate with time, so that external calibration or augmentation with other positioning devices is usually required. Generally, DR is derived from two or more sensors that measure the heading and displacement of a vehicle. Usually gyroscopes are used to measure headingrate (i.e. rate of change of heading) and the odometer is used to measure displacement (and speed). A variety of gyroscopes have emerged in recent years (mechanical, optical, electrostatic and the relatively new micro-electro-mechanical system) with diﬀerences in accuracy, stability and cost. The gyroscope is a core element used to measure the rate of rotation in inertial navigation. A wheel rotation sensor is used in the odometer. The wheel revolutions from the sensor are then transformed into the distance travelled. Given the corresponding timing information, the speed or velocity of the vehicle can also be determined. In this case, the speed sensor is achieved at no additional cost.
For vehicle location and navigation applications, sensors must be chosen that add only minor costs to the production or modiﬁcation of a vehicle while delivering continuous position availability. In the VPEMS project, a standard built-in odometer and a low-cost gyroscope have been selected. The gyroscope is a piezo-electric vibrating type based on micro-electro-mechanical system (MEMS) technology. The odometer outputs the distance the vehicle has travelled as a pulse converted to distance by a scale factor, while the gyroscope produces the heading rate of the vehicle, in mv/rad/s (microvolts per radian per second).
The integrated GPS/DR system adopted is based on the concept of loose coupling (described below) and uses an extended Kalman ﬁlter. The system can calibrate for odometer and gyroscope errors in real-time when GPS works well and uses the calibration data to produce a better position ﬁx by DR when GPS suffers signal masking. This type of integration is potentially suitable to the builtup urban environments where GPS signal attenuation and masking are potential problems.

N O. 2

AN EXTENDED KALMAN FILTER ALGORITHM

259

2. G P S/D R I N T E G R A T I O N I S S U E S. A crucial element needed for the establishment of an integrated (GPS/DR) navigation system model and a Kalman ﬁlter structure is an understanding of the navigation errors involved. With the removal of the eﬀects of selective availability (SA) in May 2000, GPS positioning accuracy has improved from 100m (95 %) to 22m (95 %). The remaining errors are mainly due to orbital instability, atmospheric propagation, multipath and receiver noise. For the integration process, the modelling of the errors depends on whether the loose coupling concept (in this case comparing the position solution from GPS with that obtained by DR) or the tight coupling approach (involving integrating the raw measurements from each system into a single solution with appropriate weighting of the various measurements) is adopted. With the loose coupling approach the errors in the derived position, velocity and heading can be modelled as white noise with desired characteristics (note that the accuracy of velocity and heading degrade signiﬁcantly at low speed). For tight coupling, errors in the pseudorange and pseudo-range rate should be considered.
With DR the factors that aﬀect the odometer output accuracy include the scale factor error, status of the road and pulse truncation. The scale factor error, which is the diﬀerence between the true scale coeﬃcient and the calibrated one, is the most signiﬁcant as it aﬀects the distance measurement as long as the vehicle is moving. It is caused by calibration error, tyre wear and tear, tyre pressure variation and vehicle speed. Although the scale factor will vary during a period of travel, the change should not be signiﬁcant over a short time. Hence, a reasonable model for this could be either a random constant or a ﬁrst order Gauss-Markov process with a long auto-correlation time (Gelb, 1979). The latter was adopted in the study presented here as it captures the real conditions slightly better.
Errors associated with the low cost piezo-electric vibrating rate gyroscope can be caused by gyro bias drift, gyro scale factor error, installation misalignment, and other factors, such as temperature, vibration and electro-mechanical properties of the operational environment. Of these the most signiﬁcant are the bias drift and scale factor error. The bias drift can be explained by the existence of an output (rate of change of heading) with no corresponding input (e.g. a causal factor such as vehicle turning). The drift depends on the type of gyroscope (i.e. the manufacturing process and quality) and can be as much as 10 degrees/second. It is usually an unknown random constant and will aﬀect the measurements cumulatively irrespective of whether the vehicle is moving or not. It is reasonable to model the bias drift as a ﬁrst-order Gauss-Markov process, because the unknown bias will change with temperature and vibration. Calibration errors and electro-mechanical properties of the operational environment cause the scale factor error. Unlike the bias drift, the scale factor error aﬀects the measurements only when the vehicle makes a turn. Although the scale factor error will vary with time, the change should not be signiﬁcant over a short period of time. Hence, the scale factor error has been modelled as a random constant disturbed by white noise with a low covariance.

3. E X T E N D E D K A L M A N F I L T E R. Kalman ﬁltering is widely used in various system state estimations and predictions. It is a kind of linear minimum mean-square error (MMSE) ﬁltering process using state-space methods. The two main features of Kalman formulation and problem solution are vector modelling

260

L. Z H A O A N D O T H E R S

V O L. 56

of the dynamic process under consideration, and recursive processing of the noisy

measurement data. In some applications of Kalman ﬁltering, due to the non-linearity of the dynamic and/or measurement equations, the corresponding models have to be linearised. One of the linearisation methods, known as Extended Kalman Filter-

ing (EKF), is to linearise about a trajectory that is continually updated with the

state estimates that result from the measurements. 3.1. State Equation. The dynamic model is based on the knowledge of how the

vehicle is expected to move. In order to establish the integrated navigation system,

either the vehicle dynamic model or the navigation state error model, must be speciﬁed. Usually, the error model is used only in the case where there is dominant navigation equipment, such as an inertial navigation system (INS), whose state errors

need to be estimated and calibrated by a feedback mechanism. For satellite-based

vehicle navigation applications, although GPS can be thought of as the dominant equipment, two scenarios always emerge. On the one hand, GPS positioning accuracy

is good enough so that there is no requirement for calibration and ; on the other,

there is a loss of navigation capability due to signal masking making calibration

meaningless. In this case, choosing a vehicle dynamic model is more appropriate.

Hence the vehicle dynamic model was established as state equations. The following

states were selected :

x=[ e n vv Hv a v dS dK eG ]T

(1)

Where :

e=terrestrial easting position, in metres

n=terrestrial northing position, in metres

vv=forward velocity of the vehicle, in m/s, with forward being positive Hv=heading of the vehicle, in radians, with north being zero and clockwise

being positive

a=acceleration of the vehicle, in m/s2

v=heading rate, in rad/s

dS=odometer scale factor error, in m/pulse

dK=rate gyro scale factor error, in mv/rad/s

eG=bias drift of the rate gyro, in rad/s

The dynamic equations can be written as:

e_=vv Á sin Hv+w1 n_=vv Á cos Hv+w2 v_v=a+w3 H_ v=v+w4

9 >>>>>>>>>>>>=

a_=w5 v_ =xbvv+w6 dS_=w7 dK_ =w8 e_ G=xbgeG+w9

>>>>>>>>>>>>;

(2)

Or written as vector form :

x_=f (x(t), t)+w

(3)

Where w=[ w1 w2 w3 w4 w5 w6 w7 w8 w9 ]T is the dynamic noise. bw, bg are the skew correlation times (i.e. inverse of correlation times). It can be seen that this is a non-linear set of equations because there are two items that are non-linear.

N O. 2

AN EXTENDED KALMAN FILTER ALGORITHM

261

3.2. Measurement Equations. The information on position (QGPS, lGPS), velocity vGPS and heading HGPS of the vehicles can be derived from the GPS receiver. The pulses DNodo during a time interval Dt, representing the displacement travelled, and direct current (DC) voltage output VRG, representing the heading-rate of the vehicle respectively, can be acquired from the odometer and rate gyroscope. So the obser-

vation variables are chosen as follows :

z=[ lGPS QGPS vGPS HGPS DNodo VRG ]T

(4)

And the measurement equations are deﬁned as:

lGPS=e=R Á cos QGPS+v2 QGPS=n=R+v1 vGPS=vv+v3

9 >>>>>>>>=

HGPS=Hv+v4 S Á DNodo=1=2 Á a Á Dt2+vv Á VRG=(K+dK )(v+eG)+v6

DtxdS

Á

DNodo+v5

>>>>>>>>;

(5)

Where S and K are the nominal scale factor for the odometer and gyroscope re-

spectively ; Dt the interval time ; R the radius of the earth. These equations can be

rewritten in matrix form as :

z=h(x(t), t)+v

(6)

Where v=[ v1 v2 v3 v4 v5 v6 ]T is the observation noise. It can be seen that the

measurement equations are also non-linear because of the last measurement equation.

3.3. Kalman Filter Design. The Kalman ﬁlter can be used to produce optimal

estimates of the state vectors listed above with well-deﬁned statistical properties. For

convenience of computer calculation, discrete recursive algorithms are usually

adopted. So the ﬁrst thing to do is to make the continuous dynamic equations dis-

crete. In addition, due to the non-linear properties of both the system dynamic

equations and measurement equations, linearisation is also required. The state tran-

sition and observation matrices are derived as follows (Gelb, 1979) :

x(k)=W(k, kx1)x(kx1)+w(kx1) 

z(k)=h(x(k), k)+v(k)

(7)

Where :

W(k,

kx1)=I+@f(x(t), @x(t)

t)x(t)=x(k)

Á

Dt

w(t)=0

2 1 0 sin Hv Á Dt vv Á cos Hv Á Dt 0

0

00

=6666666666666664

0 0 0 0 0 0 0

1 0 0 0 0 0 0

cos Hv Á Dt 1 0 0 0 0 0

xvv Á sin Hv Á Dt 0 1 0 0 0 0

0 Dt 0 1 0 0 0

0 0 Dt 0 1xbv Á Dt 0 0

0 0 0 0 0 1 0

0 0 0 0 0 0 1

03

0 0 0 0 0 0 0

7777777777777775

00

0

0

0

0

0 0 1xbg Á Dt

262

H(k)=@

h(x(t), @x(t)

t)x(t)=x(k)

v(t)=0

2 1=R cos (QGPS) 0

=666666664

0 0 0 0

1=R 0 0 0

0

0

L. Z H A O A N D O T H E R S

00 0

0

00 0

0

10 0

0

01 0

0

Dt 0 Dt2=2 0 0 0 0 K+dK

0 0 0 0 xNodo 0

0 0 0 0 0 v+eG

V O L. 56

03

0 0 0 0

777777775

K+dK

cov(wk, wTj )=Qkdkj ; cov(vk, vTj )=Rkdkj ; dkj is the Kronecker-d function; Dt is the sampling time interval ;
k, j are the discrete points in time ;

Because of the non-linearity of system and measurement equations, the EKF is

adopted to estimate the optimal result of system states :

xk=kx1=Wk=kx1xkx1 zk=kx1=h(xk=kx1, k) Pk=kx1=Wk=kx1Pkx1WTk=kx1+Qkx1

9 >>>>>>>>>=

Kk=Pk=kx1HTk (HkPk=kx1HTk +Rk Pk=(IxKkHk)Pk=kx1 xk=xk=kx1+Kk(zkxzk=kx1)

)x1

>>>>>>>>>;

(8)

4. S I M U L A T I O N R E S U L T S. 4.1. Test route design and simulation parameters. A comprehensive simulation
test was carried out to verify the correct formulation of the algorithm for the integration of GPS and DR data. The simulated route was designed to have a good mix of vehicle manoeuvre and signal masks in order to ensure the movement of the vehicle was as realistic as possible. The route consists of four typical parts including vehicle acceleration, a turn, signal mask and forward motion, with the following characteristics :
’ Accelerating from time t1=1000s with acceleration of 1m/s2, lasting 20s ; ’ Taking a turn from time t2=1500s at a rate of 10deg/s, lasting 10s ; ’ Suﬀering GPS signal mask from time t3=2000s for 100s ; ’ Typically moving forward at all other times ;
It was assumed throughout the simulation that road conditions, driver’s operation and vehicle characteristics dynamically disturbed the vehicle’s movement. The dynamic disturbance characteristics of position, velocity and heading were simulated by normally distributed zero-mean white noises with variance of (0.5m)2, (0.01m/s)2

N O. 2

AN EXTENDED KALMAN FILTER ALGORITHM

263

Figure 1. Vehicle Trajectory.
and (0.001rad )2, respectively. The acceleration was assumed to have a noise with variance of (0.0001m/s2)2, while the noise variances of rate of turning and gyroscopic drift were set to be (0.001rad/s)2 and (0.0001rad/s)2. Given that the scale factor usually doesn’t change along a speciﬁed route during a short period of time the scale factor error of the odometer was assumed to be constant with a bias of 1% of full scale.
For the system measurements the observation errors of GPS, odometer and rate gyroscope were set according to their standard statistical values. The outputs of the GPS receiver were assumed to be uncorrelated-noise-polluted stochastic processes with covariances of (16 m)2, (0.5 m/s)2 and (0.001 rad )2 for position, velocity and heading respectively. The output of the odometer was assumed to have an error with a standard deviation of 0.2 pulses. Considering the loss of precision during signal processing in hardware, the output of the gyroscope was assumed to have an error with a standard deviation of 0.01 rad/s.
Figure 1 shows the true simulated vehicle trajectory and the uncalibrated DR result, whose position error exhibits the expected cumulative characteristics. During the 50-minute simulation period, the maximum error of the DR position reached 15 km (Note that due to the small-scale of Figure 1, the dynamic disturbances in vehicle position cannot be easily distinguished). Figure 2 shows the temporal error variation in the position of the vehicle as determined with GPS and the uncalibrated DR, in which the impact of acceleration, vehicle turning and satellite signal masking can be seen. It was assumed that during a GPS outage (the period 2000 to 2100 seconds), the GPS receiver continued to give the last reliable position ﬁx until a new position ﬁx was obtained (this had been observed with a number of telematic receivers in the ﬁeld). The consequence of this is a build-up of a potentially signiﬁcant GPS positioning error of the order of 2 km within a 100s outage duration for the particular road layout. The DR error is not aﬀected by this situation.
The DR and GPS velocity errors are given in Figure 3. It can be seen that due to the odometer scale factor error, the magnitude of the velocity error changes with the true speed (i.e. the higher the speed, the larger the error). The heading errors from GPS and the gyroscope are shown in Figure 4. It should be noted that since vibration and temperature aﬀect the gyroscope bias drift, the resulting heading error may

264

L. Z H A O A N D O T H E R S

V O L. 56

Figure 2. Position Errors.

Figure 3. Velocity Error.

ﬂuctuate with time (i.e. not necessarily always increase). In the simulation, because

the minimum vehicle speed was set to 5 m/s, the expected corresponding maximum

GPS heading error should be less than 5 degrees. The process of making a turn was

simulated assuming a constant rate and according to the expression given below :

Zt

De= vv sin (Hv+vt)dt

Z0 t

Dn= vv cos (Hv+vt)dt

(9)

0

4.2. EKF Simulation Results. This section presents the results of the analysis carried out on the output of the EKF using simulated data in order to study the internal consistency and correct formulation of the algorithm before its use with real ﬁeld data. The performance of the EKF algorithm has been assessed by comparing the recovered parameters to the corresponding input values.

N O. 2

AN EXTENDED KALMAN FILTER ALGORITHM

265

Figure 4. Heading Error.

Figure 5. Easting Error.
Figure 5 shows the easting error curves for the integrated (GPS/DR) system and GPS. The impact of vehicle acceleration (t=1000–1020s) and turning (t=1500– 1510s) can be seen clearly in the form of worsening system errors. A similar observation is made with respect to the northing component. However, in general the output of the EKF algorithm is very close to the GPS accuracy, is smoother and increases the availability of positioning accuracy compared to either of the systems used in stand-alone mode. This should be compared to the corresponding easting and northing errors for the uncalibrated DR data, which build up to 10 and 12 km over the 50-minute simulation period.
The velocity error curves for GPS and the integrated (GPS/DR) system are shown in Figure 6. It can be seen that as expected the EKF algorithm recovered the velocity of the vehicle close to that based solely on GPS, but is much smoother. The impact of acceleration on the recovery of velocity can be clearly seen at around epoch 1000s when the vehicle begins to accelerate. This is due to the inability of the model to take

266

L. Z H A O A N D O T H E R S

V O L. 56

Figure 6. Velocity Error.

Figure 7. Heading-Time Curve.
account of non-uniform motion. The velocity of the vehicle from the DR component is smoother than that from GPS, but the scale factor of the odometer creates a jump resulting in a near constant oﬀset.
The heading error curves for the integrated (GPS/DR) and DR sensors are shown in Figure 7. The GPS heading error is considerably lower when available. This is because of the assumption that the vehicle moves at a relatively high speed. It can be seen also that the heading derived from the rate gyroscope ﬂuctuates with time because of operational environment characteristics. The gyro drift can sometimes result in an error of more than 30 degrees over the 50-minute simulation period. For the integrated system, it can be seen that heading error is much smaller compared to the gyroscope heading. However, due to the diﬃculty of modelling correctly all types of manoeuvres, the recovered accuracy sometimes deteriorates signiﬁcantly during certain activities. Both acceleration and turning can lead to signiﬁcant errors in the recovered heading. However, it should be noted that the simulation parameters

N O. 2

AN EXTENDED KALMAN FILTER ALGORITHM

267

Figure 8. Scale Factor Error of Odometer.

Figure 9. Comparison of GPS, DR and Filter Positioning.
selected here to a large extent represent the worst case scenario in terms of vehicle manoeuvres and that in reality such cases occur infrequently.
Figure 8 shows the diﬀerence between the true and the recovered odometer scale factor, which is of the order of 10x3 (note that when the vehicle manoeuvres, the error becomes slightly worse). The gyro scale factor was also recovered with the same level of accuracy. This shows that the input errors applied to the true scale factor values have been recovered accurately by the EKF algorithm.
The simulation exercise has on the whole veriﬁed that the EKF formulation is valid (with the exception of rare occurrences). The algorithm was then used to process real ﬁeld data captured during an experimental investigation in the Greater London area.
5. F I E L D D A T A R E S U L T S. A comprehensive ﬁeld test was carried out in the Greater London area in January 2002 to make a credible and realistic assessment and characterisation of the integrated system performance. A test vehicle was equipped with a navigation platform consisting of a 12-channel single frequency

268

L. Z H A O A N D O T H E R S

V O L. 56

Figure 10. Easting-time Curve (1).

Figure 11. Easting-time Curve (2).
GPS receiver, a low-cost MEMS rate gyroscope and the interfaces required to connect to the vehicle speed sensor (odometer) and back-up indicator. The route in London was chosen carefully to have a good mix of important spatial urban characteristics including open spaces, urban canyons, tall buildings, tunnels, bridges and potential sources of electromagnetic interference. Temporal consideration included capturing data to sample the temporal variation in the geometry of the GPS satellite constellation.
Figure 9 shows positioning results from GPS, DR and the integrated (GPS/DR) system. The easting components from DR and GPS are given in Figures 10 and 11. The corresponding results for the northing component are given in Figures 12 and 13. It can be seen that the DR positioning is continuous with an error that accumulates over time. GPS positioning has discontinuity when suﬀering signal masking during the periods 2855s to 2941s and 3383s to 3437s. The results show that the integrated system based on the extended Kalman ﬁlter exploits the strong points of both GPS (high precision and long term stability) and DR (short term stability and continuity) to provide the required availability of positioning accuracy.

N O. 2

AN EXTENDED KALMAN FILTER ALGORITHM

269

Figure 12. Northing-time Curve (1).

Figure 13. Northing-time Curve.
The velocity curves shown in Figure 14 show that the output of the EKF algorithm, as expected, is very close to GPS derived velocities when available (see the horizontal dilution of precision (HDOP) values on the same ﬁgure). DR derived velocity exhibits similar accuracy as the GPS derived velocity. There is only a slight diﬀerence due to the scale factor error. When GPS suﬀers a signal mask or loss of lock, the odometer-derived velocity is used in the integrated system.
The heading-time curve for the integrated system is compared with that of GPS and DR in Figures 15 and 16 respectively. It is interesting to note that when the geometric conﬁguration indicator, HDOP, is greater than 100, the heading from GPS is unchanged, which can be seen in Figure 15. At other times, the GPS derived heading changes rapidly and within the system error range. As can be seen in Figure 16, DR derived velocity keeps the basic shape of the heading, but its error accumulates rapidly with time due to the gyroscope drift. If uncalibrated, the error can reach as much as 50 degrees in about 1000s. Compared to both GPS and DR

270

L. Z H A O A N D O T H E R S

V O L. 56

Figure 14. Velocity-Time Curve.

Figure 15. Heading-Time Curve.
derived heading, the heading derived from the integrated system has a higher precision. When GPS is available, the integrated system smoothes the eﬀects of the GPS random noise and calibrates the drift and scale factor of the rate gyroscope. When GPS is not available, the integrated system uses the heading from the gyroscope together with the calibration data based on GPS for higher accuracy.
In order to study the level of coverage (ability to obtain a position ﬁx) and accuracy (position ﬁxing with a desired level of accuracy) oﬀered by GPS and the integrated system, the position ﬁxing data was overlaid onto a digital London road network base map shown in Figure 17. The statistics generated showed that GPS coverage was available over 90 % of the mission duration, while that of the integrated system was 100 %. The longest period of GPS outage was 100s. The accuracy assessment was carried out by comparing both GPS positions and the EKF algorithm results with the digital map at a scale of 1 :1250 (equivalent to a minimum plottable error of 1.25m). Furthermore, the analysis was carried out in deﬁned accuracy bands of

N O. 2

AN EXTENDED KALMAN FILTER ALGORITHM

271

Figure 16. Heading-time Curve.

Figure 17. Vehicle test trajectory.
5m, 10m, 20m, 30m, 40m and 50m with respect to the centreline of the road. From Figure 18, it can be seen that GPS and the integrated system have similar actual ﬁx density, where more than 55% are in 5m of accuracy and almost 100% are within 50m. Note however, that GPS has 90% coverage while the integrated system had 100 % coverage. On the basis of this, it is clear that the integrated (GPS/DR) system employing low cost DR devices performs better than GPS alone in providing continuous positioning with an accuracy of better than 50m.

272

L. Z H A O A N D O T H E R S

V O L. 56

Figure 18. Position ﬁx accuracy density.

Figure 19. Central London – Holborn area.
Some typical parts of the test route were examined in greater detail. Figure 19 shows the situation when travelling in the Holborn area of Central London that is heavily built-up with very narrow roads. Figure 20 shows results from the North Circular Road in the outskirts of London that is predominantly open and clear. In general, the position accuracy in the open areas is better than in the built-up areas. However, in some special cases even in the outer city areas signal masking can

N O. 2

AN EXTENDED KALMAN FILTER ALGORITHM

273

Figure 20. Outer London – North Circular’s Cambridge junction.
sometimes occur (as can be seen midway in Figure 20 when travelling through the Great Cambridge Junction, where the integrated system operates without the full support of GPS). Figure 21 shows the position accuracy achieved during a total GPS outage as the vehicle was travelling through the Blackwall tunnel for a period of 63s. The corresponding statistics are given in Figure 22. It can be seen that 49 % of the ﬁxes were within 10m of the centreline of the road and 100 % of the ﬁxes were within 30m. This is a measure of the performance of the DR unit working on its own but using calibration factors derived when GPS position ﬁxing capability was available.
6. C O N C L U S I O N S. An extended Kalman ﬁlter algorithm for the integration of data from GPS and a low cost DR system employing micro-electro-mechanical system (MEMS) piezo-electric vibrating gyroscope and vehicle odometer, has been developed and presented in this paper. The various elements of the algorithm including the dynamic model, measurement equations and the formulation of the EKF have also been described. The algorithm was tested both by computer simulation and real ﬁeld data. Simulation results have shown that the DR sensors can provide improved heading and velocity information when calibrated by the Kalman ﬁlter results based on available GPS data. This enables continuous positioning information to be achieved even in built-up areas. When suﬀering a GPS signal mask the system can navigate on calibrated DR data over a relatively short period of time. The simulation results have shown that the extended Kalman ﬁlter (EKF) algorithm is eﬀective most of the time (with the exception of the rare events such as when making sharp turns). Field trial results have shown that the EKF algorithm developed for the integration of GPS and DR data is very eﬀective with continuous

274

L. Z H A O A N D O T H E R S

V O L. 56

Figure 21. Travelling inside the Blackwall Tunnel.
Figure 22. Accuracy ﬁx density in tunnel.
position accuracy of better than 50m. The GPS-only results achieved the same level of accuracy but for only 90% of the time. The beneﬁt of the integration is seen in the performance in built-up areas best demonstrated by the traverse through an 820m-long tunnel where all the position ﬁxes were within 30m of the road centreline.

N O. 2

AN EXTENDED KALMAN FILTER ALGORITHM

275

Based on the scenario investigated here it is clear that low cost DR sensor technology is capable of providing the level of positioning accuracy and coverage required for many transport telematic applications.

REFERENCES
Bevly, D. M. (1999). Evaluation of a Blended Dead Reckoning and Carrier Phase Diﬀerential GPS System for Control of an Oﬀ-Road Vehicle. ION GPS-1999, Nashville, USA.
DETR. (1999). Transport Statistics Great Britain. DETR, HMSO, London. Gelb, A. (1979). Applied Optimal Estimation. The MIT Press. Kealy, A. N., Tsakiri, M., and Stewart, M. 1999. Land Vehicle Navigation in the Urban Canyon – A Kalman
Filter Solution using Integrated GPS, GLONASS and Dead Reckoning. ION GPS-1999, Nashville, USA. Krakiwsky, E. J., Harris, C. B. and Wong, R. V. C. 1988. A Kalman ﬁlter for integrating dead reckoning,
map matching and GPS positioning. Proceedings of IEEE Position, Location and Navigation Symposium, 39– 46. Ochieng, W. Y., Noland, R. B., Polak, J. W., Zhao, L., Briggs, D., Gulliver, J., Crookell, A., Evans, R., Walker, R. and Randolph, W. (2002). Integration of GPS and Dead Reckoning for Real Time Vehicle Performance and Emissions Monitoring. Accepted for Publication in the GPS Solutions Journal. Sheridan, K and Ochieng, W. Y. (2001). VPEMS Performance Targets. Working paper, Imperial College London. Stephen, J. (2000). Operation of an Integrated Vehicle Navigation System in a Simulated Urban Canyon. ION GPS 2000, Salt Lake City, USA. Stephen, J. (2000). Development of A Multi-Sensor GNSS Based Vehicle Navigation System. UCGE Reports Number 20140, University of Calgary, Canada. US DoD. (2001). Global Positioning System Standard Positioning Service Performance Standard. Wood, C. and Mace, O. (2001). Vehicle positioning in Urban Environments. GPS World Online, July.

