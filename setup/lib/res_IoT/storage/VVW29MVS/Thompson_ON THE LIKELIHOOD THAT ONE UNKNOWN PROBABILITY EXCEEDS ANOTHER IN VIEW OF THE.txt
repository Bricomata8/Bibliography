Downloaded from http://biomet.oxfordjournals.org/ at Georgetown University on May 24, 2015

ON THE LIKELIHOOD THAT ONE UNKNOWN PROBABILITY EXCEEDS ANOTHER IN VIEW
OF THE EVIDENCE OF TWO SAMPLES.
BY WILLIAM R. THOMPSON. From the Department of Pathology, Yale University.
Section 1.
IN elaborating the relations of the present communication interest was not centred upon the interpretation of particular data, but grew out of a general interest in problems of research planning. From this point of view there can be no objection to the use of data, however meagre, as a guide .to action required before more can be collected; although serious objection can otherwise be raised to argument based upon a small number of observations. Indeed, the fact that such objection can never be eliminated entirely—no matter how great the number of observations— suggested the possible value of seeking other modes of operation than that of taking a large number of observations before analysis or any attempt to direct our course. This problem is more general than that treated in Section 2, and is directly concerned with any case where probability criteria may be established by means of which we judge whether one mode of operation is better than another in some given sense or not.
Thus, if, in this sense, P is the probability estimate that one treatment of a certain class of individuals is better than a second, as judged by data at present available, then we might take some monotone increasing function of P, say / ( P ) , to fix the fraction of such individuals to be treated in the first manner, until more evidence may be utilised, where 0 < /(P) < 1; the remaining fraction of such individuals (1 —fin) to be treated in the second manner; or we may establish a probability of treatment by the two methods of f{P) and 1 —f(p), respectively. If such a discipline were adopted, even though it were not the best possible, it seems apparent that a considerable saving of individuals otherwise sacrificed to the inferior treatment might be effected. This would be important in cases where either the rate of accumulation of data is slow or the individuals treated are valuable, or both.
If we arbitrarily decide to eliminate the second treatment in favour of the first lit this time, then the expectation of sacrifice to the inferior treatment would be (1 — P) for all subsequently treated individuals; whereas, if, for example, we take f(P) = P, the expectation of such sacrifice would be temporarily
P(1-P) + (1-P)P*= 2PQ,

Downloaded from http://biomet.oxfordjournals.org/ at Georgetown University on May 24, 2015

286 Likelihood that One Unknown Probability exceeds Another
where Q = 1 - P. Obviously, 2PQ ^ } and, if P =£ \, then 2PQ < £; whence a saving is made in contrast to the so-called alternate case method. In the long run, if a real preference exists between the two treatments, the expected saving by continued application of this method of apportionment rather than by making immediate final decision is sensibly 1 — P of individuals subsequently treated.
Obviously, if we are to operate in this manner, we need methods of evaluation of P for small as well as large numbers of observations. In the latter case many approximate methods are available in all fields although bounds to approximation have not been considered generally.
In Section 2 a sampling problem is treated, which is equivalent to a special case, where we are to judge between two rival treatments upon the basis of the probability of occurrence of a given critical event following such treatment. These probabilities are assumed unknown, but denoted by j3i and p,; and it is assumed that, independently for each of these, a priori £S< is equally likely to lie in either of any two equal intervals in its possible range, (0, 1). Our available experience consists solely of the data:
Of r?i individuals treated by the first method, rx experienced the critical event and «i did not; and of n, treated by the second, rt and s, were the corresponding numbers with respect to the critical event.
In any given case it must be decided whether these requirements are met or not, and whether we may apply the well-known Principle of Bayea to convert the problem to the form of Section 2. Statistical criteria are often employed, however, in situations in which certain deviations from the conditions required in their development can be tolerated, when a better procedure is not available.
Section 2.
Consider the case of two infinite populations for which the unknown probabilities of occurrence of a given critical event are p\ and p\, and the probability of obtaining a sample containing r critical occurrences and s failures in w=r + s trials is f ) .pir(l —piY, where t = 1, 2, respectively. Furthermore, assume that one sample
has been drawn at random from each population, the respective values of r and s being denoted by r\ and S{ (where i = 1, 2) and nj = r< + «<; and that independently for i — 1 or 2 the probability that p, lies in the interval (p,p + dp) is P^p+dp, where

(1 \

pM _ p

K'

x P.P+dv ~

(1 / 7 , \

J. ©•'•••••

where q = 1 —p, r = rt, s^sit and n = r + s. Then

WILLIAM R THOMPSON

287

the last expression having been indicated by K. Pearson* in this relation. In the notation employed by him and by Mullerf we may write

where u = r{ + l and v=st+l. The object of the present communication is to give a reduced^ rational algebraic evaluation of the probability (Ppt>p1) that for the postulated systems p, exceed pi, and to indicate certain relations between its value (later designated by ^(ri.n.n.H)) an<* t n e 8 u m °^ fcne ^ r a t r% + 1 t e r m s °* a hypergeometric series which has appeared in the work of K. Pearson§|| as well as in the Incomplete B- and I-functions *f of (3).
Obviously, we may write

Downloaded from http://biomet.oxfordjournals.org/ at Georgetown University on May 24, 2015

= <^ + ] ) ' f1 g ("« + M . «r1+. . «*+%*- . dp
ri!«i! Jo«=o \ a / l Si /nt+iN (nL+a)l(*i + »» + l - c )
rl\s1\ \ t \ a )• "(m + ^ + 2)!
1)! ^ (n
-a)!

whence we have

( i a + 2)! " Qr0 nl (r, - a)! «i! («« + 1 + a)!
i i\

i
where, of course, ??<= •)•< + «,-.
Now, it is obvious that Ppt>Pl = -Pj!1<?i= ^ ^ f c = P « < ? i ' w h e r e ?< = x ~P<< a n d thus in similai' manner we have

(6)

/nx + n, + 2\

\ «i + l >

Furthermore, Ppt>p1 = 1 — Pp1>pt, as the probability that|fi is exactly equal to p* is zero by hypothesis. Hence we have two other similar sums which may be used with

this difference relation to evaluate the probability under consideration.

* Pearson, Karl: Biometnka, VoL xvi (1924), pp. 202—208. + Mflller, J. H . : Biometrika, Vol. n n (1930—81), pp. 284—297. % The earliest work directed to this end ia discussed by Todhunter. Cf. A History of the Mathematical Theory of Probabilty. Cambridge and London (1866), pp. 419—420.
§ Pearson, Karl: Philoiophical Magazine, Series 6, Vol. 13 (1907), pp. 365—878. 1 Pearson, Karl: Biometrika, Vol. xxA (192«), pp. 149—174.

288 Likelihood that One Unknown Probability exceeds Another

In actual evaluation we may make use of the well-known pyramid form of

tabulation of the binomial coefficients,

1

11

12 1

13 3 1

14 6 4 1

(7)

1 5 10 10 5 _ 1

1 6 15 20 15 6 1

Downloaded from http://biomet.oxfordjournals.org/ at Georgetown University on May 24, 2015

which is readily constructed by the property that each entry except those on the boundaries (which are always unity) is the sum of the two nearest entries of the row next above *. The corresponding factors of the successive terms in the sum to be evaluated may be found in order on given diagonals, ascending in the case of the first and descending in the case of the second factor. The bounding diagonals of units may be deleted in practice (as may all entries to the right of the middle column). Then the first factor of the first term of the sum in (5) is the n-th entry in the row whose first entry (at the left) is r-L + rt, and the corresponding factors of successive terms lie successively above on the diagonal through the first and parallel to the left-hand boundary. Similarly, the other factors are found, but proceeding in the opposite direction on the appropriate diagonal.

Now, for any positive number, x, let Q(X) = a?+i. Then, by Stirling's formula,

we have

e

(8)

m ! = Q(w). \/2TT . e~m. e ,

where 0 $ 0 < 1; whence (4) (v) gives

\r» - a

where

|12w|<—I \- —-; 1 ' n «, «i + 1

which may be used to advantage in approximation of Ppt>pl when ri and «x are large

and rt small.

Now we may define Vr(»-i.»i.'^.»i) ^or anJr f°ur rational integers (not negative) as

identical with the right member of (5), where «j = r< + 8t > 0. Then we have shown

several equivalent expressions of the same function and that

* Olauher, J. W. L.: "A Table of Binomial-Theorem Coefficients," Messenger of Mathematics, Vol. 47 (1917), pp. 97—107.

WILLIAM R THOMPSON

289

From the conditions stated it may be expected that if we set p = -1 and q = 1 — p,

then (provided 0 < p < 1),

(11)

lim ^ a - ^ - - i s ) . . - = l.

That this is true may be verified if we exclude the cases, p = 0,1. Further bounds to approximation of this limit by the ratio (R) of these functions for given values of 7ix may be found as follows:

By (4) (iv) we may write

^

V (>lt+1\

(?-! + a)! (*! + ft, + 1 - a)!

''11

1!

Downloaded from http://biomet.oxfordjournals.org/ at Georgetown University on May 24, 2015

and by (2) and (3), introducing the appropriate values of )• = ?•» and 8 = 8%, we have

(13)

/,<«2+ 1, r,+ 1)= 2

where p = — and </ = —. Obviously, therefore, as all terms of both sums iu (12) and
(13) are positive, if we exclude the special cases where p or q = 0, R is bounded by the greatest and least values attainable for the ratio of a term in the sum of (12) to the corresponding term in (13). Thus we may define

|_

i+

»8 + 2J J

and

^ = Max \(TL±^ *I±1* + 1 Z l ]

for(105£) a $ »•»; and, obviouslayn,<thRen<a>t, and

In the excluded cases it is also readily verified that

(16)

li

The relation of this function to the sum of a given number of consecutive terms of a hypergeonietnc series is particularly interesting in view of the occurrence of such series in the investigations of K. Pearson *f. By (4)(iv) we may write :
)!(?),+1)1 ^ (r1 + a)\(s1+ni+l-a)\

* Pearson, Karl: Philoiophical Magazine, Series 6, Vol. 13 (1907), pp. 366—878. t Pearson, Karl: Biometrika, Vol. xx* (1928), pp. 149—174.

290 Likelihood that One Unknovm Probability exceeds Another

which is the sum of the first rt + 1 terms of a hypergeometric series multiplied by a constant. Similarly, we may write

)!(«,+ 1)1 a («i + a)!(n+n« + l - o ) !

(18) Y^'-^-^TW+W^l«=o

«!(»,+1-a)!

Downloaded from http://biomet.oxfordjournals.org/ at Georgetown University on May 24, 2015

obviously (us «2 = ;-a + s2); and by previous demonstration

(19> whence

f(fl,.,,r,,^ + VrU,.rI.«1,r,)=l.

» + 2)! rx! gx! = ».+l (n + a)! (ax + //, + 1 - g) !

1)!(+1)!

!(

l)!'

"'

The last relation, demonstrated above by independent proof, has been
established previously by Pearson*f (with different notation). Thus we may regard Vr('ii,«i.'-i.»i> aa defined by the identity

= —o

g) ! (8j + M, + 1 - g ) ! g!(na+l-g)l

a~u

g I (TIJ + 1 - g) !

extending the domain of definition to include the value, r» = 74 + 1; but retaining

the restrictions, tu = r{ + s{^0, and that - 1 be the least value of rlt Si, r%, and «s (only one of which shall be admitted to be negative). Then, by this extension,

we have

(22)

^r(ri'*t-0|0)~r1 + a 1 + 2 ' & n d ^•*>n*+1<-1) B1'

which lie outside the domain of the initial discussion, and we extend to the new domain the relation of (10) formally; i.e.

(23)

^(r,i,r',i')= fif.r'.n.r) = 1 ~ Vr(«,r, f, r-) •

K, Pearsonf has considered the problem of likelihood of various values of R and S, the number of marked members and unmarked members, respectively, in a finite universe of aggregate number, N=R + S; assuming N fixed and all values of R, S ^ 0 equally likely a priori and that our sole experience from which judgment is to be made is that a random sample has been drawn containing exactly r marked and s unmarked members (R and 8 being used here in place of Pearson's p and q to avoid confusion). Then by (iii) and (iv) of the articlef just mentioned, we have a means of evaluating the probability, PB, that the universe contains no more than R marked members by the relation,

* Pearson, Karl: PhUotophical Magazine, Series 6, Vol. 18 (1907), pp. 885—878. t Pearson, Karl: Biometnka, Vol. xx* (1928), pp. 149—174.

Downloaded from http://biomet.oxfordjournals.org/ at Georgetown University on May 24, 2015

WILLIAM R. THOMPSON

291

which may be verified readily. Similarly, in the case of the problem considered earlier by Pearson*—having drawn one random sample from a certain infinite population, the sample containing exactly r' marked and s' unmarked members, we are required to find the probability (under the given conditions) that if we draw another random sample of n" individuals from the same population it will contain no more than r" marked members—the required value is given for r" < n" by

In the tabulation of values of •\Jr<r,r'it<) for ascending values of the arguments the work may be greatly simplified by certain relations in addition to those given in (22) and (23) in much the same manner as the binomial coefficients may be tabulatedf by mere summation of two values already given. To this end let us examine two functions defined by

(25) and

i W » = $(r + r'-«)(« + °' + l+^

a=O \

*

/ V.

&

An MY.«•» = An n.ni = (n + H.' ,+ 2\ f,or n = r + «, and

Obviously, by the original definition of ^(,,», r\ ,->, extended in (21), (22) and (23), then

(26)

^W,,. = 7^^,

where we extend the definition of (25) for r, «, r', s' ^ 0 by

(27)

N(rt,i-it.-)=O, and Nlr,,yt-i) = D(r+,,r-»,

and by'(26) and (23) we have

as it is obvious that Z)(n „-) = Z)(n- „). Furthermore, by the well-known relation,

An,n') = A»,n'-1) + AB-1,«) . we have for s > 0 in (25)

(30)

^,,,^=2^

)[(

)+(

whence we have in any case under its definition, obviously, by (20), (27) and (28), the identities

(31)

^w,., A ••> ^ N(r, ,_i, r.>o + Nir_,, r-, ^_i,

= -^(r-l,«, r1,0 + -Ar(r, t, f'-l, O •

By (25) and (29), obviously, the same relation holds for the D-function; and

we may write

,oo.

,r

-fl(r,*-l,r;n+N(r,$,ir',*-l)

* Pearson, Karl: Philosophical Magazine, Series G, Vol. 13 (1907), pp. 866—378. t GUiaher, J. W. L.: "A Table of Binomial-Theorem Coefficients," Mcttenger of Mathematici, Vol. 47 (1917), pp. 97—107.

292 Likelihood thai One Unknown Probability exceeds Another

Downloaded from http://biomet.oxfordjournals.org/ at Georgetown University on May 24, 2015

By means of these relations it is evident that it suffices to tabulate the N and the D- functions by additions of corresponding pairs of values already listed or readily obtained by the relations of (28) if we proceed from the lowest values of the arguments upward; and we need list values only for the cases where r + s > r' + s' and r^s where all four variables may be restricted to positive values, as by (25) we have

(33)

-^(r,t,0,«1 = A»-l,«'>-

By (25) we may write r1

(34)

#<r, i, •,»')= 2 Ar-l.f-1-.) -

which is of value if -D<B,n') is tabulated for n^n' through ascending values of n and «'. This may be done rapidly by means of (29) and the relation D(n,»o = D(n,n) and is more convenient than the pyramid form of the corresponding binomial coefficients. In the tabulation we may restrict n and n' to the positive integers, employing the relation D^o) = n + 2. A short table of the N and D functions is appended as an illustration, the required probability being the ratio of these corresponding values.
Section 3.
If a system of operation such as suggested in Section 1 were adopted extensively for the case considered in Section 2, reference to values of ^ir.t.r'.f') f°r small values of the arguments should be required frequently; and, accordingly, a simple method of formation of a table of these would be valuable. The method given in Section 2 seems to serve this purpose; and, in conjunction with the relations of (28), many values need not be listed. The short table is given merely in illustration. It really deals completely with all cases of n, n' < 5 although certain cases are not listed where the values are readily obtainable from those given and (28). The several general evaluations at the head of the table would permit deletion of many more, e.g. any instance where one of the four arguments is zero; but they have been retained for illustrative purposes.

The function, Z)(n,BT = (

), is readily tabulated in a convenient form

for increasing values of n^n'^1, as has been mentioned under (34) above by adding to n + 2 successively the values of Dfn-i,ni, already listed, and taking a subtotal after each addition, and finally doubling the last sub-totaL These sub-totals and the final double are the required successive values of D^^. The value of such a table extends far beyond that of the immediate problem; and, by means of it and relation (34), i/r,,,,-^ may be calculated rapidly or approximated with any required precision for considerably higher values of the arguments than it may be convenient to have tabulated Ar(r,»,r',«v In accord with some prescribed tolerance and limited extent, a table of approximate values of the .D-function could be made with greater ease, but apparently not readily extensible within the same relative tolerance without revision. Just how far these tables should extend would depend upon demands for their use. All questions as to approximate methods should be decided

WILLIAM R THOMPSON

293

Downloaded from http://biomet.oxfordjournals.org/ at Georgetown University on May 24, 2015

Short Table of N^,it>t^ and An,*-) (»»=»" + s, and n = r ' + «')

r a r"

N

D

r

X

•'

N

D

a6 c d

V

n

40

0

4

1

252

b a d c 5-/V

cba

N

Dn

40

1

3

40

2

2

6
21

r s -I

0

40

3

1

56

ra 0

0

1

r0 0

»'

1

r+2 3 1 1 3

26

31

2

g

66

rr
r

0
„

1 0 0

n
0 s>

r+2
s+l

n+2

ft 0

0

1

ft 0

1

0

1 7

28

~'

41

0

I

3

0 0 -1

0

0

41

1' 0

13

1

32

0. 1

6

00

0

0

1

2

32

1

0

18

10 0 0

1

01 0 0

2

3

50

0

2

50

1

1

1 7

84

50

2

0

28

10 0 1

1

10 1 0

3

6

41

0

2

4

41

1

1

19

41

2

0

49

20 0 1

1

2o 1 0

4

11

0

i

3

10

32

0

2

10

32

1

1

34

32

2

0

64

to to

002

1

20

0 11

4

30

0

1

1

15

30

10

5

21

0

1

3

21

1

0

9

30

0

2

1

35

30

1

5

30

2

0

IS

21

0

2

4

•2 1 1 1

13

21

2

0

25

30

0

3

1

70

30

1

2

5

30

2

1

lft

21

1

2

17

40

0

1

1

21

40

1

0

6

31

0

1

3

31

1

0

11

22

0

1

6

40

0

2

40

1

1

1

56

6

40

2

0

21

31

0

2

4

31

1

1

16

31

2

0

36

22

0

2

10

22

1

1

28

40

0

3

1

126

40

1

2

6

40

2

1

21

40

3

0

66

31

0

3

ft

31

1

2

21

31

2

1

SI

31

3

0

91

22

0

3

16

22

1

2

46

ft 0

0

3

1

210

ft 0

1

2

7

ft 0

2

1

28

50

3

0

84

41

0

3

5

41

1

2

2ft

41

2

1

70

4I

3

0

140

32

0

3

15

32

1

2

65

32

2

1

lift

32

3

0

175

50

0

4

1

462

50

1

3

7

50

2

2

28

50

3

1

84

50

4

0

210

41

0

4

6

41

1

3

31

41

2

2

91

41

3

1

196

41

4

0

336

32

0

4

21

32

1

3

81

32

2

2

181

32

3

1

301

32

4

0

406

50

0

ft

1

924

ft 0

1

4

7

ft 0

2

3

28

50

3

2

84

50

4

1

210

41

1

4

37

41

2

3

112

41

3

2

252

32

2

3

262

294 Likelihood that One Unknown Probability exceeds Another
by several statisticians in consultation at a time when a definite programme for the use of these methods is formed.
In (24) and the paragraph in which it stands is given the relation between the hypergeometrical series studied by Pearson*-f- and Vv.t.r'.io by means of which it is obvious that any approximation methods valid for estimation of PR in (24) are equally valid for the estimation of the corresponding i/r-function, several of which have been suggested by K. Pearson. The /-function of Pearson is related to the i/r-functioa by (11) to (15) also; and another approximation of i/r,rii,liri>,i) is given in (9) with indicated domain of validity.
A further treatment of the i/r-function and the method of apportionment will be provided in a later paper.
* Pearson, Karl: Philosophical Magazine, Series 6, Vol. 18 (1907), pp. 865—878. t Pearson, Karl: Biometnka, Vol. xxA (1928), pp. 149—174.

Downloaded from http://biomet.oxfordjournals.org/ at Georgetown University on May 24, 2015

