The 6th Annual IEEE International Conference on Cyber Technology in Automation, Control and Intelligent Systems
June 19-22, 2016, Chengdu, China

High Accuracy Navigation System using GPS and INS System

Integration Strategy
Wei Yan2, Lijie Wang2, Yufeng Jin1, Guangyi Shi12*
1Peking University Shenzhen Graduate School, Shenzhen, CHINA 2School of Software and Microelectronics, Peking University, Wuxi, CHINA
*Contact author: shiguangyi@ss.pku.edu.cn

Abstract—This paper proposes a position and attitude observer based on INS and GPS. Design and test results of an adaptive dual-rate Extended Kalman Filter(EKF) estimator for fusing data from Global Positioning Systems (GPS) and an Inertial Navigation System (INS) in order to estimate the position, velocity, and attitude. The dual-rate EKF consists of a high-speed filter and a low-speed filter, the high-speed filter fuses data from Real-Time Kinematic (RTK) GPS and INS, the low-speed filter fuses data from pseudorange GPS and INS. This solution designed to isolate the noise from pseudorange and realize the complementary of real-time performance and high precision. The solution yields exponential convergence of the attitude and position estimates. The implementation results show that the proposed method resolves an integer vector identical to that of the original method and achieves state estimation with centimeter global positioning accuracy.
Keyword: GPS; INS; dual-rate Kalman filter
I. INTRODUCTION.
GPS/INS has proven to be useful because of its characteristics of complementary [1]. INS provides a continuous broadband state vector, GPS provide accurate position information and help correct mistakes accumulation process of INS and calibrate of inertial measurement unit (IMU). The overall precision of GPS/INS depends on the accuracy, GPS measurement and frequency. A well-designed GPS receiver position precision can usually reach 3-8m[2]. Considering the spatial correlation of GPS error, DGPS can obtain higher positioning accuracy. Within a few tens of kilometers in base station, DGPS position precision can reach 1m, with increasing distance from the base station, error is increased 1m per 150 km [3]. Users can set up a base station or use public calibration services: continuous operating reference station (CORS) [4]. With the development of mobile network, DPGS are used more widely.
GPS receiver provides carrier phase observation to calculate integer ambiguity. When loss of lock with satellite, new integer ambiguity resolution is most likely to be different. Common integer ambiguity resolution algorithm into an integer least-squares insurance-linked securities (ILS) method, for example: MLAMBDA [5], LAMBDA [6], or MILES [7]. Real-time kinematic (RTK) application solution ILS and real time location estimation problem [8,9], RTK solution problem is simplified, but it is still a challenge

when dual frequency receiver is available, because you can solve the integers by formed the wide-lane phase measurement [10]. When the integer vector can be resolved, centimeter positioning accuracy is achievable in real time on moving platforms [13]. Traditional DGPS performance is strongly influenced by the number of available satellites, receives satellite geometry position and the quality of the measurement results. If noise or error exist, integer ambiguity solution will make mistake, due to the lack of solution of correct the error, ambiguity solution of single frequency receiver is challenging.
For the conventional GPS/INS integration techniques, there exists a basic dilemma, the high precision integrated systems generally have poor reliability and real-time performances, and the systems with good reliability and real-time performances generally have low precision. On the one hand the integration of GPS RTK/INS can be very precise, however, its reliability will become weak with the increasing of the distance from the GPS base station and its real-time performances are not good because of the necessity for the resolution of the integer ambiguities. So GPS RTK/INS integrated system can not be used in real-time or wide-area navigation applications. On the other hand, the integration of GPS pseudorange/INS is suitable for navigation applications because of its good reliability and real-time performances but its precision is low. The first goal of this research is to improve the overall performances of GPS/INS integrated system by rearrangement of the GPS information and by using new integration technique, the second goal is to use a novel implementation approach with significantly lower computational requirements in integer ambiguity solving. To accomplish these two goals, the following work has been finished in this work.
1. A new GPS observable, incremental carrier-phase observable, has been derived based on GPS carrier-phase, and the corresponding observation equation for the carrier phase has also been derived. Furthermore, the applications of the carrier-phase in navigation and integrated navigation have been discussed.
2. For the optimal estimation systems with two kinds of observable whose measurement noises are quite different with each other, a novel optimal estimation technique, dual-rate Kalman Filtering technique, has been proposed,

978-1-5090-2733-0/16/$31.00 © 2016 IEEE

365

and the relevant theoretical analysis has been done. The dual-rate Kalman Filter fuses the low-noise observable with high rate, and the high-noise observable with low rate into the optimal estimation systems.
3. By using the dual-rate Kalman Filter as the integration tool, a novel tightly coupled integration system based on the carrier-phase, the pseudorange, and the INS has been designed. Experimental tests have demonstrated that, compared with the conventional integration techniques, the proposed novel integration technique has improved the position accuracy, velocity accuracy and real-time performance.
II. PROBLEM STATEMENT
This section presents RTK GPS [12] and aided INS [1]background and notation. Throughout this paper, double-differenced GPS measurements are considered.
The positioning principle of pseudorange and real-time
kinematic, In the base station observed i th GPS satelliteˈ
get pseudorange as˖

Ubi

˙

Rbi

ˇC

(

dW b

ˉ

dW

i s

)ˇ

d Ubi

ˇ

d

Ui bion

ˇ

Ui b

trop

ˇ

dM b

ˇXb

(1)

Where Rbi is the real distance of base station to ith satellite,

dW b

is the clock bias of base station and

dW

i s

is the clock

bias

of

ith

GPS

satellite,

d Ubi

,

d

Ui bion

,

Ui btrop

,

dM b

, Xb

represent

the

common-mode

errors

(ephemeris, ionosphere, troposphere, multipath effect and

receiver noise).

Using satellite ephemeris compute the satellite position and the precise coordinates of known base station satellite to calculated real distance from satellite to base station

'Ubi

˙

Rbi

ˉ

U

i b

˙ˉ˄C

(

dW

b

ˉ

dW

i s

)ˇ

d

Ubi

ˇ

d

Ui bion

ˇ

Ui btrop

ˇ

dM

b

ˇXb

˅

(2)

In the meantime, User receiver receive the pseudorange is˖

Uui ˙ Rui ˇC

(

dW

u

ˉ

dW

i s

)ˇ

d

Uui

ˇ

d

Ui uion

ˇ

Ui utrop

ˇ

dMu ˇXu

(3)

If use 'Ubi to modify user pseudorange is modeled as:

'Ubi

ˇ

U

i u

˙

Rui

+C

(

dW

u

-

dW

b

)+

(

d

Uui

-

d

Ubi

)+

(

d

Ui uion

-

d

Ui bion

)+(

Ui utrop

-

Ui btrop

)ˇ(

dM

u

-

dM

b

)+

(Xu -Xb )

(4)

When the base station is within a few tens of kilometers, where,

d

Uui

˙

d

Ubi

ˈ

d

Ui uion

˙

d

Ui bion



Ui utrop

˙

Ui btrop

so

'U

i b

ˇ

Uui

˙

Rui

ˇ&

dW u

ˉ

dW b

ˇ

dM u

ˉ

dM b



ˇXu ˉXb 

      X i  Xu 2  Y i  Yu 2  Z i  Zu 2  'dU (5)
If the base station and the user station observed the same four satellites at the same time, Which can calculate the
user station’s coordinates ( Xu , Yu , Zu ) and 'd U . 'd U contains each residual in the same observation epoch

'dU & dW u  dWb  dMu  dMb Xu Xb (6)

For the carrier phase observation

  U

i u

O

Nui 0



N

i u

 -u (7)

where Nui 0 is the initial phase ambiguity, Nui represents the phase integer ambiguity from the initial epoch to
observation epoch,-u is the fractional part of phase, O is
the carrier wavelength.Then we have˖

    Rbi

O

N

i N

0



Nbi 0

O

N

i u



N

i b

 -ui ˉ-bi 

      

X i  Xu

2

Y i  Yu

2

Z i  Zu

U  'd 2 

(8)

Rbi is the real distance between the base station to satellite within formula, calculated by the satellite ephemeris and the coordinates of base station. The key for the equation is how to solve the initial phase ambiguity.

By observing table 1 can get the following conclusion: pseudorange and carrier phase measurement precision are similar (in the same order of magnitude).

Unadjusted Error(m)

Correction Error(m)

Pseudorang Carrier

e

Phase

Pseudorang Carrier

e

Phase

Satellite

2

2

N/A

N/A

Clock Bias

Satellite

2

2

N/A

N/A

Orbit Biases

Ionosphere 2-10

2-10

1-5

1-5

Error

Troposphere 2.3-2.5

2.3-2.5

0.1-1

0.1-1

366

Error

Multipath

0.5-1

0.005-0.01 N/A

N/A

Receiver

0.25-0.5

0.001-0.002 N/A

N/A

Noise

TABLE 1

TYPICAL VALUES OF ERROR IN PSEUDORANGE AND CARRIER PHASE

The following part analyzes and compares measuring resolution of pseudorange and carrier phase. Resolution is measuring physical quantities of the measuring instruments reliable minimum resolution. Satellite clock bias, satellite orbit bias, the ionosphere and troposphere errors have strong time correlation, In 1 second they change with time less than 2.5mm, Therefore, the effect of these four errors in a short period of time is a kind of constant bias the constant bias does not affect the measurement resolution. So, pseudorange and carrier phase measurement resolution mainly determined by random multipath error and receiver noise. According to table 1, the multipath error of pseudorange can reach 1m, and carrier phase multipath error is only 1cm. In fact, with the progress of receiver design method, under the condition of benign measurement, carrier phase multipath error can reach below 5mm[13]. Therefore, the resolution of the pseudorange reached meter level, and the resolution of carrier phase can reached micro meter level.

Conclusion: From the above analysis, the pseudorange and carrier phase can reached meter level, but the measuring resolution of pseudorange is meter level, and carrier phase can reach micro meter level.

Based on the previous analysis, the mathematical tool use in fusing data of carrier phase difference, pseudorange and inertial navigation must be able to isolate the noise of carrier phase difference and pseudorange.

As depicted in Figure 1, one method is to divide Kalman filter that driven by carrier phase pseudorange into two, carrier phase difference and pseudorange drive respectively. After split, the measurement error covariance matrix of carrier phase and pseudorange Acting on their respective Kalman filter, namely carrier phase noise and pseudorange noise isolation.

Fig 1: Dual-rate Kalman filter error covariance propagation process
As depicted in Figure 2, based on the dual-rate Kalman filter, pseudorange, carrier phase difference and inertial navigation integrated navigation contain three parts: Inertial navigation decoding part, high-speed Kalman filter and low-speed Kalman filter. The calculation period of three parts different, cycle of inertial navigation is minimum, high-speed Kalman filter take second place, cycle of low-speed Kalman filter is the largest.
In this paper, calculation period of inertial navigation is 0.1 seconds; cycle of High-speed Kalman filter and GPS signal cycle is same as 0.1 seconds; low-cycle Kalman filter and sample GPS signal is 100 seconds. The role of the high-speed Kalman filter is realized tight coupling of carrier phase difference and INS and low-speed Kalman filter do the same with pseudorange and INS. Meanwhile, calculating the error of inertial navigation prediction relative to GPS direct observation. This error will be input into the extended Kalman filter to estimate system error. The output of the extended Kalman filter will be feedback to the inertial navigation solution of high/low Kalman filter, damping on the position error accumulation.

367

Fig 2: Carrier phase difference, pseudorange and INS integrated navigation system solution
III EXPERIMENT DESIGN
The main goal of this paper is to assess navigation system's precision and coasting ability. The coasting ability refer to GPS signal under the condition of interruption, the performance of the work independently [14]
Accuracy and coasting ability of GPS and integrated navigation system is highly affected by the environment and dynamic performance. System runtime environment main impact on the performance of GPS, such as high-rise buildings, tunnels, bridges and trees can block part or all of the GPS satellite signal, which led to the decrease of the positioning accuracy, or can't locate. These complex environment factors may also increase the multipath error of GPS receiver and reduce the positioning accuracy of GPS. System dynamics performance can impact integrated navigation system from two aspects. On the one hand, the high dynamic would increase the inertial sensor noise, thus resulting in a decline in the performance of the inertial navigation system. On the other hand, the high dynamic increases the observability of integrated navigation system, and improve the estimate of the inertial sensor drift. Therefore, in order to evaluate system performance under different conditions, experiment need different system runtime environment, and design dynamic of the system. Based on the above consideration, test trajectory shows in fig 3.

Fig. 3. Route and the satellite availability of the 600-s moving data experiment. The x- and y-axis are the longitude and latitude in degrees,
respectively.

The part of data list in following table 2:

Latitude (degreeϨ)

Longitude (degreeϨ)

Yaw (degreeϨ)

Pitch

Roll

(degreeϨ) (degreeϨ)

31.4777858119  120.2658401680 31.4777858229 120.2658401327 31.4777858188 120.2658401341 31.4777858086  120.2658401303 31.4777858027  120.2658401329 31.4777858015  120.2658401418

-001.7 -001.8 -001.8 -001.8 -001.8 -001.8

0000.9 0000.9 0000.9 0000.9 0000.9 0000.9

0056.7 0057.1 0057.1 0057.2 0057.2 0057.4

31.4777857987 120.2658401437

-001.8 0000.9 0057.4

31.4777857979 120.2658401411

-001.8 0000.9 0057.4

31.4777857993 120.2658401406

-001.8 0000.9 0057.3

31.4777858131 120.2658401486

-001.8 0000.9 0057.0

31.4777858136 120.2658401417 31.4777858079 120.2658401336 31.4777858106  120.2658401246

-001.8 -001.8 -001.8

0000.9 ,0056.9 0000.9 0056.9 0000.9 0056.9

TABLE 2 DATA LIST

Magnitude of the position shift estimated by the error covariance, shows in fig 4. During the experiment, artificially set GPS signals lost lock 30s twice, the original GPS information makes the INS error accumulation not beyond the thresholdˈonce the GPS signal recovery, the error is corrected immediately.

368

Fig 4. The position shift estimated
IV SUMMARY
This work design and implemented carrier phase difference and INS integrated navigation systemˈOn the basis of error analysis of experimental results, navigation accuracy carrier phase difference and INS integrated navigation system is close to GPS RTK position precision. But its drawback is that the position errors have an slowly accumulation effect. We design an optimal estimation system for two kinds of observation and measurement noise, and measurement noise have great different. Using a dual-rate Kalman filter, puts forward the low noise observed quantity in the form of high frequency, and high noise observations in the form of low frequency into the optimal estimation system, dual-rate Kalman filter technology can effectively isolate measurement noise from different observation quantity. Besides, dual-rate Kalman filtering technology also can be used to realize the synchronous observation information fusion and improve operation efficiency.
ACKNOWLEDGE
This work is partially supported by Shenzhen New Technology Funding 20160224160654843 and Jiangsu Industrial Support Program No. BE2014003-4.
REFERENCES
[1] J. A. Farrell, “Aided Navigation: GPS with High Rate Sensors”, New York, NY, USA: McGraw-Hill, 2008.
[2] “Global Positioning System Standard Positioning Service Performance Standard”, US DoD Positioning, Navigation, and Timing Executive Committee, Washington, DC, USA, 2008.
[3] E. D. Kaplan and C. J. Hegarty, Eds., “Understanding GPS: Principles and Applications”, 2nd ed. Norwood, MA, USA: Artech House, 2006.

[4] R. A. Snay and T. Soler, “Continuously Operating Reference Station (CORS): History, Applications, and Future Enhancements,” J. Surv. Eng., vol. 134, no. 4, pp. 95–104, 2008.
[5] P. de Jonge and C. Tiberius, “The LAMBDA Method for Integer Ambiguity Estimation: Implementation Aspects”, Faculty Geodetic Eng., TUDelft, Delft, The Netherlands, Tech. Rep. 12, 1996.
[6] X.-W. Chang, X. Yang, and T. Zhou, “MLAMBDA: A Modified LAMBDA Method for Integer Least-squares Estimation”, J. Geodesy, vol. 79, no. 9, pp. 552–565, 2005.
[7] X.-W. Chang and T. Zhou, “MILES: MATLAB Package for Solving Mixed Integer Least Squares Problems”, GPS Solution, vol. 11, no. 4, pp. 289–294, 2007.
[8] R. Hatch, “The Synergism of GPS Code and Carrier Measurements”, in Proc. 3rd Int. Geodetic Symp. Satellite Doppler Positioning, vol. 2. 1983, pp. 1213–1231.
[9] R. Hatch, “Instantaneous Ambiguity Resolution”, in Kinematic Systems in Geodesy, Surveying, and Remote Sensing, vol. 107. New York, NY, USA: Springer Verlag, 1990, pp. 299–308.
[10] T. Takasu and A. Yasuda, “Development of the Low-cost RTK-GPS Receiver with An Open Source Program Package RTKLIB”, in Proc. Int. Symp. GPS/GNSS, Jeju, Korea, 2009, pp. 1–8.
[11] J. A. Farrell, T. D. Givargis, and M. J. Barth, “Real-time Differential Carrier Phase GPS-aided INS”, IEEE Trans. Control Syst. Technol., vol. 8, no. 4, pp. 709–721, Jul. 2000.
[12] P. Misra and P. Enge, “Global Positioning System: Signals, Measurements and Performance”, Lincoln, MA, USA: Ganga-Jamuna Press, 2001.
[13] Fan K. K., Ding X. L., “Estimation of GPS Carrier Phase Multipath Signals Based on Site Environment”, Journal of Global Positioning Systems. 2006, 5(1-2): 22-28.
[14] Farrell J. L., Anoll R K, Mcconkey D. D., “IMU Coast: Not a Silver Bullet”, ION 55th Annual Meeting, Cambridge, MA, USA, 28-30 June, 1999: 159-168.

369

