Planning IoT wireless links
Marco Zennaro T/ICT4D Laboratory
ICTP-Italy

2

Goals
‣ To be able to calculate how far we can go with the equipment we have
‣ To understand why we need high masts for long links
‣ To learn about software that help the process of planning radio links
2

Power in a wireless system
4

Free Space Loss (any frequency)
‣ Using decibels to express the loss and using a generic frequency f, the equation for the Free Space Loss is: Lfs = 32,45 + 20*log(D) + 20*log(f)
‣ ...where Lfs is expressed in dB, D is in kilometers and f is in MHz.
5

6

Link budget
‣ The performance of any communication link depends on the quality of the equipment being used.
‣ Link budget is a way of quantifying the link performance.
‣ The received power in an 802.11 link is determined by three factors: transmit power, transmitting antenna gain, and receiving antenna gain.
‣ If that power, minus the free space loss of the link path, is greater than the minimum received signal level of the receiving radio, then a link is possible.
‣ The difference between the minimum received signal level and the actual received power is called the link margin.
‣ The link margin must be positive, and should be maximized (should be at least 10dB or more for reliable links).
7

8

Example link budget calculation
Let’s estimate the feasibility of a 5 km link, with one access point and one client radio.
The access point is connected to an antenna with 10 dBi gain, with a transmitting power of 20 dBm and a receive sensitivity of -89 dBm.
The client is connected to an antenna with 14 dBi gain, with a transmitting power of 15 dBm and a receive sensitivity of -82 dBm.
The cables in both systems are short, with a loss of 2dB at each side at the 2.4 GHz frequency of operation.
9

AP to Client link

+20 dBm

+10 dBi

+14 dBi

-2 dB

-114 dB @ 5 km

-2 dB

???

-82 dBm
10

Link budget: AP to Client link
20 dBm (TX Power AP) + 10 dBi (Antenna Gain AP) - 2 dB (Cable Losses AP) + 14 dBi (Antenna Gain Client) - 2 dB (Cable Losses Client)
40 dB Total Gain -114 dB (free space loss @5 km)
-73 dBm (expected received signal level) --82 dBm (sensitivity of Client)
9 dB (link margin)
11

Opposite direction: Client to AP

+15 dBm

+14 dBi

+10 dBi

-2 dB

-114 dB @ 5 km

-2 dB

???

-89 dBm
12

Link budget: Client to AP link
15 dBm (TX Power Client) + 14 dBi (Antenna Gain Client) - 2 dB (Cable Losses Client) + 10 dBi (Antenna Gain AP) - 2 dB (Cable Losses AP)
35 dB Total Gain -114 dB (free space loss @5 km)
-78 dBm (expected received signal level) --89 dBm (sensitivity of AP)
10 dB (link margin)
13

Fresnel Zone
‣ The First Fresnel Zone is an ellipsoid-shaped volume around the Line-of-Sight path between transmitter and receiver.
‣ The Fresnel Zone is important to the integrity of the RF link because it defines a volume around the LOS that must be clear of any obstacle for the the maximum power to reach the receiving antenna.
‣ Objects in the Fresnel Zone as trees, hilltops and buildings can considerably attenuate the received signal, even when there is an unobstructed line between the TX and RX.
14

Line of Sight and Fresnel Zones
r
a free line-of-sight IS NOT EQUAL TO a free Fresnel Zone
15

Fresnel Zone
‣ The radius of the first Fresnel Zone at a given point between the transmitter and the receiver can be calculated as:
r = 17.31 * sqrt((d1*d2)/(f*d))
‣ ...where r is the radius of the zone in meters, d1 and d2 are distances from the obstacle to the link end points in meters, d is the total link distance in meters, and f is the frequency in MHz.
‣ Note that this gives you the radius of the zone, not the height above ground.To calculate the height above ground, you need to subtract the result from a line drawn directly between the tops of the two towers.
16

Line of Sight and Fresnel Zones

r rMAX

d1

d2

r = 17.31 * sqrt((d1 * d2) / (f * d))
17

Clearance of the Fresnel Zone and earth curvature
This table shows the minimum height above flat ground required to clear 70% of the first Fresnel zone for various link distances at 2.4 GHz.
Notice that earth curvature plays a small role at short distances, but becomes more important as the distance increases.

Distance 1st zone

(km)

(m)

1

5.5

5

12.4

10

17.5

15

21.4

20

24.7

25

27.7

30

30.3

70% (m)

Earth curvature (m)

3.9

0.0

8.7

0.4

12.2

1.5

15.0

3.3

17.3

5.9

19.4

9.2

21.2 18

13.3

Required height (m)
3.9 9.1 13.7 18.3 23.2 28.6 34.5

Fresnel Zone
‣ Considering the importance of the Fresnel Zone, it is important to quantify the degree to which it can be blocked.
‣ Typically, 20% - 40% Fresnel Zone blockage introduces little to no interference into the link.
‣ It is better to err to the conservative side allowing no more than 20% blockage of the Fresnel Zone.
19

Radio Mobile
‣ Radio Mobile is a free tool to aid in the design and simulation of wireless systems.
‣ It can automatically calculate the power budget of a radio link, calculating the Fresnel zone clearance. It can use digital maps, GIS (Geographical Information Systems), or any other digital map, including maps provided by yourself.
‣ Runs on Windows 95, 98, ME, NT, 2000 and XP.
http://www.cplus.org/rmw/english1.html
20

Radio Mobile
‣ Uses Digital terrain Elevation Model for the calculation of coverage, indicating received signal strength at various point along the path.
‣ Radio Mobile automatically builds a profile between two points in the digital map showing the coverage area and 1st Fresnel zone.
‣ Different antenna heights can be tried to achieve optimum performance.
21

Radio Mobile
22

Telegram Bot: BotRf
‣ Telegram is an instant messaging service. Telegram clients exist for both mobile (Android, iOS, Windows Phone, Ubuntu Touch) and desktop systems (Windows, OS X, Linux). Users can send messages and exchange photos, videos, stickers and files of any type. Telegram also provides optional end-to-end encrypted messaging.
https://telegram.org/
23

Telegram Bot: BotRf
‣ Telegram Bots are special accounts that do not require an additional phone number to set up. These accounts serve as an interface for code running somewhere on your server.
TG

Phone

Server

24

Telegram Bot: BotRf
‣ Start by installing Telegram on your smartphone (works on iOS, Android and Microsoft) or PC.
‣ Choose BotRf as a contact
25

Telegram Bot: BotRf
‣ There are three main commands: ‣ Freq: to change the frequency ‣ Site: to insert information about the sites (you need
at least two sites for a link!) ‣ Calc: to check if the sites are in line of sight ‣ Hlp will give you a help about all the commands.
26

Telegram Bot: BotRf
‣ Let’s start by setting the frequency to 5.8 Ghz
27

Telegram Bot: BotRf
‣ Now let’s create one site called mountain_1, with latitude -4.3409, latitude 55.7450 and antenna height 5 meters above the ground
28

Telegram Bot: BotRf
‣ You can find positions of sites using a GPS or by using this site:
‣ http://itouchmap.com/latlong.html
29

Telegram Bot: BotRf
‣ If you are using your smartphone, you can use it to get the position of the site
30

Telegram Bot: BotRf
31

Telegram Bot: BotRf
‣ Once you have two sites (let’s say they are called mountain_1 and mountain_2), you can check the profile between them with Calc
32

Telegram Bot: BotRf
33

Telegram Bot: BotRf
‣ Excercise ‣ Can you deploy an IoT link from Javeriana to
Monserrate at 900 MHz? ‣ How far are they? ‣ How high do you have to raise the antennas? ‣ Calculate the link budget using RE-Mote devices
34

