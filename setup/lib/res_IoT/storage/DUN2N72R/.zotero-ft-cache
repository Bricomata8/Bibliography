Software Deﬁned Radio Prototyping of 5G Radio Access Technology for VANET
Raﬁk Zitouni, Mattia Minelli raﬁk.zitouni@vedecom.fr , mattia.minelli@vedecom.fr
Research Report
ECE Paris – Graduate School of Engineering VEDECOM – Institut VEDECOM May 29, 2018

SOFTWARE DEFINED RADIO PROTOTYPING OF 5G RADIO ACCESS TECHNOLOGY FOR VANET
Raﬁk Zitouni, Mattia Minelli raﬁk.zitouni@vedecom.fr , mattia.minelli@vedecom.fr
Research Report – May 29, 2018 (23 pages)
Abstract: Channel capacity and radio resources management are critical issues for IEEE 802.11p VANET networks. Existing solutions are mainly focused on channel access, routing and PHYsical (PHY) layer separately, even if they are proved efﬁcient through simulations, they are far to consider real-world conditions. In this deliverable, we propose a candidate 5G Radio Access Technology (RAT) for VANET based on Non Orthogonal Multiple Access (NOMA) of a transmitter, and Signal Interference Cancellation (SIC) applied at a receiver. We prove that this solution allows to more than two users to share the same frequency at the same time. NOMA/SIC solution would be prototyped through Software Deﬁned Radio (SDR) which offers at the same time PHY reconﬁgurability and performing real-world tests. We consider software featuring of both: packet structure and Orthogonal Frequency Division Multiplexing (OFDM) encoding. However, the deliverable recount a number of IEEE 802.11p’s PHY speciﬁcations as transmission and reception chains. It presents NOMA/SIC prototyping of a Phase Shift Keying (PSK) and an IEEE 802.11p encoding on an SDR in simulation and over the air’ contexts. Preliminary results are promising, showing that the SDR is interoperable with Hardware devices. In addition, NOMA/SIC SDR is found functional under particular conditions. Key-words: IEEE 802.11p, VANET, Physical layer (PHY). Software Deﬁned Radio (SDR), 5G, Radio Access Technology (RAT), Non Orthogonal Multiple Access (NOMA), Signal Interference Cancellation (SIC), Orthogonal Frequency Division Multiplexing (OFDM), Phase Shift Keying (PSK)

SOFTWARE DEFINED RADIO PROTOTYPING OF 5G RADIO ACCESS TECHNOLOGY FOR VANET
R´esum´e : La capacite´ d’un canal et la gestion des ressources radio sont parmi les proble´matiques des re´seaux IEEE 802.11p VANET. Des solutions ont e´te´ propose´es exclusivement pour le routage ou pour l’acce`s au canal, meˆme si elles sont prouve´es efﬁcacent via simulation, elles restent loin de conside´rer les conditions re´elles de la radio. Dans ce livrable, nous proposons une technologie d’acce`s radio candidate pour la 5G au re´seau VANET. Il s’agit de l’acce`s multiple non orthogonal (NOMA) d’un e´metteur et l’e´vitement d’interfe´rences de signal (SIC) applique´ par l’e´metteur. Nous monterons que cette solution permet a` plus que deux e´metteurs de partager la meˆme fre´quence en meˆme temps. La solution NOMA/SIC est imple´mente´e via la Radio Logicielle (SDR) qui offre a` la fois la reconﬁgurabilite´ des spe´ciﬁcations et la re´alisation des tests re´els. Cependant, ce livrable retrace certaines spe´ciﬁcations de IEEE 802.11p avec les correspondantes chaines d’e´mission et de re´ception. Il pre´sente un prototypage NOMA/SIC pour un encodage nume´rique de de´calage de phase (PSK) et un IEEE 802.11p sur une radio logicielle (SDR) dans un contexte de simulation et de communication re´el. Les re´sultats pre´liminaires sont encourageants montrant que la SDR est interope´rable avec des cartes physique et NOMA/SIC SDR est teste´ et trouve´ fonctionnel sous certaines conditions.
Mots-cl´es : IEEE 802.11p, VANET, Physical layer (PHY). Software Deﬁned Radio (SDR), 5G, Radio Access Technology (RAT), Non Orthogonal Multiple Access (NOMA), Signal Interference Cancellation (SIC), Orthogonal Frequency Division Multiplexing (OFDM), Phase Shift Keying (PSK)

Software Deﬁned Radio prototyping of 5G Radio Access Technology for VANET

1

Contents

Glossary

4

1 From IEEE 802.11p to 5G

5

1.1 MAC sub-layer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5

1.2 PHY layer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6

1.3 Reconﬁguration and interoperability . . . . . . . . . . . . . . . . . . . . . . . . 7

2 NOMA and SIC

7

3 Software-Deﬁned Radio (SDR)

9

3.1 Advantages for vehicular communications . . . . . . . . . . . . . . . . . . . . . 9

3.2 SDR tool: USRP and GNU Radio . . . . . . . . . . . . . . . . . . . . . . . . . 10

4 SDR of IEEE 802.11p’s PHY

12

4.1 Interoprability between an OBU N201 and the Tx/Rxﬂow graphs . . . . . . . . 14

4.2 IEEE 802.11p encoding . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

5 SDR prototyping of NOMA/SIC

16

5.1 NOMA/SIC ﬂow graphs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17

5.1.1 NOMA/SIC of QPSK . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17

5.1.2 NOMA/SIC of 802.11p . . . . . . . . . . . . . . . . . . . . . . . . . . . 19

ECE Paris/VEDECOM

2

Raﬁk Zitouni, Mattia Minelli raﬁk.zitouni@vedecom.fr , mattia.minelli@vedecom.fr

List of Figures
1 Spectrum re-usage of NOMA . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8 2 Symbol constellation of NOMA applied for two QPSK encoder . . . . . . . . . 8 3 General Architecture of an SDR . . . . . . . . . . . . . . . . . . . . . . . . . . 10 4 USRP B210 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 5 Example of a ﬂow graph performing superposition of two MPSK transmitters
with gaussian noise channel in a loopback mode . . . . . . . . . . . . . . . . . . 12 6 Flow graph of transmitter (Tx) . . . . . . . . . . . . . . . . . . . . . . . . . . . 13 7 Parameters of OFDM sub carriers allocator . . . . . . . . . . . . . . . . . . . . 13 8 Structure of IEEE 802.11p frames . . . . . . . . . . . . . . . . . . . . . . . . . . 13 9 Packet format [1] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14 10 Flow graph of receiver (Rx) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14 11 Reduced Rx ﬂow graph . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14 12 GNU Radio Waterfall and PSD obtained of OBU packets transmission . . . . . 15 13 Packet Success Rate function of SNR for all IEEE 802.11p encoding . . . . . . 16 14 Use case of downlink NOMA for vehicular network . . . . . . . . . . . . . . . . 16 15 NOMA and simpliﬁed SIC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17 16 NOMA and SIC simulation Flow graphs . . . . . . . . . . . . . . . . . . . . . . 18 17 GUI of NOMA ﬂow graph . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19 18 Real world NOMA ﬂow graph of two QPSK transmitters . . . . . . . . . . . . 19 19 Real world SIC ﬂow graph of QPSK’s superposition . . . . . . . . . . . . . . . 20 20 Real world NOMA ﬂow graph . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20

ECE Paris/VEDECOM

Software Deﬁned Radio prototyping of 5G Radio Access Technology for VANET

3

List of Tables
1 Values of 802.11p parameters for the traﬃc classes deﬁned in [2] (slot time = 13 µs). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
2 Comparison of EEE 802.11p and IEEE 802.11a PHY’ speciﬁcations . . . . . . . 7 3 SDR boards and their performances . . . . . . . . . . . . . . . . . . . . . . . . 11

ECE Paris/VEDECOM

4

Raﬁk Zitouni, Mattia Minelli raﬁk.zitouni@vedecom.fr , mattia.minelli@vedecom.fr

Glossary
GPP General Purpose Processor . 11 PCIe Peripheral Component Interconnect express. 11 QoS Quality of Service. 7 SDR Software Deﬁned Radio. 2, 7, 10

ECE Paris/VEDECOM

Software Deﬁned Radio prototyping of 5G Radio Access Technology for VANET

5

1 From IEEE 802.11p to 5G
• New vehicular networks applications would emerge with 5G mobile communication systems. The fully autonomous and smart vehicles need reliable and reconﬁgurable vehicleto-everything communications. Such a requirement is related to the data rate, the latency and network availability. The current norms of vehicular ad-hoc network (ITS-G5 and DSRC) are based on IEEE 802.11p standard [1], which answer partly to these requirements. The 802.11p’s PHY and MAC are de-facto layers of Vehicular Ad-hoc Networks (VANETs). It is IEEE 802.11a or WiFi adapted to the context of a distributed and mobile vehicular network. The data rate and delay are related to these layers speciﬁcations. Thus, the next paragraph highlights some of 802.11p drawbacks and motivates 5G paradigm solutions.
1.1 MAC sub-layer
The performances of MAC sub-layer have been intensively evaluated [3], since this standard is an adaptation of the IEEE 802.11a (WiFi). For example, in VEDECOM institute, performed studies have showed that the Round Trip Time (RTT) could be greater than 140 ms. In the case of road safety applications, the RTT has to be as shorter as possible. The authors in [4] found that the packet error rate is vulnerable to the channel estimation. In addition, the network has been found inable to prevent channel congestion because the number of channels is limited with a distributed frequency resources management [5]. The channel sharing coordination is ensured through Carrier Sense Multiple Access with Collision Avoidance (CSMA/CA) and Decentralized Congestion Control (DCC). A vehicle must listen to the channel to assess whether it is busy, before transmitting. There are two ways to assess whether the radio channel is busy, at a given time instant:
• The channel is physically busy, i.e., an ongoing transmission is sensed by the receiver vehicle.
• The channel is virtually busy, i.e., a previuosly transmitting vehicle has broadcasted a Network Allocation Vector (NAV), containing information about the time period during which the channel is reserved to its transmissions. Other vehicles cannot transmit during the time period that has been reserved via the NAV.
The MAC algorithm transmits data frames or occupy a channel according to Arbitra- tion InterFrame Spacing (AIFS) periods and Contention Windows (CWs). Here we enumerate the steps of this algorithm:
• When a data packet arrives in the transmit buﬀer, the vehicle must ﬁrst wait for an Arbitration InterFrame Spacing (AIFS) before sending it.
• If the channel is free (both physicaly and virtually) during the whole duration of the AIFS, then the transmission can take place.
• If, instead, the channel is busy (or gets busy during the AIFS) the transmission will be delayed of a backoﬀ time tb. The backoﬀ time, which is measured in time slots, is a random variable uniformly chosen between 0 and CW, where CWmin < CW < CWmax. This operation is called a backoﬀ procedure.
• When a backoﬀ procedure is invoked for the ﬁrst time (for a given data packet), CW = C Wmin .
• A vehicle that has invoked a backoﬀ procedure must wait for a time tb before transmitting. However, if the vehicle senses a virtual or physical transmission on the channel, the timer tb is stopped for the whole duration of the sensed transmission, plus an AIFS.
ECE Paris/VEDECOM

6

Raﬁk Zitouni, Mattia Minelli raﬁk.zitouni@vedecom.fr , mattia.minelli@vedecom.fr

Traﬃc priority index 1

CWmin [slot time] 3

CWmax [slot time] 7

AIFS [µs] 58

2

7

15

71

3

15

1023

110

4

15

1023

149

Table 1: Values of 802.11p parameters for the traﬃc classes deﬁned in [2] (slot time = 13 µs).

• When tb expires, the vehicle senses the channel. If the channel is free, the vehicle transmits its packet immediately. If the channel is busy, the station invokes another backoﬀ procedure, and a new value of tb is drawn (without changing CW).
• If a vehicle sends a packet, but receives no ACK, then it will assume that the packet has not been received. If this is the case, a backoﬀ procedure is invoked, CW is doubled and a new tb is drawn. When this new tb expires, a retransmission attempt is made. In the case of broadcast traﬃc (e.g., CAM or DENM), no ACK is expected to be received for the packets that are sent. Hence, in this case CW never doubles.
The ETSI [2] deﬁnes four traﬃc priority classes with diﬀerent values of AIFS, CWmin and CWmax (see Table 1), so as to increase the chances of a prompt channel access for urgent data packets. Although the MAC mechanism consider traﬃc priorities and the backoﬀ procedure, the channel congestion cannot be avoided, particularly with high number of vehicles with a broadcast communication [5]. Hence, it is interesting to explore PHY layer solutions.
1.2 PHY layer
Orthogonal Frequency Division Multiplexing (OFDM) is PHY layer scheem. It oﬀers a moderate doppler and channel multipath eﬀects. In Europe, V2X communications have been allocated 5 contiguous radio channels of 10 MHz each in the 5.9 GHz band (also called ITS band) [6] [2]. Theoretically, the data rate is deﬁned to be up to 27 Mb/s for 10 MHz, depending on the used modulation/encodiung mode. It has been found that the transmission delay is relatively short, around 0.3 ms to braodcast 400 bytes [7], i.e. transmit CAM messages. Of course this delay is short without including other operations such us, MAC coordination and frame queue management. PHY consists of Physical Medium Dependent (PMD) sub-layer and Physical Layer Convergence Protocol (PLCP). The PMD sublayer speciﬁes signal build up parameters, such as modulation and channel coding and convert signal into analog form. PLCP ensures that the MAC layers receive packets of common format despite diﬀerences among various PMD sublayers. Table 2 shows the main diﬀerences between the speciﬁcations of two variants a and p of 802.11.
OFDM is an Orthogonal Multiple Access (OMA) without a frequency reuse since each sub-carrier is allocated to only one modulation mode and for only two vehicles. Our objective is to ﬁnd a technique able to increase the frequency eﬃciency (b/s/Hz) of the current standard. 5G paradigm would increase the channel capacity by adopting new Radio Access Technologies (RATs). For example, Non Orthogonal Multiple Access (NOMA) is a candidate since it promises the frequency reuse. It allows to more than two users at the same time to share the same frequency [8] [9]. In a cellular network a base station can superpose two signals and receivers performs Signal Interference Cancellation (SIC) to extract them. NOMA and SIC propose a frequency reuse and improve tradeoﬀ between system eﬃciency and user fairness compared to the IEEE 802.11p radio access, which is an OMA scheme. Therefore, these techniques increase the network’s throughput (or frequency eﬃciency).
ECE Paris/VEDECOM

Software Deﬁned Radio prototyping of 5G Radio Access Technology for VANET

7

Parameters

IEEE 802.11a

IEEE 802.11p

Changes

Bit rate (Mb/s)

6; 9; 12; 18; 24; 36; 48; 54

3; 4:5; 6; 9; 12; 18; 24; 27

Half

Modulation Code rate Number of subcarriers

BPSK, QPSK, 16QAM, 64QAM 123 ;; 234 52

BPSK, QPSK, 16QAM, 64QAM 123 ;; 234 52

No change No change No change

Symbol duration

4 µs

8 µs

Double

Guard time

0.8 µs

1.6 µs

Double

FFT period

3.2 µs

6.4 µs

Double

Preamble duration

16 µs

32 µs

Double

Subcarrier spacing

0.3125 MHz

0.15625 MHz

Half

Channel or carrier frequency

20 MHz

10 MHz

Half

Table 2: Comparison of EEE 802.11p and IEEE 802.11a PHY’ speciﬁcations

1.3 Reconﬁguration and interoperability
IEEE 802.11p network reliability is only related to its resources availability despite the existence of other alternatives for connectivity such as 3GPP and LTE. The vehicular network need to be virtualized in order to ensure the interoperability between these technologies [10]. The software deﬁned networking would be one of major contributions of 5G paradigm. Deﬁne protocols’ stack in software brings more possibilities to customize applications. The objective is to separate between control and data planes and manage by software several network technologies considering applications’ requirements change. The Software Communication Architecture (SCA) has been designed several years ago [11] to facilitate waveform portability and reusability. This architecture propose a Software-Deﬁned Radio (SDR) which is a virtual or software implementation of the network’s PHY layer [12]. (see Section 3 for more details). In addition, the cross layer concept has been also introduced to obtain a soft separation between OSI model layers. The objective of cross layer and software deﬁnition is to optimize network parameters in order to improve the Quality of Service (QoS) [13], such as adapting waveform, power control, etc. If all or part of radio functions are deﬁned in software independently of hardware, PHY layer could be considered virtual. For example, dedicated frequency bands and radio access technology can be customized to improve spectrum eﬃciency. Therefore, we would be able to increase the availability of frequency resources by their ﬂexible usage. In addition, Software deﬁnition gives a possibility to prototype, test and improve existing functions. Section 3 gives more details about SDR and its advantages in the vehicular context.
In this deliverable we take care of two things at the same time: the NOMA/SIC RAT and SDR. However, the objective of this deliverable is to show you strengths of the NOMA solution and its SDR prototyping for VANET.
2 NOMA and SIC
NOMA and SIC have been intensively studied in the context of cellular networks [8] [14] [15]. The NOMA is the superposition of signals at the transmitter while the SIC is the reverse operation of extracting these signals at the receiver.

ECE Paris/VEDECOM

8

Raﬁk Zitouni, Mattia Minelli raﬁk.zitouni@vedecom.fr , mattia.minelli@vedecom.fr

In the case of NOMA downlink, the base station reuse a frequency through a superposition of signals. Figure 1 shows one base station and two users Rx1 and Rx2. The base station generates two signals s1 and s2 and amplify them by an output powers p1 and p2, respectively. Obviously, the two signals are transmitted using the same frequency. The received signal is represented as yi = hix + ωi, where hi is the complex channel coeﬃcient between nodes i, and ωi denotes the received Gaussian noise including inter-vehicles interference. The power spectral densities or ωi for each node i is N0,i.
Rx1
h1

p2 f p1

NOMA

h2
Rx2
Base station
f

Figure 1: Spectrum re-usage of NOMA

We consider three nodes and a single transmitter and receiver antenna. We assume that

the overall bandwidth is one Hz (B = 1Hz). One of the three nodes transmits signals si for node i (i= 1, 2), with an output power pi. The sum of the two signals is x represented by:

x

=

√ p1s1

+

√ p2s2

(1)

The two receivers Rx1 and Rx2 decode two signals in two steps. In the ﬁrst step, the receiver decodes s1, treating s2 as Gaussian interference. After decoding s1, the second step is to subtract the s1 from the received signal and obtain s2. In this case, the SIC is the subtract operation used to extract s2. In our example, only the Rx1 applies the SIC approach. It starts by decoding the signal with the highest output power and after that it extracts its appropriate signal. The receiver Rx2 would be able to decode signals without SIC. We limit our presentation to the beneﬁt of NOMA Downlink advantages. NOMA uplink is detailed in [8].
The spectrum eﬃciency (b/s/Hz) can be multiplied by 2, in the case of two superposed Quadrature Phase Shift Keying (QPSK) encoder. Figure 2 shows the obtained symbol constellation after a superposition. Quadrature Amplitude Modulation 16QAM is the result of the superposition. A proof of concept has been implemented on SDR, it is presented in Section 5.1.1.

+

=

QPSK

QPSK

16QAM

Figure 2: Symbol constellation of NOMA applied for two QPSK encoder

Downlink NOMA superposition improves the channel capacity or spectrum eﬃciency. If we consider the Shannon–Hartley theorem, we have for each node i the capacity CRxi equal to:

ECE Paris/VEDECOM

Software Deﬁned Radio prototyping of 5G Radio Access Technology for VANET

9



 CRx1

=

log2(1

+

p1|h1|2 ) N0,1

(2)

 CRx2

=

log2(1

+

p2|h2|2 p1|h1|2 + N0,2

)

In the current Orthogonal Multiple Access (OMA), the bandwidth is shared by all nodes i. We consider β Hz for node Rx1 and (1 − β) Hz for Rx2, where 0 ≤ β ≤ 1Hz, so, we obtain:



 CRx1

=

β

log2(1

+

p1|h1|2 ) βN0,1

(3)

 CRx2

=

(1

−

β) log2(1

+

p2|h2|2 p1|h1|2 + (1 −

β)N0,2 )

If we compare the terms of equations (3) and (2), we can see that the NOMA’s capacity (or throughput) is better than that of OMA scheme. In section 5.1.1, we show some simulation results of NOMA and SIC implementation on an SDR.

3 Software-Deﬁned Radio (SDR)
When we develop a new solution for networking, one question that we ask is ”How can we test our research models and techniques in real-world over-the-air conditions?”. This desire joins the objective to implement hardware deﬁnitions of transceivers in software for more reconﬁgurability. The concept of Software Radio (SR) has been formulated by J.Mitola in [16]. It is a set of technologies for deﬁning radio transceiver parameters and functions in software, including carrier frequency, modulation bandwidth and frequency/space/time/code agility. The objective is to substitute circuitry signal processing chains by software processing blocks.
Figure 3 shows the three main layers of an SDR solution, starting from the Radio Frequency (RF) Front End (FE) until software baseband processing of waveforms which receives or transmits a signal (waveform) passing through Intermediate Frequency (IF) section. The latter is inevitably introduced since the processing capabilities of an Analog to Digital Converters (ADC) are slower than the Software-Deﬁned Radio (SDR) function expectations. The IF section, i.e. Mixer, Filter .etc, selects a bandwidth and shifts it from higher/lower frequency to an expected one for both ADC and DAC. The second layer is the ADC and Digital to Analog Converter (DAC). They are respectively at the closest proximity to antennas of transmitter and receiver chains. In the last part, the baseband processing replaces analog functionalities by digital ones. Programmable-processing technologies perform this function using, for example, General Purpose Processor (GPP), a Field Programmable Gate Array (FPGA), Digital Signal Processor (DSP), Graphical Processing Unit (GPU), etc. Note that these hardware devices could be combined in order to accelerate the baseband processing. This architecture has a number of advantages such as ﬂexibility, iteroperability and portability of waveforms. Other advantages could be included if we consider each node of a vehicle network as an SDR.
3.1 Advantages for vehicular communications
An SDR is not only a ﬂexible deﬁnition of a network’s physical layer, it is a real world representation of wireless communications. The simulation model of PHY layer are limited to their domain or context. It is diﬃcult to switch from simulations to experiments and validate test ﬁndings. Hence, dealing with problems using realistic tools would reduce relatively the time to market of a designed solution.

ECE Paris/VEDECOM

10 Raﬁk Zitouni, Mattia Minelli raﬁk.zitouni@vedecom.fr , mattia.minelli@vedecom.fr

ADC

Antenna Front End
Intermediate Frequency(IF)
DAC

Baseband Software processing
Figure 3: General Architecture of an SDR
Software-Deﬁned Vehicular Ad-Hoc NETwork (SD-VANET) or SDR for VANET is the concept in which we consider each vehicule as an SDR. In the literature, two related works could be considered as a reference, they are published in [17] and [18]. The authors in [17] have proposed a multi-technology vehicular cooperative system in order to develop a multi-standard platform able to ensure the interoperability between diﬀerent standards such as IEEE 802.11, 3GPP LTE and Digital Video Broadcasting (DVB). The proposed solution has been integrated to the open source hardware/SDR OpenAirInterfacce [19]. The platform deﬁnes three layers: user, drivers and hardware. Each driver corresponds to a technology’s standard. The layer of drivers allows the user to change easily between standards or to use two at the same time, i.e. IEEE 802/11p and 3GPP LTE. However, the ﬂexibility of the SDR consider only the drivers of technologies without changing the PHY layer parameters such as waveform or Radio Access Technology (RAT). Moreover, the technologies’ drivers represents rigid implementations of standard’s speciﬁcations.
B. Bloessl et .al [18] have recently gathered the results of performance assessment of IEEE 802.11p prototype on an open source SDR. The speciﬁcations of the PHY layer have been implemented in high level programming languages, i.e. Python and C++, and executed on Personal Computer (PC) or General Purpose Processor (GPP). The advantage of the PC based prototyping is the time to program given speciﬁcations. Compared to an FPGA based SDR, designer could rapidly build his communication chains from the baseband step to the frame processing and viceversa. Furthermore, it is possible to switch easily from simulation to experiment as in GNU Radio framework [20]. For example, in [21], [22] the authors have performed a study and propose a new channel estimators. The drawback of a high level programming remains the processing time or the delay of signal processing programs. Consequently, If the MAC protocols are deﬁned with time-critical, an FPGA-based SDR is suitable since it ensures a low latency processing of waveforms.
3.2 SDR tool: USRP and GNU Radio
Universal Software Radio Peripheral (USRP) is hardware front end radio of an SDR. It is developped by Ettus Research [23] which is now a part of National Instruments. Other concurrent solutions have been developed with diﬀerent capabilities such as WARP Radio [24], NUTAQ systems [25] and LimeSDR [26]. Mainly these solutions interact with General Purpose Processor (GPP) to perform software processing of baseband waveforms. Ettus’s boards have been found with high performance as shown in the recent comparative Table 3.

ECE Paris/VEDECOM

Software Deﬁned Radio prototyping of 5G Radio Access Technology for VANET

11

Bus series (Ettus)
Networked series (Ettus) Embedded series (Ettus) X series (Ettus) LimeSDR
WARP Radio

Name

Central frequency fc

Baseband band- Host Connection width (MHz)

USRP 1

Deﬁned by daughter boards placed in 2 slots (e.g. SBX daugther board cover 400MHz - 4GHz)

8 MHz

USB 2.0

USRP B200 70MHz - 6GHz with MIMO 50 MHz

and B210

capabilities

sUSB 3.0

USRP N200 Deﬁned by daughter boards 50 MHz

and N210

placed in 1 slot

GigaBit Ethernet

USRP E313, 70MHz - 6GHz E312 and E310

Up to 56 MHz

Embedded interconnection

USRP X300 Deﬁned by daughter boards Up to 160 MHz

and X310

placed in 2 slots

PCIe, dual 10 GigE, dual 1 GigE

LimeSDR-USB 100 kHz – 3.8 GHz

Up to 80 MHz

USB 3.0

LimeSDR-PCI 70MHz - 6GHz with MIMO 50 MHz capabilities

PCIe

WARP Radio 2.4 GHz - 5GHz V3

40 MHz

Z Gigabit Ethernet

Table 3: SDR boards and their performances

In our tests and prototyping we have used USRP B210 (see Figure 4) since it covers the central frequencies of the ITS-G5 in the frequency band 5.9 GHz. In addition, the baseband bandwidth of 50 MHz incorporates ITS-G5 channels of 5 MHz, 10 MHz and 20 MHz. As shown in Table 3, this board is able to cover simultaneously a bandwidth of 5 channels of IEEE 802.11p (or 50MHz) if the SDR runs on powerful processor and with large memory size. It uses both signal chains of the AD9361 [27], providing coherent Multiple Input Multiple Output (MIMO) capability. Onboard signal processing and control of the AD9361 is performed by a Spartan6 XC6SLX150 Field Programmable Gate Array (FPGA) connected to a host PC using SuperSpeed USB 3.0.

Figure 4: USRP B210
USRP boards could be driven by GNU Radio [20], which is an open-source project toolkit for building software radios that run on (GPP) (or PC). GNU Radio is used with external RF hardware to create an SDR, i.e. USRP, or without hardware to simulate radio communications (or loopback simulations). Furthermore, the GNU Radio can be supported by Windows, Linux and Mac OS and currently Android with limited usage. The Graphical User Interface (GUI) of GNU Radio is close to Mitola’s concept, since it provides signal processing blocks for modulation, demodulation, ﬁltering and various data processing operations. New blocks could
ECE Paris/VEDECOM

12 Raﬁk Zitouni, Mattia Minelli raﬁk.zitouni@vedecom.fr , mattia.minelli@vedecom.fr
be easily added to the toolkit.Flow graphs or software radio programs are the result of connecting these blocks (see Figure 5. The blocks are developed in C++ or Python programming languages.
Figure 5: Example of a ﬂow graph performing superposition of two MPSK transmitters with gaussian noise channel in a loopback mode
4 SDR of IEEE 802.11p’s PHY
The authors in [28] have been the ﬁrst to perform an implementation of IEEE 802.11p PHY layer on SDR. Recently, in [18] modiﬁcations have been included such as channel estimation and performance assessment of the implementation compared to the oﬀ-the-shelf boards (Cohda boards). In this section, we present brieﬂy PHY layer communication chains.
Figures 6 and 10 show the ﬂow graphs of transmitter (Tx) and receiver (Rx), respectively. As we have seen in Section 3.2, throughout a ﬂow graph’s blocks, data stream are exchanged from a source into a sink and vice versa.
The main function of the transmitter is the frames encoding and OFDM multiplexing. The transmitter’s ﬂow graph (see Figure 6) starts by a message generator or Packet Data Units (PDUs) source. It generates data messages periodically each 300 ms, for example, ”mmmm” text. The second block is WiFi MAC which adds MAC address ﬁeld with source, destination and access point addresses to the PDUs. Then, the WiFi Mapper selects the encoding modulation among speciﬁed ones, i.e. BPSK, QPSK, 16 QAM and 64 QAM. Two branches (trunks) come out from the Mapper, the ﬁrst one is the BPSK modulator of the PDU header generator with symbol constellation (-1, 1), and the second one with chunks to symbols of selected data encoding. The stream of two branches meet up at the Tagged Stream Mux block to be tagged with ”packet len”. OFDM Carrier Allocator creates the sub carriers with parameters shown in Figure 7. The OFDM uses 64 sub carriers which corresponds to an FFT with a size equal to 64. 48 sub carriers contains data and 4 sub carriers are pilots and 12 are zero-sub carriers amongst the complex values. Pilot subcarriers transmit a ﬁxed pattern used to reduce frequency and phase oﬀset at the receiver side. The vector (-21, -7, 7, 21) gives the positions of these pilot sub carriers. Pilot symbols and Synchronization words are deﬁned in the standard [1] and explained by the authors in [29]. Of course, an Inverse FFT (IFFT) is applied to transform mapped data vectors to complex stream in the time domain. The cyclic preﬁx block adds cyclic preﬁx which is a copy of Fourier transformed waveform corresponding to the last 16 samples of OFDM symbol. Figure 8 shows the frame structure with a preamble composed out of ten repetitions of short training sequence and two repetitions of a long training sequence, preceded by Guard Interval (GI) (Figure 9 shows a review of all
ECE Paris/VEDECOM

Software Deﬁned Radio prototyping of 5G Radio Access Technology for VANET

13

packet ﬁelds). This preamble allows a receiver to synchronize and detect the beginning of packets. After cyclic preﬁxer, the signal is ampliﬁed and after that sent through UHD:USRP Sink. The physical parameters such as frequency, sample rate and gain are ﬁxed as deﬁned by standard speciﬁcations, and could be changed via graphical user interface. For more details, you can see these references [28], [30], [29] and [18].

Figure 6: Flow graph of transmitter (Tx)

Figure 7: Parameters of OFDM sub carriers allocator

t1 t2 t3 t4 t5 t6 t7 t8 t9 t10 GI2 T1

T2

GI Header GI Data GI Data

Short training sequence Long training sequence Signal ﬁeld

10 1,6 = 16

2 8 = 16

8

Data symbols

Figure 8: Structure of IEEE 802.11p frames

The receiver (Rx) needs to be eﬃcient without over sampling when decoding packets. As we can see in Figure 10, the Rx’s ﬂow graph includes more blocks compared to the Tx. Its ﬂow graph could be reduced by the schema shown in Figure 11. It starts by separating the preamble and the signal ﬁeld from payloads. Then, cyclic preﬁx, pilots and frequency guard band are removed from each OFDM symbol. The stream to vector is applied as Serial-to-Parallel (S/P) converter, it divides received signal into blocks of 64 items. The result is demodulated using an FFT algorithm before an equalization and a channel estimation. MAC decoder is the last operation before extracting data frames and calculate the error frames. The references [28], [30], [29] and [18] give theoretical details of equalization and channel estimation models of IEEE 802.11p.

ECE Paris/VEDECOM

14 Raﬁk Zitouni, Mattia Minelli raﬁk.zitouni@vedecom.fr , mattia.minelli@vedecom.fr Figure 9: Packet format [1]

USRP Source

Figure 10: Flow graph of receiver (Rx)

Detect Frames

OFDM Synchronization

Stream to Vector

MAC Decoder

Calculate Frame Error

Figure 11: Reduced Rx ﬂow graph

4.1 Interoprability between an OBU N201 and the Tx/Rxﬂow graphs
Interoperability tests have been ensured through packet exchanges between UNEX boards (OBU N201) and SDR’s ﬂow graphs. We received successively generated packets of OBU UNEX transmitter using GNU Radio Rx ﬂow graph. The same has been obtained when we transmit packets from Tx ﬂow graph, the OBU N210 decoded our generated packets.
Figure 12 shows a digital spectrum analyzer of CAM messages’ transmission. Two OBU transmit on two channels: the ﬁrst one is the control channel 5890 MHz and the second one is a service channel 5880 MHz. A ﬂow graph has been customized to play a digital spectrum analyzer and sense a frequency bandwidth of 40 MHz. Note that only one antenna has been connected to the USRP. As you can see in Figure 12, the sampling rate has been ﬁxed equal

ECE Paris/VEDECOM

Software Deﬁned Radio prototyping of 5G Radio Access Technology for VANET

15

to 40 MHz. We can see that the energy received in the two channels have a same Power Spectrum Density (PSD).

Figure 12: GNU Radio Waterfall and PSD obtained of OBU packets transmission
4.2 IEEE 802.11p encoding
Only simulations have been performed to measure network performances. Experiments results could be obtained with more human and time resources. In our simulations, the number of packets and their lengths are both initialized equal to 100 packets and 150 bytes, respectively. For 5 repetitions of simulations, the output power has been changed for each encoding allowing us to measure the mean of Packet Error Rate (PER) or Packet Success Rate (PSR). Diﬀerent IEEE 802.11p’s encoding schemes are BPSK 1/2, BPSK 3/4, QPSK 3/4, 16-QAM 1/2, 64QAM 2/3 and 64-QAM 3/4.
The obtained curves agree with the expected theoretical correlation between PSR and encoding, except with BPSK 3/4 which has been found bounded up to 80% even if the SNR was given higher. Of course, the 64-QAM 3/4 encoding is with the lowest PSR, but with highest data rate (27 Mb/s), where the number of bits per sub carrier is equal to 6 and 288 bits per OFDM symbol. Considering the obtained results, we would use at most QPSK encoding for our NOMA/SIC scheme.
ECE Paris/VEDECOM

16 Raﬁk Zitouni, Mattia Minelli raﬁk.zitouni@vedecom.fr , mattia.minelli@vedecom.fr

Figure 13: Packet Success Rate function of SNR for all IEEE 802.11p encoding
5 SDR prototyping of NOMA/SIC
For simplicity, we consider the use case shown in Figure 14. We have three vehicles and a single transmitter and receiver antenna. The transmitter reuse a central frequency through a superposition of two signals (s1, s2) (two Quadrature Phase Shift Keying (QPSK)). The receivers extract each one as shown in Figure 15. The diﬀerence between the output power of transmitted signals allows a receiver to separate them with SIC. A receiver Rx1 applies a SIC to extract two received signals (s1, s2). The receiver Rx2 would be able to decode signals without SIC. We consider downlink NOMA as introduced in Section 2.

Figure 14: Use case of downlink NOMA for vehicular network

We assume that the overall bandwidth is one Hz (B = 1Hz). One of the three vehicles

transmits signals si for vehicle i (i= 1, 2), with an output power pi. The sum of the two

signals is x represented by:

x

=

√ p1s1

+

√ p2s2

(4)

In the case of a Quadrature Phase Shift Keying (QPSK) encoder, we can obtain the symbol constellations shown in Figure 2 of Section ??. Quadrature Amplitude Modulation 16 QAM is obtained after superposition doubling data rate. A proof of concept has been implemented on GNU Radio with Diﬀerential QPSK modulation/demodulation (see Section 5.1.1)

ECE Paris/VEDECOM

Software Deﬁned Radio prototyping of 5G Radio Access Technology for VANET

17

s1+s2+noise
-
s1+noise

Decode s2

s2

Decode s1

P2 s1 f P1

Signal s1

SIC

NOMA

Figure 15: NOMA and simpliﬁed SIC

5.1 NOMA/SIC ﬂow graphs
Before the prototyping of NOMA/SIC for IEEE 802.11p, we choose to implement NOMA/SIC with a simple DQPSK. Next section presents corresponding ﬂow graphs and obtained results.

5.1.1 NOMA/SIC of QPSK Two types of ﬂow graphs have been implemented: simulation and real-world ﬂow graphs.

Simulation: We started by simulating ﬂow graphs since they are relatively simple to build

compared to real world experiments. Figure 16 shows the simulation of NOMA and SIC of

DQPSK or DQPSK Tx and Rx. Two transmitter chains generate a random vectors of bits (00,

01, by

√10 α

and 11). through

The QPSK constellation is applied and after that each symbol Multiply Const blocks. Since we have only two transmitters, the

is ampliﬁed relationship

between

two

output

powers

is

α

=

p1 p

,

0

≤

α

≤

1,

where

p1

is

the

ampliﬁer

of

one

transmitter

and p = p1 + p2. The value of α could be introduced through gnuradio com√panion √GUI or

after the ﬂow graph execution. Multiply Const blocks are conﬁgured through α and 1 − α

for up and down transmitter’s gain, respectively. The channel is considered with Gaussian

−SN R(dB)
noise input equal to 10 10 (dB).

The receiver has to separate symbol by symbol the received stream via Signal Interference

Cancellation (SIC). It decodes the stream with a receiver chain since one stream is received

with a greater output power and considering the second stream as a noise. The second is

obtained after subtraction between decoded and new received symbols. The Bit Error Rate

(BER) has to be calculated to evaluate the quality of SIC decoding. As we can see in Figure

16, with α = 0.09, the receiver obtains a lower BER for the two streams (around 10−3).

Obviously, without SIC, the receiver decodes only one stream, the second stream is considered

as a noise. The curves showing this result would be drawn later in a technical paper. You can

see that the result of superposition is a 16 QAM.

Real world: Figure 19 shows a real world ﬂow graph of NOMA superposition using Differential QPSK transmitters. In the real world communication, the receiver and transmitter connect their ﬂow graphs to an USRP source and sink, respectively. In addition, the receiver and transmitter have to be synchronized since they don’t share the same clock. We generate two parallel data streams or vectors, and we apply ﬁlters on each one. In our case, the ﬂow graph generates bits ”1”, but it applies a scrambling sequences of ”0” and ”1”, then it ﬁlters the waveform through a root raised cosine with a polyphase arbitrary resampler in order to minimize inter symbol interferences. The Add block superposes the two generated waveforms.
The receiver is more complicated than the transmitter. It includes the frequency, phase and clock synchronizations with decoding and calculating the Bit Error Rate (BER). Figure 19 shows the receiver’s ﬂow graph integrating the SIC function which was found functional for a superposition of two BPSK streams but not for QPSK streams. The latter would give a 16

ECE Paris/VEDECOM

18 Raﬁk Zitouni, Mattia Minelli raﬁk.zitouni@vedecom.fr , mattia.minelli@vedecom.fr

Figure 16: NOMA and SIC simulation Flow graphs

QAM constellation, but because the actual Costas Loop block is limited to PSK modulation,

we were limited to only BPSK. We would improve or develop a new phase synchronizer in order

to locate symbols positions. The actual Costas loop is a phase-only correction mechanism, but

16

QAM

shall

calculate

12

diﬀerent

phases.

The

angles

1 4

π,

3 4

π,

5 4

π

and

5 4

π

are

twice

as

likely

to occur than any of the other 8 phases (simply because there’s two constellation points on

each of these phases, versus one for the rest). Therefore, we might want to adjust our decision

regions for a self-built Phase Error Detector (PED) accordingly. It is not inherently impossible

to correct phase of a QAM reception using the actual block but we need a synchronization

preamble.

ECE Paris/VEDECOM

Software Deﬁned Radio prototyping of 5G Radio Access Technology for VANET

19

Figure 17: GUI of NOMA ﬂow graph
Figure 18: Real world NOMA ﬂow graph of two QPSK transmitters 5.1.2 NOMA/SIC of 802.11p Figure 20 shows a proposed NOMA ﬂow graph of IEEE 802.11p transmitter with two superposed chains generating messages via Message Strobe blocks. The ﬁrst trunk carries ”mmmmm” text message and the second one ”xxxxx” message. They are parallel with same functions before transforming the complex stream into vectors which are the input of an IFFT, i.e. OFDM Carrier Allocator block. Note that each packet stream has its own header which is always generated through a√BPSK modulator. As we have seen in Section 5.1.1, the α variable controls the ampliﬁer α and (1 − α) under Multiply Const block. The two chains meet at Add block and after that other blocks as presented in Section 4, are applied to the two streams. We tested this NOMA transmitter with one receiver and we were able to receive the two text messages. Of course, the receiver was found able to decode one text message if its generator trunk had higher ampliﬁed its signal.
SIC receiver would be more complicated to implement particularly with OFDM receiver. For each sub carrier the receiver has to separate two data streams. At the moment of drafting this deliverable, we don’t have a real world implementation of IEEE 802.11p’s SIC receiver.
ECE Paris/VEDECOM

20 Raﬁk Zitouni, Mattia Minelli raﬁk.zitouni@vedecom.fr , mattia.minelli@vedecom.fr
Figure 19: Real world SIC ﬂow graph of QPSK’s superposition
Figure 20: Real world NOMA ﬂow graph ECE Paris/VEDECOM

Software Deﬁned Radio prototyping of 5G Radio Access Technology for VANET

21

References
[1] I. C. Society, Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Speciﬁcations. IEEE Computer Society, 2012.
[2] ETSI, Intelligent Transport Systems (ITS); Access layer speciﬁcation for Intelligent Transport Systems operating in the 5 GHz frequency band, vol. 0. 2013.
[3] L. Miao, K. Djouani, B. J. Van Wyk, and Y. Hamam, “Performance evaluation of IEEE 802.11p MAC protocol in VANETs safety applications,” in IEEE Wireless Communications and Networking Conference, WCNC, pp. 1663–1668, 2013.
[4] I. Ivan, P. Besnier, M. Crussi`ere, M. Drissi, L. L. Danvic, M. Huard, and E. Lardjane, “Physical layer performance analysis of V2V communications in high velocity context,” in 2009 9th International Conference on Intelligent Transport Systems Telecommunications, ITST 2009, pp. 409–414, 2009.
[5] C. Campolo, A. Molinaro, and R. Scopigno, Vehicular ad hoc networks : standards, solutions, and research. 2015.
[6] “Compatibility studies between intelligent transport systems (its) in the band 5855– 5925 mhz and other systems in adjacent bands.” Available at http://www.erodocdb.dk/Docs/ doc98/official/pdf/ECCREP228.PDF.
[7] F. Klingler, F. Dressler, and C. Sommer, “IEEE 802.11p unicast considered harmful,” in IEEE Vehicular Networking Conference, VNC, vol. 2016-January, pp. 76–83, 2016.
[8] K. Higuchi and A. Benjebbour, “Non-orthogonal Multiple Access (NOMA) with Successive Interference Cancellation for Future Radio Access,” IEICE Transactions on Communications, vol. E98.B, no. 3, pp. 403–414, 2015.
[9] H. Nikopour and H. Baligh, “Sparse code multiple access,” in 2013 IEEE 24th Annual International Symposium on Personal, Indoor, and Mobile Radio Communications (PIMRC), pp. 332–336, IEEE, sep 2013.
[10] C.-F. Lai, Y.-C. Chang, H.-C. Chao, M. S. Hossain, and A. Ghoneim, “A Buﬀer-Aware QoS Streaming Approach for SDN-Enabled 5G Vehicular Networks,” IEEE Communications Magazine, vol. 55, no. 8, pp. 68–73, 2017.
[11] “JTRS project.” Available at http://www.doncio.navy.mil/chips/ArticleDetails. aspx?ID=4344.
[12] A. M. Wyglinski, D. P. Oroﬁno, M. N. Ettus, and T. W. Rondeau, “Revolutionizing software deﬁned radio: case studies in hardware, software, and education,” IEEE Communications Magazine, vol. 54, pp. 68–75, jan 2016.
[13] S. Shabdanov, P. Mitran, and C. Rosenberg, “Cross-Layer Optimization Using Advanced Physical Layer Techniques in Wireless Mesh Networks,” IEEE Transactions on Wireless Communications, vol. 11, pp. 1622–1631, apr 2012.
[14] A. G. Perotti and B. M. Popovi´c, “Non-orthogonal multiple access for degraded broadcast channels: RA-CEMA,” in 2015 IEEE Wireless Communications and Networking Conference, WCNC 2015, pp. 735–740, 2015.
[15] X. Wei, H. Liu, Z. Geng, K. Zheng, R. Xu, Y. Liu, and P. Chen, “Software Deﬁned Radio Implementation of a Non-Orthogonal Multiple Access System Towards 5G,” IEEE Access, vol. 4, pp. 9604–9613, 2016.
ECE Paris/VEDECOM

22 Raﬁk Zitouni, Mattia Minelli raﬁk.zitouni@vedecom.fr , mattia.minelli@vedecom.fr

[16] J. Mitola, “Software radios: Survey, critical evaluation and future directions,” IEEE Aerospace and Electronic Systems Magazine, vol. 8, pp. 25–36, Apr. 1993.

[17] N. Haziza, M. Kassab, R. Knopp, J. H¨arri, F. Kaltenberger, P. Agostini, M. Berbineau, C. Gransart, J. Besnier, J. Ehrlich, and H. Aniss, “Multi-technology Vehicular Cooperative System Based on Software Deﬁned Radio (SDR),” pp. 84–95, Springer, Berlin, Heidelberg, 2013.

[18] B. Bloessl, M. Segata, C. Sommer, and F. Dressler, “Performance Assessment of IEEE 802.11p with an Open Source SDR-based Prototype,” IEEE Transactions on Mobile Computing, pp. 1–1, 2017.

[19] “OpenAirInterface.” Available at http://www.openairinterface.org.

[20] “GNURadio.” Available at https://www.gnuradio.org/.

[21] R.-A. Stoica, S. Severi, and G. T. F. de Abreu, “On prototyping IEEE802.11p channel estimators in real-world environments using GNURadio,” in 2016 IEEE Intelligent Vehicles Symposium (IV), pp. 10–15, IEEE, jun 2016.

[22] B. Bloessl, M. Gerla, and F. Dressler, “IEEE802.11p in fast fading scenarios,” in Proceedings of the First ACM International Workshop on Smart, Autonomous, and Connected Vehicular Systems and Services - CarSys ’16, (New York, New York, USA), pp. 1–5, ACM Press, 2016.

[23] “Ettus Research.” Available at https://www.ettus.com/.

[24] J. Ansari and P. M¨ah¨onen, “Wireless Open-Access Research Platform (WARP) for Flexible Radio,” in Opportunistic Spectrum Sharing and White Space Access, pp. 49–80, Hoboken, NJ: John Wiley & Sons, Inc, jul 2015.

[25] “Nutaq Innovation.” Available at https://www.nutaq.com/.

[26] “LimeSDR.” Available at https://myriadrf.org/projects/limesdr/.

[27] “AnalogDevices.”

Available at http://www.analog.com/media/en/

technical-documentation/data-sheets/AD9361.pdf.

[28] P. Fuxj¨ager, a. Costantini, D. Valerio, P. Castiglione, G. Zacheo, T. Zemen, and F. Ricciato, “IEEE 802.11p Transmission Using GNURadio,” Spectrum, vol. 94, pp. 1–4, 2010.

[29] C. F. Mecklenbr¨auker, A. Paier, and V. Shivaldova, “Implementation of ieee 802 . 11 p physical layer model in simulink,” 2010.

[30] B. Bloessl, M. Segata, C. Sommer, and F. Dressler, “Towards an Open Source IEEE 802.11p stack: A full SDR-based transceiver in GNU Radio,” in IEEE Vehicular Networking Conference, VNC, pp. 143–149, 2013.

ECE Paris/VEDECOM

