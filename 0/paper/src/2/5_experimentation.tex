\section{Experimentation}

\subsection{Environment description}

The objective of this scenario is to connect a Wireless Sensor Network to a running Sentilo server.
There are 2 sides of the network,
	with the border router in the middle of both.
The WSN uses CoAP to extract the sensors information,
	and the sensor data.
The Sentilo server uses HTTP requests,
	with JSON objects.
The JSON (JavaScript Object Notation) is a text format transmit data objects consisting of attributeâ€“value pairs.
It is one of most widely used by programming languages to send data over HTTP.

\subsubsection{Sensor Network}
The wireless sensor network is composed by Z1 motes connected by a border-router.


\paragraph{Border Router}
The Border Router manages the RPL (Routing Protocol for Low-Power and Lossy Networks),
	and is connected to a computer using Tunslip,
	a tool used to bridge IP traffic between 2 devices,
	over the serial line.
Tunslip creates a virtual network interface (tun) on the host side and uses SLIP (serial line internet protocol) to encapsulate and pass IP traffic to and from the other side of the serial line.

\paragraph{Nodes}
Each of the motes has a CoAP server running,
	and has a resource for each sensor attached to the mote.
In this environment 2 Sentilo items will be used:

Component:
	The hardware where a sensor is attached.

Sensor:
	A physical sensor.
It must be attached to a component For the Sentilo server,
	each component,
	sensor,
	and alert must have a unique id.
In this setup,
	each mote is a component in the server,
	the mote id is used for the unique id in sentilo.
For this example,
	the mote 3 will have the id MOTE03.
Each sensor has his unique id too,
	using the component id and the type of sensor.
In this setup the temperature sensor of the mote 3 will have the id MOTE03TMP.
Every sensor has a CoAP resource defined in the mote.
A location resource is defined to set the mote location 

\subsubsection{Network connector}
In the computer connected with the border-router,
	there's a Java application that pulls the information in the WSN using CoAP,
	and communicates with the Sentilo server to register the sensor and send the data.
A provider must be registered manually in Sentilo in order to get the authentication token.
For every request sent,
	the authorization token is checked.


\paragraph{Application workflow}
The Java application that connects the 2 networks,
	follows 5 steps: 1.
Searches for all the Motes of the specified network in the border router,
	by sending an HTTP GET to the border router.
It responds with an XML with the information of all the motes.

Discovers all the sensors in each Mote,
	by sending a CoAP discover to each mote.


Gets the information of each sensor,
	by sending a CoAP GET to the resources on the mote.


Registers each sensor in Sentilo,
	by sending a HTTP POST to the server with the information of the sensor.

Starts collecting data from the sensors,
	and registers it in Sentilo,
	by sending a CoAP observe to each Mote resource,
	and for each observation,
	sends a HTTP PUT with the data to Sentilo.

\paragraph{Sensor registration}
Once the application has a list of all the motes and the sensors of each one,
	sends a GET request every mote for each one of the sensors resources,
	to get the information of the resource.
The sensor resource has defined the information needed to register.

Once the information of the sensor is gathered,
	it creates a JSON Object to register the sensor into the Sentilo server via the API.

\paragraph{Sensor data publish}
The application starts an OBSERVE on the mote for each sensor resource.
At this point,
	the application starts to listen for messages from the CoAP resource.
The sensor periodic resource sends information of the sensor data periodically.
The period of observation is defined in the mote.
In every observation,
	the data is sent to Sentilo in a JSON Object via the API.

The parameters sent in the JSON to the server are:













