ACCOUNTING FOR TOPOLOGY IN SPREADING CONTAGION IN NON-COMPLETE NETWORKS
June Zhang and Jose´ M.F. Moura
Carnegie Mellon University Department of Electrical and Computer Engineering
Pittsburgh, PA 15213 USA Email: {junez@andrew, moura@ece}.cmu.edu

ABSTRACT
We are interested in investigating the spread of contagion in a network, G, which describes the interactions between the agents in the system. The topology of this network is often neglected due to the assumption that each agent is connected with every other agents; this means that the network topology is a complete graph. While this allows for certain simpliﬁcations in the analysis, we fail to gain insight on the diffusion process for non-complete network topology. In this paper, we offer a continuous-time Markov chain infection model that explicitly accounts for the network topology, be it complete or noncomplete. Although we characterize our process using parameters from epidemiology, our approach can be applied to many application domains. We will show how to generate the inﬁnitesimal matrix that describes the evolution of this process for any topology. We also develop a general methodology to solve for the equilibrium distribution by considering symmetries in G. Our results show that network topologies have dramatic effect on the spread of infections.
Index Terms— continuous-time Markov chain, network, stationary distribution, isomorphism, infection
1. INTRODUCTION
In the study of infection in epidemiology, trends in social networks, cascading effects in critical physical infrastructures, the topology of the network underlying the interactions between the agents is generally not accounted for [1, 2]. The implicit assumption is that this network is complete (i.e., every agent is in contact with or impacts the behavior of every other agent). This is an understandable approximation since for a complete network, under appropriate scaling conditions and in the asymptotic limit of large networks (mean ﬁeld limit), the evolution of the diffusion process reduces to the study of the dynamics of a scalar statistics (e.g., fraction of infected agents in the network) [3, 4].
In this paper, we develop a methodology for studying diffusion in a network of N agents that explicitly takes into account the network topology. We model the diffusion process by a continuous-time Markov chain whose states keep track of the states of all the nodes. We refer to the state of a single agent as the micro state and the state of all the agents as the network state. The state space of our Markov model is the set of all possible network states.
First, we will show how to automatically ﬁnd the inﬁnitesimal matrix, Q, of this process for arbitrary topology based on the
This work was partially supported by AFOSR grant #FA95501010291, and by NSF grants CCF1011903 and CCF1018509

characteristics of the infection process; we account for 1) healing, 2) naturally occurring infection, 3) transmitted infection from infected neighbors. Next, we look to graphs theory and isomorphism to deﬁne an equivalence relationship between the states of the Markov process. This reduces the cardinality of the state space of the Markov process to the cardinality of the state space of the equivalence classes. In particular, we show how this equivalence relationship reduces the computation complexity of ﬁnding the stationary distribution of our Markov infection model. Finally, we illustrate our approach on non-complete network topologies, namely, with the chain and cycle graph.
2. THE MODEL
2.1. Network of Agents
We represent the network of N agents by an undirected, connected, unweighted colored graph G = (V, E, P ) with adjacency matrix A, which is N × N . The set E deﬁnes the topology, and P partitions the vertices into 2 sets: infected (1) and uninfected (0). P = {V0, V1 | V0 ∪ V1 = V, V0 ∩ V1 = ∅} [5]. For v ∈ V , color(v) = i if v ∈ Vi.
We assume that the topology remains static. The network state, n, is the N-tuple of the micro states
n = (color(v0), color(v1), . . . , color(vN−1))
The ith element in n is ni, the micro state which represents the state of agent i. The set, N , contains all possible network states, n. Therefore, the cardinality of N is 2N .
Each network state, n ∈ N , induces a corresponding colored graph Gn = (V, E, P n). P n = {V0n, V1n} where {V0n = i | ni = 0}, {V1n = i | ni = 1}. Figure 1 shows some example network states and their induced colored graphs for a chain graph with 4 nodes. Gray nodes are infected nodes; white nodes are uninfected nodes.
Fig. 1: Examples of Network States and Induced Colored Graphs

2.2. Markov Infection Model

We will model the evolution of spreading contagion in G using concepts from the well-known SIS (Susceptible-Infected-Susceptible) model [3]. Let {X(t)}, (t ≥ 0) be the network state at time t. At some time t, X(t) = n, where n ∈ N .The process evolves based on 3 types of events:

1. Healing. Infected nodes heal in a length of time that is exponentially distributed with parameter µ.

2. Exogenous infection. Uninfected nodes may naturally become infected in a length of time that is exponentially distributed with parameter λ (assuming that there is only one type of virus).

3. Endogenous infection. Uninfected nodes become infected by transmission from infected neighbors in a length of time that is exponentially distributed with parameter γ (assuming that all infected individuals are equally contagious).

We can normalize by µ so that the process is parameterized by

λ µ

and

γ µ

.

With these assumptions, we model {X(t)} as a ﬁnite state,

continuous-time Markov chain with state space N . Adapting the

notation from [6], we deﬁne 2 operators on a state of the Markov

process, n = (n0, n1, . . . nj , . . . , nk, . . . , nN−1)

Tkn = (n0, n1, . . . , nk = 1, . . . , nN−1) Tj•n = (n0, n1, . . . , nj = 0, . . . , nN−1)

Tk deﬁnes the operation that node k is infected. If node k is already infected, the operator does nothing. Tj• deﬁnes the operation that node j is healed. If node j is already uninfected, the operator does nothing.
There are two types of state transitions in the Markov process: 1) X(t) jumps to the network state where the kth node (k = 0, 1, . . . , N − 1) is infected with transition rate

λ N−1

γ

q(n, Tkn) = µ +

1(nj = 1)Ajk µ , n = Tkn (1)

j=0

where 1(·) is the indicator function, and A = [Ajk] is the adjacency matrix of G. The ﬁrst term accounts for exogenous infections, which does not dependent on G. The second term accounts for endogenous infections, which is dependent on the topology of the network.
2) X(t) jumps to the network state where the jth node (j = 0, . . . , N − 1) is healed with transition rate:

q(n, Tj•n) = 1, n = Tj•n

(2)

2.3. Inﬁnitesimal Matrix, Q

Using equations (1) and (2), we can generate the inﬁnitesimal matrix, Q, which is a 2N × 2N matrix. The ith row and jth column of

Q correspond to the decimal scalar representations of the network

states, i, j ∈ N , respectively.

The matrix Q is not symmetric, but it has symmetric struc-

ture, meaning that the nonzero elements are in symmetric locations.

Nonzero entries below the diagonal correspond to X(t) transition-

ing to a state with one less infected individual while nonzero entries

above the diagonal correspond to the Markov process jumping to a

state with an additional infected node.

We can automatically generate Q given a network topology G

and the infection parameters

λ µ

and

γ µ

.

With Q, we can ﬁnd the

equilibrium distribution, π by solving πQ = 0. For large N , this is computationally intensive. Our next task is to utilize the concept of isomorphism from graph theory to reduce the state space of our Markov process.
3. GRAPH ISOMORPHISM AND EQUIVALENCE CLASSES
Recall that each network state, n, induces a colored graph Gn = (V, E, P n). From graph theory, two graphs are considered equivalent if they are isomorphic to each other [5].
Two colored graphs, G = (V, E, P ) and G = (V , E , P ) are isomorphic, G ∼ G , if there is a mapping φ : V → V such that
1. φ is a bijection
2. (v1, v2) ∈ E if and only if (φ(v1), φ(v2)) ∈ E for all v1, v2 ∈ V
3. color(v) = color(φ(v)) for all v ∈ V
The ﬁrst 2 conditions ensure that the uncolored graphs, (V, E) and (V , E ) are isomorphic. The last conditional is the additional constraint required by colored graph isomorphism.
3.1. Quotient Set of N
We deﬁne the equivalence class of the network state, n, as
[n] = {x ∈ N | Gx ∼ Gn}
where ∼ is colored graph isomorphism. The set of equivalence classes in N is called the quotient set and is denoted as N / ∼= {[n1], [n2], . . . , [neq]}, where eq = |N / ∼ |. The cardinality of N / ∼ will depend on the topology of G. However we know that |N / ∼ | ≤ 2N since [ni] ∩ [nj] = ∅ for i = j and N = [n1] ∪ [n2] ∪ . . . ∪ [neq].
Proposition 1: If x, y ∈ [n], then π(x) = π(y). We will prove this in the Appendix.
3.2. Finding the Quotient Set, N / ∼
With the given network, G = (V, E, P ), we can ﬁnd the quotient set using the following steps:
1. Initialize: N / ∼= ∅
2. Find the set of mappings {φ} that gives the set of uncolored graphs {G } that is isomorphic to (V, E). This can be done efﬁciently with existing algorithm [7]
3. While (N = ∅)
(a) Pick n ∈ N . It has a corresponding colored graph Gn = (V, E, P n) where P n = {V0n, V1n}
(b) For each mapping in {φ} and each v ∈ V1n, set color(φ(v)) = 1 to produce colored graphs that are isomorphic to Gn. These colored graphs correspond to a set of network states, {m}
(c) Add n to N / ∼
(d) Remove {n, {m}} from N

3.3. Equilibrium Distribution over N / ∼
Since all the network states in the same equivalence class have identical equilibrium distribution, we can reduce the state space of the Markov process from N to N / ∼. The new inﬁnitesimal matrix Qeq is a eq × eq matrix. We can ﬁnd the unnormalized stationary distribution by solving πeqQeq = 0.
We normalize πeq using the relationship
|[n1]|(πeq(n1)) + . . . + |[neq]|(πeq(neq)) = 1
Depending on G, considering isomorphism can lead to great reduction in the number of network states. Figure 2 shows the logscaling of |N / ∼ | for different network topologies. For example, in a network where N = 15, |N | = 215 = 32, 768. However, if the network is a chain structure like in Figure 3a), then |N / ∼ | = 16, 512. A cycle graph, as shown in Figure 3b), contains even more isomorphism mappings and |N / ∼ | = 1224. Naturally, the graph with the most symmetry is the complete graph where |N / ∼ | = N + 1 = 16. For the complete graph, equivalence class is determined by the number of infected nodes. This is not true for non-complete graphs.

Quotient Set Size vs N 105

2N

104

Chain Graph

Cycle Graph

Complete Graph

103

Quotient set size (eq)

102

101

100

2

4

6

8

10

12

14

16

N, number of nodes

Fig. 2: log(|N / ∼ |) vs. N = 2 to 15 for Different Graph Topologies

two nodes being infected is higher than the probability of a single infected node. The equilibrium distribution is determined by the spatial arrangement of infected and non infected nodes. For example, in the cycle graph it is more likely for connected nodes like v0 and v1 to be infected at the same time than for unconnected nodes such as v0 and v3 to be infected simultaneously. There is a predilection for infected nodes to be clustered and connected together, thereby giving rise to ‘epidemic’ behavior.

Table 1: Equilibrium distribution for chain and cycle graph (N =

4,

λ µ

=

0.1,

γ µ

=

3)

Network State n
0000 1000 0100 1100 0010 1010 0110 1110 0001 1001 0101 1101 0011 1011 0111 1111

[n]G1 [n1] [n2] [n3] [n4] [n3] [n5] [n6] [n7] [n2] [n8] [n5] [n9] [n4] [n9] [n7] [n10]

πG1 (n)
0.1882 0.0213 0.0163 0.0498 0.0163 0.0130 0.0375 0.1031 0.0213 0.0100 0.0130 0.0391 0.0498 0.0391 0.1031 0.2790

[n]G2 [n1] [n2] [n2] [n3] [n2] [n4] [n3] [n5] [n2] [n3] [n4] [n5] [n3] [n5] [n5] [n6]

πG2 (n)
0.0968 0.0097 0.0097 0.0252 0.0097 0.0105 0.0252 0.0735 0.0097 0.0252 0.0105 0.0735 0.0252 0.0735 0.0735 0.4484

4. RESULTS

We illustrate our model with 2 examples with parameters (N =

4,

λ µ

=

0.1,

γ µ

=

3) for two network topologies:

a chain graph,

G1, and a cycle graph, G2, as shown in Figure 3a) and Figure 3b)

respectively.

Figure 3 shows the quotient sets of G1 and G2. By considering equivalence classes, we can reduce the size of the state space of G1 from 16 to 10 and of G2 from 16 to 6. Table 1 summarizes the equilibrium distribution of G1 and G2.

The evolution of the infection on the chain and cycle graph ex-

hibit different limiting behavior. Both models have a higher rate of

endogenous infection to healing, so we expect many nodes to be-

come infected. However, the cycle topology has a higher probability

of all nodes being infected than the chain node; since more nodes

are connected together in the cycle graph, it is easier for the virus to

spread amongst the nodes.

We can also see that the limiting probability is not determined

simply by the number of infected nodes. In G1, it is less likely for node v0 and v2 to be infected simultaneously than for a single node to be infected. However, in the cycle graph, the probability of any

(a) Quotient Set of G1

(b) Quotient Set of G2

Fig. 3: Colored Graph Equivalence Classes for G1 and G2

5. CONCLUSION
Using our model, we have shown that the diffusion process is highly dependent on the network topology. Assuming a complete network topology will give very different results from any non-complete topology. We ﬁnd the inﬁnitesimal matrix that describes the evolution of the disease, which accounts for infection and healing of the

nodes in any topology. We use the concept of graph isomorphism to reduce the state space of the Markov process to expedite the calculation for the stationary distribution.

6. REFERENCES
[1] I. Dobson, B.A. Carreras, and D.E. Newman, “A branching process approximation to cascading load-dependent system failure,” Hawaii International Conferences on System Sciences, Jan. 2004.
[2] N. Boccara, Modeling complex systems, Springer Verlag, 2010.
[3] M. O. Jackson, Social and Economic Networks, Princeton University Press, 2008.
[4] A. Santos and J.M.F. Moura, “Emergent behavior in large scale networks,” Conference on Decision and Control, Dec. 2011.
[5] A. Lal and D. van Melkebeek, “Graph isomorphism for colored graphs with color multiplicity bounded by 3,” Tech. Rep., Citeseer, 2005.
[6] F.P. Kelly, Reversibility and stochastic networks, vol. 40, Wiley New York, 1979.
[7] Gabor Csardi and Tamas Nepusz, “The igraph software package for complex network research,” InterJournal, vol. Complex Systems, pp. 1695, 2006.
[8] G. Royle C. Godsil, Algebraic Graph Theory, Springer-Verlag, 2001.
[9] S. Karlin H. M. Taylor, An Introduction to Stochastic Modeling, Academic Press, 3rd edition, 1998.

A. PROOF OF PROPOSITION 1

If x, x ∈ [n], then π(x) = π(x).

x and x are in the same same equivalence class so there is a mapping, φ, such that the induced graph Gx = (V, E, P x) is color isomorphic to Gx = (φ(V ), E, P x). Gx and Gx have the same

adjacency matrix, A. Using Lemma 1.31 from [8], which states

that node vi ∈ Gx, (i = 0, 1, . . . N − 1) and node φ(vi) ∈ Gx

have the same number of neighbors. This means that

N −1 k=0

Aki

=

N −1 k=0

Akφ(i) .

The equilibrium distribution, π, satisﬁes the global balance

equation:

N −1

N −1

π(x)

q(x, Tkx) + q(x, Tj•x) =

(3)

k=0

j=0

N −1

N −1

π(Tkx)q(Tkx, x) + π(Tj•x)q(Tj•x, x)

k=0

j=0


N −1


N −1

π(x) 

q(x, Tφ(k)x) +

q(x, Tφ(j)•x) = (4)

φ(k)=0

φ(j)=0

N −1
π(Tφ(k)x)q(Tφ(k)x, x)
φ(k)=0

N −1

+

π(Tφ(j)•x)q(Tφ(j)•x, x)

φ(j)=0

Note that Tkx and Tφ(k)x are in the same equivalence class. The Tk operator represents a coloring of the kth node in Gx while Tφ(k) represents a coloring of the φ(k)th node in Gx. This coloring, together with the mapping φ, satisfy the 3 conditions of color isomorphism. Similarly, Tj•x and Tφ(j)•x are in the same equivalence class.
Consider the transition rates:
q(x, Tj•x) = 1 = q(x, Tφ(j)•x)

λ N−1

γ

q(x, Tkx) = µ +

1(nj = 1)Ajk µ

j=0

λ N−1

γ

=+ µ

1(nj = 1)Ajφ(k) µ

j=0

= q(x, Tφ(k)x)

By the same reasoning,

q(Tkx, x) = q(Tφ(k)x, x) q(Tj•x, x) = q(Tφ(j)•x, x)

Equations (3) and (4) represents two linear systems with identical coefﬁcients. Since ﬁnite state Markov process always has an unique equilibrium distribution, the solution to the linear systems must be unique as well. Therefore, π(x) = π(x) when x, x ∈ [n].

A.1. Finite State Continuous-Time Markov Process Review

We model the diffusion process by a ﬁnite state continuous-time Markov chain, {X(t)}(t ≥ 0) with states {0, 1, . . . M }. We will only consider an aperiodic, irreducible, time homogenous, ﬁnite state Markov process [9]. The process is characterized by

q(i, j) = lim Pij(τ ) , τ →0 τ
= 0, j = i

j=i

where Pij(t) is the transition probability of going from state i to state j in t duration. It is also the is the {i, j} entry in the matrix P(t). Have
M

q(i) =

q(i, j)

j=0,j=i

The rates, q(i) and q(i, j), provide us with the inﬁnitesimal description of the Markov process. The amount of time that the process will remain in state i is exponentially distributed with parameter q(i). We can express the transition rates as the inﬁnitesimal matrix, Q, where

 −q(0) q(0, 1) . . . q(0, M )

 q(1, 0)

Q=  

...

−q(1) . . . q(1, M )   

q(M, 0) q(M, 1) . . . −q(M )

The differential equation that governs the evolution of P(t) is

P (t) = P(t)Q

We can ﬁnd π by solving the system of equations

0 = πQ = π(0) π(1) . . . π(M ) Q

with the additional constraint that

M i=0

π(i)

=

1.

