University of Cuenca

Figure 4.8: Atmosphere 2 - Machángara River
less. shrubs up to three meters high and lots of eucalyptus trees up to seven meters high, with spacings between three and seven meters between them: two kinds of vegetation were mainly observed. Topography The topography of the site chosen does not have steep slopes, so it can be considered flat. Others Just as in the room 1 should be considered in the analysis results in some points, because of the measurement methodology to be described in Section 4.5 Some shipments are in unfavorable areas in terms of the height of the transmitter or nearby vegetation.
4.4.3. Environment 3: Rural - Rio Yanuncay
The WSN , As reviewed in the second chapter, they can be deployed in variety of environments. It is for this reason that the third environment complements the above, having a free rural scene of edi fi cations. Speci fi cally, the measurements were performed in the population of Barabón. In Figure 4.9 the measurement distance having the following characteristics is presented:

Pablo Campos Avila

36

University of Cuenca

Figure 4.9: Atmosphere 3 - Rio Yanuncay

Figure 4.10: Atmosphere 3 - Lifting Scheme

Vegetation In the case of this river, greater density of vegetation and a greater variety of species of trees and plants was observed. There are trees between 1 and 7 meters high, planted less than a meter away from them.
Topography
The area chosen is close to El Cajas National Park, so it has a tendency to terrain elevation is clearly seen in Figure 4.10 .
Others In the absence of surrounding buildings, meaningful improvement observed in terms of RSSI , SNR and number of packets received, which will be discussed in Chapter 5.

Pablo Campos Avila

37

University of Cuenca
4.5. Procedure description
The measurement procedure consisted of sending packets from a transmitter (Speck) varying the distance fi xed intervals. The receptor ( Gateway) and transmitter were placed in fi xed manner to a height of 2 meters above ground level, with the aim that the signal passes through the vegetation. Both the transmitter and receiver antennas have 1.3 dBi gain. At each point 20 packets were sent, of which it was collected RSSI , SNR and number of packets received.
4.5.1. Measurement intervals
the measurement process called spatial averaging, proposed by [was used for data acquisition, 44 ]. According to this procedure, one must move a distance of between 20 λ and 40 λ at a given frequency.

As mentioned in the theoretical framework, LoRaWAN makes pseudorandom frequency hopping, however, for the calculation equations ( 4.1 ), ( 4.2 ) Y ( 4.3 ), The operating frequency of 915 MHz equipment was considered.

λ=c f = 3 * 190158 * 10 6 = 0,327 m
twenty * λ = 6.54 m

(4.1) (4.2)

40 * λ = 13.08 m Since the value must be in the range between ( 4.2 ) Y ( 4.3 ), It was chosen 10 m operability.

(4.3)

4.5.2. packets Sent
As described equipment used LoRaWAN , The configuration of parameters such as SF , BW , Y CR are limited not only by the specification of regional parameters LoRaWAN [ Four. Five ], Which can be found in Table 2.3 but by the technical characteristics of development kit used. In the table 4.1 , Is the DR allowed.

Pablo Campos Avila

38

University of Cuenca

Table 4.1: Allowable Data Rate Data Rate With setup [ SF / BW ] Bit Rate [bit / sec]

0

SF10 / 125kHz

one

SF9 / 125kHz

two

SF8 / 125kHz

3

SF7 / 125kHz

980 1760 3125 5470

Figure 4.11: Packet Capture
Since it is an initial study, the minimum and maximum rates and DR0 DR3 data at each point of delivery were used with 10 packets for each DR . To facilitate the calculation of lost packets, each message is sent with a tracking number in its payload.
4.5.3. Packet Capture
As this assessment work concerning physical parameters of technology LoRaWAN , And the ease of saving packets received, we chose not to use the server LoRaWAN Since the values ​of RSSI , SNR and payload can be obtained and stored in a more optimum way by a catch thereof, the configuration is detailed in Appendix A.1.
Since the Gateway receives the packets and sends the Ethernet port to the server, they can be easily captured with software like Wireshark. In Wireshark, capturing 20 packets sent it is made and saves them for later decrypted.
In Figure 4.11 the image of one of the catches with Wireshark and saved in .txt format:
As seen, packages and DR0 DR3, are mixed and the payload is encrypted, so that a selection process is necessary, decrypted and storage, described in Section 4.5.4 .

Pablo Campos Avila

39

University of Cuenca
4.5.4. Decrypted and Storage
To perform the separation, storage and decrypted packets, it became a Python script that uses the decoder LoRaWAN package [ 46 ]. This decoder requires the previous installation of Node.js and npm, which are programming platforms based on Javascript. The decoder also distinguishes the different types of possible packages, so it was necessary to modify it to perform decoding only fi cation. The final code is in Appendix B. The Python code does the following:
• Separate multiple packages into its components ( RSSI , SNR , Frequency, modulation, coding rate, channel and payload) • Set-top ca payloads each packet • Separate packages of DR0 DR3 • Stores each captured in a .csv file • Create a file summary means and standard deviations of the RSSI Y SNR .
4.6. Metrics Data Analysis
Then the tools to be used for analysis of the measurements obtained in the three environments described above are developed.
4.6.1. Description Data with Numerical Measures
The numerical measurements lack the effectiveness of the graphs, however help get an idea of ​the trend of data without the need to observe the image of the same [ 47 ].
Central Measures: They are measured along the horizontal axis of a distribution LOcalizan the center of it. The mean, median and mode are used to describe data sets.
Variability measures: Two data sets can have the same center but difent dispersion or variation. Variability measures help create an image of the distribution of the data. These include the range, which is the difference between the largest and smallest measurement; the variance of the population and the sample are defined as the average of the squared deviations around the mean. The standard deviation is equal to the positive square root of the variance. A

Pablo Campos Avila

40

University of Cuenca this feature is that the measuring unit is the same as the measurements [ 47 ].

4.6.2. Estimation of confidence intervals
It is about finding a gap where you are sure with some probability that it is a parameter of interest. This probability is called coefficient of confidence. confidence intervals at 95% are usually constructed [ 47 ].

Construction Interval of confidence
When the sampling distribution of a variable, in the case RSSI It is approximately normal, it can be applied Equation 4.4 based on the number of samples and standard deviation.

half ± 1,96 * θ

√n

Being θ standard deviation and n the number of samples. Interval of confidence in the Case of Small sample quantities

(4.4)

There are cases where it is difficult or costly to obtain a large number of observations. In these cases Equation 4.4 It can not be applied, as an alternative distribution Student t being necessary [ 48 ]. In this case, the interval of confidence can be found with Equation 4.5 .

half ± t * θ

√n

(4.5)

The value of t It is on the table Student t distribution, where it should take into account n - 1 degrees of freedom, besides the level of con fi dence of 0.95 typical. Since the samples of this paper have n = 10, use t-student distribution to calculate intervals confidence.

4.6.3. Correlation Analysis
The correlation analysis is based on the correlation coefficient ( r) which it is nothing more than a measure of the strength of the relationship between two variables. This can take values ​between -1 and +1. A r = - 1 indicates a perfect negative relationship between the variables. In general, the higher

Pablo Campos Avila

41

University of Cuenca is the absolute value of r, the stronger the relationship between the variables [ 48 ]. This analysis is used in this work to determine the strength of the relationship between the measurements 1 and 2 were conducted in two different banks of the river (1 atmosphere).
4.6.4. Comparison Populations
The purpose of this test is to compare measurements RSSI between the three environments studied. For this, the test is used Kruskal-Wallis testing the hypothesis regarding the distribution of three or more populations, using the medium. This makes since the RSSI does not follow a normal distribution. the null hypothesis that the three environments have the same distribution test [ 47 ].
This is done in order to see if you need to make an adjustment to the three fi nest environments. In the event that the alternative hypothesis that at least one environment is different is met, we proceed to perform the test Dunn reporting the results between combinations of environments [ 47 ]. These tests were made using the free statistical analysis software R one .

4.7. conclusions
Evaluating transmission range requires taking into account different variables for this study are based on the procedure and equipment are described in detail in this chapter.
Evaluation Kit LoRa has the advantage of allowing vary most parameters available conguration LoRa This in order to make global system testing. The addition of temperature sensors and light in Butte, allow you to test the reliability in the transmission of information. Adding a graph interface in conjunction with a server pre fi gured with, help the user experience to this new technology is the best.
Environments chosen for sampling RSSI , SNR Y PER They reflect the need of deploying sensors on the riverbanks in the city of Cuenca to assist the real-time monitoring of flow thereof. Generality to win three rooms were chosen: urban, semi-urban and rural whose data and results are explained in later chapters.
one https://www.r-project.org/

Pablo Campos Avila

42

University of Cuenca Statistical tests such as correlation analysis and comparison test distributions, help validate the measurements, interpret and display the results in the best way.
On the other hand, as explained in the introduction, it was considered important to accurately describe the measurement procedure so that it can be validated and if necessary, replicated.

Pablo Campos Avila

43

University of Cuenca
Chapter 5
Results: Analysis
Measurement and adjustment of the empirical model based on RSSI and SNR
This chapter marks the ultimate objective raised in this paper, which is to set a path loss model for the use of LoRa in riverbanks with forest environments. Before adjustment, statistical validation tests show that the correlation between the two banks of a river is high and there is no distributions relationship between the urban and semi-urban environments are made. different environments are compared and shows how the standard deviation decreases in the rural environment because there are fewer barriers. Finally, packet losses are shown in the measurements as a measure of transmission quality.

Pablo Campos Avila

44

University of Cuenca
5.1. Introduction
As we discussed in the previous chapter, with values RSSI Y SNR , You can generate a path loss model that is reliable and can be adjustable to a logarithmic equation that serves to make estimates of coverage and simulations sensor networks using technology LoRaWAN . Before generating models, you can perform a statistical correlation analysis con fi rm the hypothesis that there is no big difference in the propagation of the two banks of the same river. This was made only with the ambiente 1 (Tomebamba River).
The modelamientos is performed with the function fi t Matlab. These is confirmed that rural environments have fewer obstacles so increased range is observed. On the other hand, the standard deviation that is linked to the so-called shadow fading, caused by obstacles is calculated.
To conclude, as proposed in the first chapter, the packet loss rate is used to know when the transmission is not reliable and therefore measurements must stop. Depending on the application, the percentage of lost packets varies acceptable, however, for this procedure, and considering that the typical maximum frequency transmission networks LoRaWAN It is five minutes, fi xed a limit of 60% of lost packets to stop the measurement.
5.2. Preliminary measurements
Here are some of the measurements used for determining the influence of the frequency hopping LoRaWAN The optimum number of packets to send and select power rating.
5.2.1. Frequency Hopping
As he explained in Section 2.5, concerning the rules used by devices LoRaWAN , Fi nal devices or nodes transmit at different channels pseudorandom manner. As seen in Figure 5.1, to transmit 100 packets in a test environment, the frequency varies from 902.3 MHz to 903.5 MHz in increments of 200 kHz. The aim of this preliminary study was to define whether the channel attenuates RSSI selectively at certain frequencies.

Pablo Campos Avila

Four. Five

University of Cuenca

Figure 5.1: Values RSSI obtained for different frequencies Figure 5.1 It can be concluded that there is no selective channel so the proposed frequency hopping LoRaWAN , it is valid.
5.2.2. Number of Packages
To determine the number of packets required at each point transmission, first revised in the different works that were part of the state of the art, presented in Chapter 3. These different quantities of packets sent and explanation of this is given. For this reason a test in which they were sending different amounts of packages and standard deviation of each group was calculated was performed. In the table 5.1 The results are observed.
It is noted that generally, the standard deviation decreases by 1 dBm. Although there is this decrease, it is not meaningful, so that, as explained in section 4.5.2, in each transmission 10 packets are sent.
5.2.3. Power Index
The power rating defines the power with which the node transmits the packet or speck. Microchip RN2903 module admits indices 5, 7, 8, 9, 10 [ 49 ]. It is known that the power

Pablo Campos Avila

46

University of Cuenca

Table 5.1: Standard Deviation results with different number of packages Test no. No. Packages Standard Deviation (dBm)

one two 3 4 5 6 7 8 9 10

10 twenty 30 40 fifty 60 70 80 90 100

1.94 1.16 1.76 1.63 2.06 1.57 1.18 1.10 1.25 1.05

maximum transmission rate belongs to 5, however, a test was conducted in a controlled environment, this index varying. The results are shown in Table 5.2 .

Table 5.2: Variation of Power Indices Index average RSSI (dBm)

5

- 23.7

7

- 27.9

8

- 29.8

9

- 30.2

10

- 32.3

As seen in Table 5.2 The index 5, provides the greatest RSSI thus it was selected for use in the measurements shown in Section 5.3 . It should be to note that a reference to the transmission power of the other indices was not found. This information was requested from Microchip, no response.

5.3. measurements RSSI Y SNR
For these graphs took into account a student t distribution at each point due to the small number of samples (10). In each graph, the average and the interval of confidence at 95% is shown. In Figures 5.2 Y 5.3 The RSSI and SNR are observed corresponding to the first measurement. Other results of measurements RSSI Y SNR They are shown in the graphs of Appendix C.

Pablo Campos Avila

47

University of Cuenca Figure 5.2: Measurement RSSI Ambiente 1 with DR0

Figure 5.3: Measurement SNR Ambiente 1 with DR0

Pablo Campos Avila

48

University of Cuenca
5.4. Statistical analysis
Then, the statistical analysis will help validate measurements and to verify the assumptions made in this work are presented.
5.4.1. Correlation
As mentioned in the previous chapter, the correlation shows the strength of the relationship between two variables. In this case, you want to show the relationship between RSSI on both sides of the Environment 1 - Rio Tomebamba, it is strong. This would indicate that the change of edge and slight variation of topography and vegetation, does not affect greatly values RSSI . The characteristics of the tested environment are detailed in Section 4.4.1.
Correlation analysis DR0 The correlation analysis shows a strong relationship between the two banks with a value of 0.92. In Figure 5.4 , Presents two RSSI with DR0 Environment 1. As can be seen, a clear trend of linearity is presented that confirms the high value of correlation.
Correlation analysis DR3 Just as in the previous point, the correlation value shows a high ratio values RSSI both banks of the river Tomebamba. The value obtained is 0.92. Similarly, the graph confirms a strong relationship between the two variables. Figure 5.5 .
5.4.2. Comparing Environments
As he explained in section 4.6.4, a comparison test of distributions in the three measurement environments (urban, semi-urban and rural) will take place. This in order to prove that an adjustment is required for each environment. As noted in section 5.3, measurements of both RSSI like SNR With DR0 and DR3 are very similar so these statistical tests will only be conducted with the values ​of RSSI with DR0 of Measurements
1, 3 and 4.
Kruskal-Wallis When performing the Kruskal-Wallis R, a value was obtained p of 0.01. Being less than 0.05, indicating strong evidence against the null hypothesis, so

Pablo Campos Avila

49

University of Cuenca Figure 5.4: Correlation Analysis RSSI with DR0 - Atmosphere 1

Figure 5.5: Correlation Analysis RSSI with DR3 - Atmosphere 1

Pablo Campos Avila

fifty

University of Cuenca
which can reject it. Therefore, the distributions of the three environments, are not equal. To determine which environments are statistically equal and what not, the Dunn test is used.
Dunn test Once you have done the test Dunn, Table 5.3 you can see the results of the comparison:

Table 5.3: Values ​of Test P Dunn

P value

rural semi-urban

semiurban 0.0010

Urban

.3788

0.01

It can be seen that the only combination that does not reject the null hypothesis is with Rural Urban. You can then say that the distributions of other combinations are unrelated.
Mann-Whitney-Wilcoxon Since apparently there is no significant difference in urban and rural measurements, it was decided to test Mann-Whitney-Wilcoxon testing independence of two populations without the need to assume that they have normal distributions [ 47 , 48 ]. The value p 0.9721 obtained was again so it is concluded that there is sufficient evidence to conclude that the urban and rural environments are different.

These statistical tests are unusual in the telecommunications area, so that a future verification and validation of the results is recommended.

5.5. Modeling in Base Path Loss
As explained in section 2.6, the equation used for modeling is a logarithmic. (Equation 5.1 ).
P L ( dB) = a + b * log (d) + X θ To adjust the losses should be calculated trajectory ( PL ) using Equation 2.6, with the parameters fi xed in Table 5.4 .
Pablo Campos Avila

(5.1) 51

University of Cuenca

Figure 5.6: Setting PL Environment 1 with DR0 - Tomebamba River

Table 5.4: Values ​used for calculating the path loss constant value

PTX

18.5 dBm

GRX

1.3 dBi

5.5.1. Measuring 1 - Urban Environment
Path loss with DR0 In Figure 5.6 logarithmic adjustment made to be seen PL measurement 1 with DR0, corresponding to urban environment described in section 4.4.1. The result thereof is shown in Equation 5.2 .

Path losses with DR3

P L ( dB) = 59.53 + 11.26 * log (d) + X θ ( θ = 6,29)

(5.2)

In Figure 5.7 logarithmic adjustment made to be seen PL measurement 1 with DR3 corresponding to the urban environment, as described in section 4.4.1. The result thereof is shown in Equation 5.3 .

P L ( dB) = 53.38 + 12.98 * log (d) + X θ ( θ = 5,12)

(5.3)

Pablo Campos Avila

52

University of Cuenca

Figure 5.7: Setting PL Environment 1 with DR3 - Tomebamba River
5.5.2. Measurement 2 - Urban Environment - Shore 2
Path loss with DR0 In Figure 5.8 logarithmic seen fit to PL measuring 2 DR0 corresponding to Shore 2 urban environment described in section 4.4.1. The result thereof is shown in Equation 5.4 .

Path losses with DR3

P L ( dB) = 44.96 + 13.39 * log (d) + X θ ( θ = 5,83)

(5.4)

In Figure 5.9 logarithmic adjustment made to be seen PL measurement 2 with the maximum data rate, corresponding to the edge 2 of the urban environment described in section 4.4.1. The result thereof is shown in Equation 5.5 .

P L ( dB) = 26.24 + 17.49 * log (d) + X θ ( θ = 3.72)

(5.5)

5.5.3. Measuring 3 - semi-urban environment
Path loss with DR0 In Figure 5.10 logarithmic adjustment made to be seen PL measurement 3 with

Pablo Campos Avila

53

University of Cuenca Figure 5.8: Setting PL Environment 1 with DR0, Shore 2 - Rio Tomebamba

Figure 5.9: Setting PL Environment 1 with DR3, Shore 2 - Rio Tomebamba

Pablo Campos Avila

54

University of Cuenca

Figure 5.10: Setting PL Environment 2 DR0 - Machángara River DR0 corresponding to semi-urban environment described in section 4.4.2. The result thereof is shown in Equation 5.6 .

Path losses with DR3

P L ( dB) = 61.55 + 10.7 * log (d) + X θ ( θ = 2.92)

(5.6)

In Figure 5.11 logarithmic adjustment made to be seen PL measurement 3 with DR3 corresponding to semi-urban environment described in section 4.4.2. The result thereof is shown in Equation 5.7 .

P L ( dB) = 62.74 + 10.67 * log (d) + X θ ( θ = 3.20)

(5.7)

5.5.4. Measuring 4 - Rural Environment
Path loss with DR0
In Figure 5.12 logarithmic adjustment made to be seen PL measuring 4 with DR0, corresponding to the rural environment described in Section 4.4.3. The result thereof is shown in Equation 5.8 .

P L ( dB) = 55.36 + 11.27 * log (d) + X θ ( θ = 3.73)

(5.8)

Pablo Campos Avila

55

University of Cuenca Figure 5.11: Setting PL Environment 2 DR3 - Machángara River

Figure 5.12: Setting PL of Atmosphere 3 with DR0 - Yanuncay River

Pablo Campos Avila

56

University of Cuenca

Figure 5.13: Setting PL of Atmosphere 3 with DR3 - Yanuncay River

Path losses with DR3
In Figure 5.13 logarithmic adjustment made to be seen PL measuring 4 with DR3 corresponding to the rural environment described in Section 4.4.3. The result thereof is shown in Equation 5.9 .

P L ( dB) = 61.13 + 10.55 * log (d) + X θ ( θ = 3,88)

(5.9)

5.5.5. Compare Models
After obtaining the log settings, you can make a comparison to determine which provides the best coverage environments by deploying a network using technology LoRa .
Comparing Environments with DR0 Then Figure 5.14 Shows settings PL with DR0 four measurements. In the table 5.5 A summary of the results is observed.

Pablo Campos Avila

57

University of Cuenca

Figure 5.14: Settings PL with DR0 - All Environments

Table 5.5: Compraración of propagation characteristics with DR0

Parameter

Measurement 1 Measurement 2 Measurement 3 Measurement 4

Maximum distance (m) Standard Deviation (dB)

800

950

1170

1600

6.29

5.83

2.92

3.73

It can be seen that measuring 4 belonging to the Rural Environment, has the best coverage of the four. In the case of measurement 1, belonging to the urban environment it decreases rapidly to around 800 meters where there is no longer reliable connection. Measurement 3, as expected, has an intermediate result. As for the standard deviations are known to be directly related to the environment. In urban environments as many obstacles so that measurements are variants and the curve does not fit in the best way the contrary is presented in the semi-urban and rural environments.

Comparing Environments with DR3
Then Figure 5.15 shows the settings PL with DR3 four measurements. In the table 5.6 A summary of the scope and standard deviations were observed.

Pablo Campos Avila

58

University of Cuenca

Figure 5.15: Settings PL with DR3 - All Environments

Table 5.6: Comparison of propagation characteristics with DR3

Parameter

Measurement 1 Measurement 2 Measurement 3 Measurement 4

Maximum distance (m) Standard Deviation (dB)

640

600

1100

1500

5.12

5.72

3.20

3.88

Just as in Figure 5.14 , the figure 5.15 It shows that the rural environment has the greatest reach. Something that can highlight is that measurements 3 and 4 present curves very similar until about 1200 meters. As for measurements 1 and 2 decay quickly and the difference it is mainly due to the environment in which measurements were made.

5.6. Packet Error Rate
As explained in the introductory chapter, 10 packets with each data rate are sent. At the receiver, how many of these packages arrived successfully recorded. This is done as a measure of overall performance transmissions and also gives a guideline to stop them.
Then the packet error rates, which were calculated with Equation shown 5.10 [ fifty ].

Pablo Campos Avila

59

University of Cuenca

Figure 5.16: Trend Average Packets Loss DR0 - Measurement 1

|||
Error = ||| 10 - paquetesrecibidos 10

(5.10)

In Figure 5.16 , The trend of packet loss in the first measurement is observed with the lower data rate. a trend is observed to grow fast approaching the maximum extent so.

Average losses of packets sent with DR0 In Figure 5.17 , 100 meter intervals were formed and the average packet loss for all four measurements was calculated. It can be seen in different measurements to achieve their coverage limits, and the tables presented 5.5 Y 5.6 The loss increases rapidly.
Average losses of packets sent with DR3 Just as in Figure 5.17 , the figure 5.18 It presents the trend of increasing packet loss as the distance increases, in the case of a transmission with higher bit rate.

Pablo Campos Avila

60

University of Cuenca Figure 5.17: Average packet loss with DR0 - All Environments

Figure 5.18: Average Packets Loss DR3 - All Environments

Pablo Campos Avila

61

University of Cuenca
5.7. conclusions
Setting a path loss model for LoRa with LoRaWAN in a specific environment fi c, such as forestry, to characterize the spread therein. Previous tests were performed with the evaluation kit allowed to define aspects such as the standard deviation of the number of packets is not meaningful if it is increased. Based on these tests, the rate of power used in the measurements was defined in addition to checking that there is no selectivity in the channel frequencies used by
LoRaWAN . Regarding the spread on both banks of the same river, it was found that the correlation is presented, even in a difficult environment such as urban, is high. The Kruskal-Wallis and Dunn performed to compare the distributions of the sampled environments conclude that there is no statistical relationship between the rural and semi-urban environments, reinforcing the need to characterize them separately. He was not able to verify the independence between urban and rural environments, this may be due to a possible link between the high density of vegetation and edi fi cations. These statistical tests are not usually applied to this type of data so the results should be veri fi ed and validated in a future study.
Using the values ​of RSSI Y SNR , The path losses were calculated and adjusted for the four measurements with data rates used. If measurements with different DR are compared, it appears that present very similar values RSSI Y SNR With the difference that DR0 has a greater reach. It is recommended whenever possible use DR3, since having less airtime, it has a lower energy consumption.
Settings show different standard deviation values ​that can be reviewed in the comparative tables 5.5 Y 5.6 . a clear downward trend in rural or semi-seen environments. This is because the standard deviation of the samples are greater measurement 1 and 2 by the many obstacles that exist in the city.
Finally, we conclude that the packet loss rate is a good parameter to define the performance of the transmission at a certain point, however it should be noted Figures 5.17 Y 5.18 losses tend to change rapidly.

Pablo Campos Avila

62

University of Cuenca
Chapter 6
Conclusions and recommendations
This chapter fi nal conclusions of the work done and the interpretation of results, the limitations encountered in the process, and finally, propose ways to expand future research are presented.

Pablo Campos Avila

63

University of Cuenca
6.1. conclusions
This study has shown that the environment where the network develops LoRaWAN As well as the topography, the in fl uence scope and percentage of packets received correctly. Previous measurements helped define aspects of transmission and power index gives the best values RSSI However, take into account that it had been used, the service life of the devices can be reduced. Another aspect was standard deviation RSSI that does not vary signi fi cantly increasing the number of messages sent. Finally, with respect to the transmission frequency it was observed that the channel is not selective, so LoRaWAN It can be used in selected environments.
Regarding measurements RSSI , A clear tendency to decline with distance logarithmically observed, which con fi rmaria the hypothesis in the theoretical framework. The results indicate that the setting of a path loss model has a lower standard deviation in semi-urban or rural environments. This translates into greater reliability model in them.
Correlation calculations, performed in an urban environment, detailed in Section 4.4.1, it is concluded that there is a strong relationship between the two banks of a river. Statistical tests, it is concluded that it can not characterize only one equation different environments. It is also noted that in most measurements, noise is not a significant signal decay in the first 300 meters factor. This would indicate that if a network with this or lesser extent, develops the noise level is negligible.
6.2. recommendations
There are different variables that can be improved in subsequent studies and were not taken into account in this being a first exploratory study LoRaWAN . Below are the main ones:
• One of the aspirations of this technology is the powerful provides, however, have used in this study a methodology which focused on the characterization of the signal through different forest environments, no longer reaches 1600m were obtained.
• In some of the points that were taken by ground problems, it could not comply with the proposed methodology, which caused there or sudden improvement decline RSSI , Visible in the graphs of Annex A.

Pablo Campos Avila

64

University of Cuenca • By taking points in a relatively small range of ten meters, was offset somewhat limited number of messages sent (ten),
however, this could be expanded twice to lower the standard deviation and improve the reliability of the samples.
• The number of messages received correctly is not a reliable measure of coverage because it tends to change rapidly with the ambient conditions.
• The teams present data rates fi ned by LoRaWAN , However, they are not implemented all, so in this study only able to test two basic ways that vary the SF .
6.3. Future work
This section explains how might apply the results and how they can be improved or extended with further research.
• As mentioned in the conclusions, the topography is an important parameter. One aspect that can work for the future is the variation in the height of the receiving antenna. This would help determine how high the best results are achieved.
• The transmission power is a key factor when analyzing coverage. In this study alone most was used, however it is proposed in a future study to test at least three powers as the continued use of the maximum can affect the life of the devices.
• Although there are works in which the parameters are varied LoRa These still are not done on forest environments. A future study could not use LoRaWAN and test whether improvements are given to do so.
• The scalability of a network LoRaWAN , But require a certain amount of nodes is a parameter that has not been measured under forest conditions and presents an interesting alternative study that could be approached from a network view.
• Another advantage of LoRa It is the low energy consumption. You can make a future study using consumer DR posed by LoRaWAN to determine the differences in energy consumption.
• Although the network parameters depend on the equipment and capabilities thereof, you can make a study of delays and delay variations messages from being sent by the node until they are received by the server.

Pablo Campos Avila

65

University of Cuenca
Annexes

Pablo Campos Avila

66

University of Cuenca
Appendix A
Device conguration
A.1. Installation and setup of server and Gateway LoRaWAN

At this point the configuration suggested by Microchip for a first approach to development kit detailed LoRaWAN . User Guide Technology was used for this procedure, LoRa [ 9 ]. A system LoRa can be implemented in many ways, however, the evaluation kit can be used with fi gured as shown in Figure
A.1 .

Pablo Campos Avila

68

University of Cuenca

Figure A.1: Scheme conguration kit LoRa [ 9 ]
A.1.1. Installation
The suite of technology development LoRa It has all the necessary components for the system con fi gure LoRa . It includes development utility, which has been developed to help users assess, develop and implement LoRa with the evaluation kit. The objective of this suite is to provide a unique package that makes the user input to a network LoRaWAN easy. The content development suite is as follows:
• Utility Development

Pablo Campos Avila

69

University of Cuenca • Docker server and database assessment • Java Runtime Environment
To start the installation, required packages should be downloaded from the following website:
http://www.microchip.com/DevelopmentTools/ProductDetails.aspx?PartNO=dv164140-2 Once downloaded the development suite LoRa , It proceeds to install. The default installation directory is Microchip / LoRaSuite . Figure A.2 .

Figure A.2: Installing the development suite LoRa You should choose all components and thus installation is complete. One of the components is chosen Java Runtime, this will be installed during the installation of the other components.
A.1.2. System Preparation
To prepare the system should do the following steps:

Pablo Campos Avila

70

University of Cuenca
open VirtualBox
VirtualBox runs Docker Engine, in which the server is stored LoRaWAN and the database. Windows and MAC OS, Docker runs virtually using VirtualBox and natively on Linux 64-bit systems. For Windows and Mac is also necessary to con fi gure port forwarding to be held in the next section. Figure A.3 .

Figure A.3: Virtualizing Windows Docker

Add Port Forwarding Rules in VirualBox
VirtualBox is looking at the option to setup, then Network, and click Advanced. Forwarding Ports, rules are added Figure A.4 .

Pablo Campos Avila

71

University of Cuenca Figure A.4: Port Forwarding Rules

Static IP Assignment
Fi gure this step with the computer Ethernet port with an IP fi xed in such a way that matches the address of the server has fi gured with the Gateway. The configuration is performed in the Ethernet adapter and IPv4. Would like Figure TO 5 .

Pablo Campos Avila

72

University of Cuenca

Figure A.5: With static IP setup in Ethernet network adapter

A.1.3. Setting up the Server
As stated earlier, the server is virtualized and managed through VirtualBox, however, you must first install it. Once installed, to run the server, no need to open VirtualBox. Just open the terminal and run the Server Docker LoRaWAN .
Open Terminal Docker The Docker Terminal serves to send commands to Docker which in turn runs the Database Server and evaluation. To run it, double click on its icon located in the folder Docker is given. A window will open as shown in Figure A.6 .

Pablo Campos Avila

73

University of Cuenca

Download the image Docker

Figure A.6: Terminal Docker

To load the image of Docker, use the following command: docker load </ C / microchip / LoRaSuite / Docker / mchplora Creating the Docker container

At this point, it will create a container with the name lora s erver, using the newly loaded image. The command is as follows:

docker create --name lora_server -p 1700: 1700 / UDP -p 3306: 3306 / TCP -p 5000: 5000 / UDP mchplora: 1.2 This container assigns port 1700 for UDP traf fi c and 3306 for TCP. Start the Container
With this command, the Docker container run. docker start lora_server

Pablo Campos Avila

74

University of Cuenca Once the container has been created, the server can start with this command and continue to be active even if VirtualBox or Terminal Docker are closed.
A.1.4. Network conguration
Connect devices LoRa With the container LoRa created and started, connect the cards assessment LoRa the computer's USB ports. Then open the Utility Software Development. The interface is presented in Figure A.7 .

Figure A.7: Software Utilities LoRa microchip
Setting up the Gateway The Gateway and it comes with factory fi gured however be con fi rm the parameters. In Figure A.8 , Shown as they should be with gured fi.

Pablo Campos Avila

75

University of Cuenca

Figure A.8: Software Utilities LoRa microchip - Gateway

At this point, if you followed the previous steps, like in the picture above, you should see a green indicator and the online statement on the corner of Setting up the Gateway and the LCD panel itself. There are times when the Gateway It takes seconds to go online. There are times when you need to disconnect and reconnect Gateway the USB port of the computer
Conguration for Custom Auto-Created
With this configuration, you can make immediate use of the evaluation server. This setting uses ABP using addresses are preconfigured fi gured. To use this you must access the tab LoRaWAN in the RN module and click the option for Custom setup With self-created, as shown in Figure A.9 .

Pablo Campos Avila

76

University of Cuenca

Figure A.9: With setup for Custom Auto-Created
Add the server to the list of devices and connection to MySQL
On the Server tab, choose Add. Thus a server is added to the interface. This server will be the receive packets sent by the RN module or speck. Before you can do this, you must connect to the database. For connection to MySQL, the server opens and click on Connect to IP. Figure A.10 .

Figure A.10: Connecting to the MySQL Server

Pablo Campos Avila

77

University of Cuenca
A.1.5. Fi Additional configuration for 915 MHz
Con fi gure the RN Module 8 Channels Since the Gateway Kit supports only eight channels, it should con fi gure the RN module to transmit on the same.
To do this, you click on the tab MAC Channel, the channels are dehabilitan and click on enable 8 channels. This ensures compatibility between the two devices as the default RN module supports up to 63 channels. Figure A.11 .

Figure A.11: Enabling eight channels in the RN module
Send a test message Uplink not con fi rmed The aim of this point is to visualize a module transmitted by the RN message Gateway. Tab LoRaWAN There is the communication window. one payload is placed in hexadecimal, a port 1 to 223 and click on transmit, as seen in Figure A.12 .

Pablo Campos Avila

78

University of Cuenca

Figure A.12: Sending a message from the RN Uplink Module
Change region Gateway
The Gateway It assumes by default that works with 868 MHz (Region 4), so it is necessary to fi gurarlo to 915 MHz (Region 0). In the Database Server tab, the units option is selected Gateway and click on Change Region Region until 0. Figure A.13 .

Figure A.13: Changing Gateway Region Thus, when the Gateway receives a valid packet, it will be on the Database tab.
A.2. Setting up the Node
As it noted in the description of equipment, or Mota Node allows control via ASCII commands. These commands are sent from the Raspberry Pi and were programmed in Python.
To automate and accelerate the process of sending packets, a physical button that allows you to send 10 packages DR0 and then the other 10 with DR3 was implemented. During the submission process, it remains on an LED, which serves as an indicator that the transmitter should be kept as stable as possible.
Then the programs implemented in the Raspberry Pi are described:

Pablo Campos Avila

79

University of Cuenca
Start program It is activated by ignition of the Raspberry Pi and allows continuous sensing the pulsating Shipping. Below is the code:

GPIO.setmode (GPIO.BCM) GPIO.setup (18, GPIO.IN, pull_up_down = GPIO.PUD_UP)
while True: input_state = GPIO.input (18) == False if input_state:
os.system ( '/ home / pi / lm.py') time.sleep (0.5)
os.system ( '/ home / pi / lm2.py') time.sleep (0.5)
Once it is detected that the button was pressed Shipping is run lm.py Y lm2.py which as will be explained below with DR0 packets sent and DR3 respectively. Sending messages
lm.py Y lm2.py Guran fi USB port for sending commands, the pin to turn on the LED, with different figure keys LoRaWAN , Activated by ABP , With the figure DR and sends numbered from 1 to 10 packages. Then the code used:

LedPin = 11

# pin11

BAUD_RATE = 57600
LoRaSerial class (object): def __init __ (self, _serial_port): '' ' configure serial connection '' '
self._ser = serial.Serial (_serial_port, BAUD_RATE)
# timeout block read self._ser.timeout = 8

Pablo Campos Avila

80

University of Cuenca
# Disable software flow control self._ser.xonxoff = False
# Disable hardware (RTS / CTS) flow control = False self._ser.rtscts
# Disable hardware (DSR / DTR) flow control = False self._ser.dsrdtr
# self._ser.writeTimeout for write timeout =0
# print "Resetting LoRa Tranceiver ..." self.write_command ( 'sys reset', False) # print "Configuring Tranceiver ..." # Mac Configuration self.write_command ( 'mac September devaddr 001AD314') self.write_command ( 'mac September appskey 3C8F262739BFE3B7BC0826991AD0504D') self.write_command ( 'mac September nwkskey 2B7E151628AED2A6ABF7158809CF4F3C') self.write_command ( 'mac September adr off') self.write_command ( 'sync mac September 34') self.write_command ( 'mac pwridx September 5 ') self.write_command (' mac September dr 0 ') self.write_command (' mac save ')

# Set sub-bands for ch in range (0.63):
self.write_command ( 'mac September ch status% d% s'% (ch, 'On' if ch in range (0.7) else 'off'))
# Join the network # print "Attempting to Join Network ..." self.write_command ( 'mac join ABP') response = self.read () if response == 'accepted':
print "LoRa Tranceiver Joined Configured (ABP)." else:
print "ERROR: mac Join returned unexpected response:" response

Pablo Campos Avila

81

University of Cuenca
def read (self): '' ' reads serial input '' '
self._ser.readline return (). strip ()
def write (self, str): '' ' writes out to serial connection string, returns response '' '
self._ser.write (str + "\ r \ n ') return self.read ()
def write_command (self, config_str, check_resp = True): '' ' writes out a command '' '
# print "Command: '% s'"% config_str response = self.write (config_str) if check_resp and response = 'ok'!:
print "Command: '% s'"% config_str print "Response: '% s'"% response
def send_message (self, data): '' ' SENDS a message to gateway '' '
# print "Sending message ..." # send packet (returns 'ok' Immediately) self.write_command ( 'mac tx uncnf 5% s'% data) # wait for success response message = self.read () if response == 'mac_tx_ok':
print "Message sent successfully!" else:
print "ERROR: tx mac command returned unexpected response:" response

Pablo Campos Avila

82

University of Cuenca
def receive_message (self): '' ' Waits for a message '' 'pass

if __name__ == "__main__"

port = '/ dev / ttyACM0' packets =

10

# Set indicator LED GPIO.setmode

(GPIO.BOARD)

# Numbers GPIOs by physical location

GPIO.setup (ledPin, GPIO.OUT) # set ledPin's mode is output

# Module Set loramote = LoRaSerial (port)

# Send Data GPIO.output (ledPin, GPIO.HIGH) for i in range (1, packets + 1):
loramote.send_message (i) time.sleep (1) GPIO.output (ledPin, GPIO.LOW) GPIO.cleanup ()

lm2.py It is exactly the same program with the difference that instead of DR0, DR3 used.

Pablo Campos Avila

83

University of Cuenca
Appendix B
Decrypted and Storage
This appendix presents the tools used to convert the .txt files captured with Wireshark in .csv files and decode fi cates transmission statistics.

Pablo Campos Avila

84

University of Cuenca
B.1. Decrypting Packages - LoRaWAN
The following code is based on the packet decoder LoRaWAN [ 46 ]. It is written in Javascript and provides a quick way to decrypt the payload of the packets, using Node.js and npm.
For the correct decryption is required for the session key application and network they can be found on the Microchip interface gateway.

# ! / Usr / bin / env node
"Use strict";
/ ** * LoRa Decrypt Code * Ucuenca
*/ var = lora_packet require ( '../ lib / index.js'); var cmdlineArgs = process.argv;
// Start var InputData = new Buffer (cmdlineArgs [2], 'base64'); var = lora_packet.fromWire packet (InputData); var AppSKey_hex = "3c8f262739bfe3b7bc0826991ad0504d"; var NwkSkey_hex = "2b7e151628aed2a6abf7158809cf4f3c"; var decrypted = lora_packet.decrypt (packet,
new Buffer (AppSKey_hex, 'hex'), new Buffer (NwkSkey_hex, 'hex')); // Output
console.log (decrypted)
To use it, from the console file name that is located in the directory you run directly: C: \ Users \ Pavil \ AppData \ Roaming \ npm \ node_modules \ Kemp-packet \ bin, followed by the payload in HEX format. For example:
Kemp-decrypt QBTTGgAAAwAFoM4Z08E =

Pablo Campos Avila

85

University of Cuenca
B.2. Decrypted and Storage
The code presented below was developed in python and its goal is to sort, decrypt, store and generate a total record of each measurement. Open files . txt captured in measurements, sorts, decrypted using the code Appendix B.1, separating and DR3 DR0, finally stores each transmission csv separate files.
At the end presents PER , Stockings RSSI , SNR In addition to standard deviations of each transmission in a .csv file.
# This script opens .txt files containing the # captures and creates .csv files and packages DR0 DR3 # In the end, it generates a file Total # Created by: Paul E. Avila C import csv import subprocess import statistics
# Directories of measurements and results path = 'D: \\ Users \\ \\ MEGA Pavil Data \\ \\ \\ LoRaTesis Captures \\ Medicion4' pathr = 'D: \\ Users \\ \\ MEGA Pavil Data \\ \\ \\ LoRaTesis Screenshot \\ \\ Medicion4 Conversions' npackets = 10
ncaptures = 152 RSSIAVEA = [0] * ncaptures RSSIAVEB = [0] * ncaptures SNRAVEA = [0] * ncaptures SNRAVEB = [0] * ncaptures DIST = [0] * PERSIAN ncaptures = [0] * ncaptures PERSB = [0] * ncaptures STDDEVRSSIA = [0] * ncaptures STDDEVRSSIB = [0] * ncaptures STDDEVSNRA = [0] * ncaptures STDDEVSNRB = [0] * ncaptures

for file in range (1 ncaptures + 1): # Name of file nfile = str (file) data = open (path + '\\' + nfile + '. txt', 'r'). read ()

Pablo Campos Avila

86

University of Cuenca
dataDic = {} = {} dataDicA dataDicB = {} # Index of values tmstp = [pos for post in range (len (data)) if data [pos.] startswith ( 'RTS')] chanp = [pos for post in range (len (data)) if data [pos] startswith. ( 'chan')] rfchp = [pos for post in range (len (data)) if data [pos] startswith ( 'RFCH')] freqp = [pos for post in range (len (data)) if data. [pos] startswith ( 'freq')] modup = [pos for post in range (len (data)) if data [pos].. startswith ( 'modu')] datrp = [pos for post in range (len (data)) if data [pos]. startswith ( 'DATR')] codrp = [pos for post in range (len (data)) if data [pos]. startswith ( 'CODR')] lsnrp = [pos for pos in range (len (data)) if data [pos]. startswith ( 'LSNR')] rssip = [pos for post in range (len (data)) if data [pos]. startswith ( 'RSSI' )] sizep = [pos for post in range (len (data)) if data [pos] startswith ( 'size')] datap =. [pos for post in range (len (data)) if data [pos] .startswith ( 'data')]
# Packet Number n = int (len (tmstp) / 2) # Extract data dataDic [0] = 'TMST', 'CHAN', 'RFCH', 'FREQ', 'MODU', 'DATR', 'CODR', 'LSNR', 'RSSI', 'size', 'DATA' dataDicA [ 0] = 'TMST', 'CHAN', 'RFCH', 'FREQ', 'MODU', 'DATR', 'CODR', 'LSNR', 'RSSI', 'size', 'DATA' dataDicB [0] = 'TMST', 'CHAN', 'RFCH', 'FREQ', 'MODU', 'DATR', 'CODR', 'LSNR', 'RSSI', 'size', 'DATA' for index in range (0 , n):
DATA = data [datap [index] +7: datap [index] +36] DATAB = DATA [0: DATA.index ( ' "')] DATAC = subprocess.check_output (Lora-decrypt '+ DATAB, shell = True) .decode (' utf-8 ') Backdate = DATAC [8: DATAC.index ( '>')] replace ( "", ""). dataDic [index + 1] = int (data [tmstp [index] +6: chanp [index] -2]), int (data [chanp [index] +6: rfchp [index] -2]) , int (data [rfchp [index] +6: freqp [index] -2]), float (data [freqp [index] +6: freqp [index] +16]), str (data [modup [index] +7 : datrp [index] -3]), str (data [datrp [index] +7: codrp [index] -3]), str (data [codrp [index] +7: lsnrp [index] -3]), float (data [lsnrp [index] +6: rssip [index] -2]), int (data [rssip [index] +6: sizep [index] -2]), int (data [sizep [index] +6 : datap [index] -2]), int (Backdate)
# Separo DRO and DR3

Pablo Campos Avila

87

University of Cuenca
i=1j =1
for index in range (0, n): dataDic line = [index + 1] if line [5] == "SF10BW125" dataDicA [i] = i + = 1 line else:
dataDicB [j] = j + = 1 line
# Not Received Data npacketsrecA = len (dataDicA) -1 npacketsrecB = len (dataDicB) -1
# Extract RSSI vector RSSIA = [0] * npacketsrecA RSSIB = [0] * npacketsrecB
for index in range (1 npacketsrecA + 1): dataDicA line = [index] RSSIA [index-1] = line [8]
for index in range (1 npacketsrecB + 1): dataDicB line = [index] RSSIB [index-1] = line [8]
# Extract SNR vectors SNRA = [0] * npacketsrecA SNRB = [0] * npacketsrecB
for index in range (1 npacketsrecA + 1): dataDicA line = [index] SNRA [index-1] = line [7]
for index in range (1 npacketsrecB + 1): dataDicB line = [index] SNRB [index-1] = line [7]
DIST [file - 1] = file * 10

Pablo Campos Avila

88

University of Cuenca
# Distance Vector
if len (dataDicA)> 1: #To avoid files without packages.
RSSIAVEA [file-1] = statistics.mean (RSSIA) SNRAVEA [file-1] = statistics.mean (SNRA) PERSIAN [file-1] = (npackets-npacketsrecA) / (npackets) if len (dataDicA)> 2: #STANDARDDEV need at least two values
STDDEVRSSIA [file-1] = statistics.stdev (RSSIA) STDDEVSNRA [file-1] = statistics.stdev (SNRA) # Guardo data in csv file w = csv.writer (open (pathr + '\\' + nfile + "A" + "w" newline = '') "csv.") for key, val in dataDicA.items ():
w.writerow (val)
if len (dataDicB)> 1: #To avoid files without packages. RSSIAVEB [file-1] = statistics.mean (RSSIB) SNRAVEB [file-1] = statistics.mean (SNRB) PERSB [file-1] = (npackets-npacketsrecB) / (npackets) if len (dataDicB)> 2: at least two #STANDARDDEV needs values
STDDEVRSSIB [file-1] = statistics.stdev (RSSIB) STDDEVSNRB [file-1] = statistics.stdev (SNRB) # Guardo data in the .csv file w = csv.writer (open (pathr + '\\' + nfile + "B" + "w" newline = '') "csv.") for key, val in dataDicB.items ():
w.writerow (val)
headers = [ 'Distance (m)', 'RSSI_DR0 (dBm)', 'SNR_DR0', 'STDEVRSSI_DR0', 'STDEVSNR_DR0', 'PER_DR0', 'RSSI_DR3 (dBm)', 'SNR_DR3', 'STDEVRSSI_DR3', 'STDEVSNR_DR3 ',' PER_DR3 ']
rows = zip (DIST, RSSIAVEA, SNRAVEA, STDDEVRSSIA, STDDEVSNRA persian RSSIAVEB, SNRAVEB, STDDEVRSSIB, STDDEVSNRB, PERSB) w = csv.writer (open (pathr + '\\' + 'Results' + '. csv', "w" newline = '')) w.writerow (headers) for row in rows:
w.writerow (row) print ( 'Decoding finished!')

Pablo Campos Avila

89

University of Cuenca Attachments in PDF file codes are presented in this section.

Pablo Campos Avila

90

University of Cuenca
Appendix C
RSSI measurements and SNR
This appendix is ​divided into two parts. In the first part C.1 , The graphs resulting from the present RSSI belonging to the four measurements. On the other hand, section C.2 The results are presented SNR measurements.

Pablo Campos Avila

91

University of Cuenca
C.1. RSSI measurements
four measurements in which 10 packets were transmitted for each data rate is performed. In each measurement transmissions were performed every 10 meters. Measurement 1 and 2 correspond to the urban environment, the third to the fourth semi-urban and rural. Then the means of each transmission are shown with their confidence intervals calculated with fi using the standard deviation and Student's t distribution.
RSSI DR0 in measurement 1

Figure C.1: Measurement Environmental RSSI 1 with DR0 - Rio Tomebamba DR3 in RSSI measurement 1

Pablo Campos Avila

92

University of Cuenca
Figure C.2: Measuring RSSI of Environment 1 with DR3 - Rio Tomebamba RSSI DR0 in Measurement 2

Figure C.3: Environment RSSI measurement 1 2 DR0 shore - Rio Tomebamba RSSI DR3 in Measurement 2

Pablo Campos Avila

93

University of Cuenca
Figure C.4: Environmental measurement RSSI 1, Shore 2 with DR3 - Rio Tomebamba RSSI DR0 in measurement 3

Figure C.5: Environmental RSSI measurement 2 DR0 - Rio Machángara RSSI DR3 in measurement 3

Pablo Campos Avila

94

University of Cuenca
Figure C.6: Measuring RSSI Environmental 2 DR3 - Machángara River RSSI DR0 in metering 4

Figure C.7: Measuring RSSI Atmosphere 3 with DR0 - Rio Yanuncay DR3 in RSSI Measurement 4

Pablo Campos Avila

95

University of Cuenca

Figure C.8: RSSI Measurement Atmosphere 3 with DR3 - Yanuncay River

C.2. SNR measurements
In each transmission, receiving more RSSI , Also received the SNR which it was stored and used to calculate the path loss and make the graphs shown below:

SNR DR0 in measurement 1

Pablo Campos Avila

96

University of Cuenca
Figure C.9: Measuring Environmental SNR 1 with DR0 - Rio Tomebamba SNR DR3 in measurement 1

Figure C.10: SNR Measurement Environment 1 with DR3 - Rio Tomebamba SNR DR0 in Measurement 2

Pablo Campos Avila

97

University of Cuenca
Figure C.11: Measuring SNR Environment 1 2 DR0 shore - Rio Tomebamba SNR DR3 in Measurement 2

Figure C.12: SNR Measurement Environment 1 Shore 2 with DR3 - Rio Tomebamba SNR DR0 in measurement 3

Pablo Campos Avila

98

University of Cuenca
Figure C.13: Measuring Environmental SNR 2 DR0 - Rio Machángara SNR DR3 in measurement 3

Figure C.14: SNR Measurement Environment 2 DR3 - Machángara River SNR DR0 in metering 4

Pablo Campos Avila

99

University of Cuenca
Figure C.15: Measuring SNR Atmosphere 3 with DR0 - Rio Yanuncay SNR DR3 in metering 4

Figure C.16: SNR measurement Environmental 3 with DR3 - Yanuncay River

Pablo Campos Avila

100

University of Cuenca

Bibliography
[1] Semtech, "Modulation LoRa Basics," num. May, pp. 1-26, 2015. [Online]. Available: http://www.semtech.com/images/datasheet/an1200.22.pdf
[2] M. Knight, "Decoding LoRa: Realizing to Modern LPWAN With SDR," Proceedings of the 6th Conference GNU Radio ,, 2016.
[3] L. Vangelista, A. Zanella, and M. Zorzi, "Long-range IoT technologies: The dawn of LoRATM " Lecture Notes of the Institute for Computer Sciences, Social-Informatics and Telecommunications Engineering,
LNICST, vol. 159, no. Fabulous, pp. 51-58, 2015. [4] NS Sornin, MS Luis, Eirich TI, TI Kramp, and OA Hersent, "LoRaWAN ™
Speci fi cation, "Semtech, Tech. Rep., 2015. [5] Microchip Technology Inc., "LoRa (R) Technology Evaluation Kit - 900 -. Dv164140-2" [In
line]. Available: http://www.microchip.com/DevelopmentTools/ProductDetails.aspx? Partno = dv164140-2
[6] Microchip, "LoRa Technology Gateway User's Guide," Microchip, Tech. Rep., 2016. [7] Microchip Technology Inc., "LoRa ® Mote User's Guide," Microchip, Tech. Rep., 2016 [8] Rpi Foundation, "Model B Raspberry Pi 3 - Raspberry Pi." [online]. Available:
https://www.raspberrypi.org/products/raspberry-pi-3-model-b/ .. [9] Microchip, "LoRa Technology Evaluation Suite User's Guide," Microchip Tech Rep, 2016. [10] A. Augustin, J. Yi, T. Clausen, and W. Townsley, "A Study of LoRa: Long Range & Low
Power Networks for the Internet of Things, " Sensors, vol. 16, num. 9, p. 1466, 2016. [Online]. Available: http://www.mdpi.com/1424-8220/16/9/1466
[11] MT Lazarescu, "Design of a WSN platform for long-term environmental monitoring for IoT applications " IEEE Journal on Selected Topics in Emerging and Circuits and Systems, vol. 3, no. 1, pp. 45-54, 2013.

Pablo Campos Avila

101

University of Cuenca
[12] F. Astudillo and A. Vazquez, "Implementation of wireless technologies to prediction system flow in the basin of river Tomebamba, "pp. 1-10 2016. [13] G. Chamorro, "Guide hidrometría of surface water," SENAMHI-Lima
Peru, 2008. [Online]. Available: http://www.senamhi.gob.pe/pdf/aprendiendohidrometria.pdf
[14] K. Mikhaylov, J. Petäjäjärvi, and T. Hanninen, "Analysis of Capacity and Scalability of the LoRa Low Power Wide Area Network Technology " European Wireless 2016, pp. 119-124, 2016.
[15] K. Mikhaylov, "On the Coverage of LPWANs: Evaluation and Channel Attenuation Range Model for LoRa Technology, "in ITS Telecommunications (ITST), 2015 14th International Conference on, 2016, pp. 55-59.
[16] RS Sinha, Y. Wei, and S.-H. Hwang, "A survey on LPWA technology: LoRa and NB-IoT, " ICT Express, vol. 3, no. 1, pp. 14-21, 2017. [Online]. Available: http://linkinghub.elsevier.com/retrieve/pii/S2405959517300061
[17] O. Georgiou and U. Raza, "Low Power Wide Area Network Analysis: Can LoRa Scale" Wireless IEEE Communications Letters, vol. 6, num. 2, pp. 162-165, 2017. [18] AJ Wixted, P. Kinnaird, H. Larijani, A. Tait,
A. Ahmadinia, and N. Strachan, "Evaluation of LoRa and LoRaWAN for wireless sensor networks, " Proceedings of IEEE Sensors, vol. 0, pp. 5-7, 2017.
[19] K. J. Petäjäjärvi and Mikhaylov, "Evaluation of LoRa LPWAN technology for remote health and wellbeing monitoring, "( ISMICT), 2016 10th. . . , 2016. [Online]. Available: http://ieeexplore.ieee.org/abstract/document/7498898/
[20] A. M. Aref and Sikora, "Free space range measurements With Semtech LoRa technology," 2014 2nd International Symposium on Wireless Systems Within the Conferences on Intel ligent Data Acquisition and Advanced Computing Systems, IDAACS-SWS 2014, num. September, pp. 19-23, 2014.
[21] M. Haghighi, Qin Z., D. Carboni, U. Adeel, F. Shi, and JA McCann, "Game theoretic and auction-based algorithms in LPWA towards opportunistic communications networks LoRa " 2016 IEEE 3rd World Forum on Internet of Things, IoT WF-2016, pp. 735-740, 2017.
[22] L. Gregora, Vojtech L. and M. Neruda, "Propagation of Signal Indoor LoRa Technology," 2016 17th International Conference on Mechatronics - Mechatronika (ME), pp. 13-16 2016.
[23] J. So, D. Kim, H. Kim, H. Lee, and S. Park, "LoRaCloud: LoRa platform on OpenStack," NETSOFT IEEE 2016 - 2016 IEEE NetSoft Conference and Workshops: Software-De fi ned for Infrastructure Networks, Clouds, IoT and Services, pp. 431-434, 2016.

Pablo Campos Avila

102

University of Cuenca
[24] Iswandi, HT Nastiti, IE Praditya, and IW Mustika, "Evaluation of XBee-Pro transrange mission for Wireless Sensor Network's node based on under forested environments Received Signal Strength
Indicator (RSSI), " Proceedings - 2016 2nd International Conference on Science and Technology-Computer, ICST 2016, pp. 56-60, 2017. [25] T. V. Harvanova and Krajcovic, "Implementing ZigBee network in forest regions - considered
rations, modeling and evaluations, " 2011 International Conference on Applied Electronics, pp. 1-4 2011. [26] A. Palaios, KN ​Singh, and M. Petri, "Propagation Models for Users Crossing Forest Areas in Central European Forest Environments, " Waveforms IEEE Signal Processing and Propagation, pp. 14-19, 2016. [27] and MC IF Akyildiz Vuran, Wireless Sensor Networks, 2010.

[28] R. Soltani, B. Bash, D. Goeckel, S. Guha, and D. Towsley, "Covert single-hop communication

With a wireless network in distributed artificial noise generation, "in 2014 52nd Annual Allerton Conference on

Communication, Control, and Computing (Al lerton).

IEEE, Sep

2014, pp. 1078-1085. [Online]. Available: http://ieeexplore.ieee.org/document/7028575/

[29] Wireless Personal Area Network (WPAN) Working Group, "IEEE 802.15.4 IEEE Standard for Low-Rate Wireless Networks. "[Online]. Available: https: //standards.ieee.org/ fi ndstds / standard / 802.15.4-2015.html

[30] P. Baronti, P. Pillai, V. Chook, Chessa S., and A. Gotta, "A survey on the state of the art and the 802.15.4 and ZigBee standards, " Computer Communications, 2007.

[31] I. Bluetooth SIG, "Bluetooth Core Speci fi cation 5.0." [Online]. Available: http://www.mouser.com/pdfdocs/bluetooth-5-faq.pdf

[32] E. Khorov, A. Lyakhov, Krotov A., and A. Guschin, "A survey on ah IEEE 802.11: An enabling networking technology for smart cities, " Computer Communications, 2015. [Online]. Available: http://www.sciencedirect.com/science/article/p

[33] M. Centenaro, L. Vangelista, A. Zanella, and M. Zorzi, "Long-range communications in unlicensed bands: the rising stars in the IoT and smart city scenarios, " IEEE Wireless Communications, vol. 23, no. 5, pp. 60-67, October 2016. [Online]. Available: http://ieeexplore.ieee.org/document/7721743/
[34] J. Bardyn, T. Melly, and O. Seller, "IoT: The era of LPWAN is now starting," European Solid-State, 2016. [Online]. Available: http://ieeexplore.ieee.org/abstract/document/ 7598235 /

[35] M. Bor and Roedig U., "Selection LoRa Transmission Parameter," Proceedings of the 13th IEEE International, 2017. [Online]. Available: http://www.research.lancs.ac.uk/ portal / services / downloadRegister / 164374357 / Kemp {_} {_} r1342.pdf tps

Pablo Campos Avila

103

University of Cuenca
[36] M. Bor, J. Vidler, and U. Roedig, "LoRa for the Internet of Things" Proceedings of the 2016 International Conference on Embedded Systems and Wireless Networks, pp. 361-366, 2016. [37] P. Neumann, J.
Montavont, and T. Noël, "Indoor deployment of low-power wide area networks (LPWAN): A case study LoRaWAN, " Wireless and Mobile, 2016. [Online]. Available: http://ieeexplore.ieee.org/abstract/document/7763213/

[38] A. C. Bose and Foh, "A practical path loss model for indoor positioning WiFi enhancement, "& Signal Processing, 2007 6th International. . . , 2007. [Online]. Available: http://ieeexplore.ieee.org/abstract/document/4449717/

[39] SM Chung, Kim KT, J. Song, HY and Youn, "Enhancing node connectivity by utilizing RSSI for ZigBee-based WSN " 2016 International Conference on Information and Communication Technology
Convergence, ICTC 2016, pp. 555-560, 2016. [40] J. Zheng, C. Wu, H. Chu, and Y. Xu, "An improved RSSI measurement in wireless sensor
Networks " Engineering came, vol. 15, pp. 876-880, 2011. [Online]. Available: http://dx.doi.org/10.1016/j.proeng.2011.08.162 [41] T. Rama Rao, D. Balachander, A. Nanda Kiran, and Oscar S., "RF propagation measurements in forest & plantation environments for Wireless Sensor Networks, " International Conference on Recent Trends in Information Technology, ICRTIT 2012, pp. 308-313, 2012. [42] DH Kim and JY Lim, "Using Wi-Fi and LoRa" Ieee 2016, pp. 1-3, 2016. [43] T. Petrić, M. Goessens, Nu'aymi L., L. Toutain, and A. Pelov, "Measurements, performance
and analysis of LoRa FABIAN, real-world implementation of LPWAN " IEEE International Symposium on Personal, Indoor and Mobile Radio Communications, PIMRC, pp. 1-7 2016.

[44] W. Lee, "Local Estimate of average power of a mobile wireless signal," IEEE Transactions on Vehicular Technology, 1985. [Online]. Available: http://ieeexplore.ieee.org/abstract/ document / 1623289 /

[45] L. Alliance, "LoRaWAN ™ 1.0.2 Regional Parameters," Microchip Tech. Rep., 2017. [46] Anthonykirby,

"LoRaWAN

packet

Decoder. "

[In

line].

dis-

wearable:

https://lorawan-packet-decoder-0ta6puiniaut.runkit.sh/?data=

QBTTGgCAAAAFTmIoiUo6uQ {%} {%} 3D 3D

[47] W. Mendenhall, R. Beaver, and B. Beaver, "Introduction to probability and statistics,"

International Thomson Publishing ,, p. 780, 2010.

[Online]. Available: http: //

investigadores.cide.edu/aparicio/data/refs/Mendenhall{_}Prob{_}Estadistica{_}13.pdf

[48] ​AL Webster, Statistics for Business, McGraw-Hill, Bogotá Ed. McGrawHill, 2000.

Pablo Campos Avila

104

University of Cuenca
[49] Microchip, "RN2903 Datasheet," Microchip, Tech. Rep., 2017. [50] T. Helmenstine, "Calculate Error Percent." [Online]. Available: https: // sciencenotes.
org / calculate-percent-Error /

Pablo Campos Avila

105

