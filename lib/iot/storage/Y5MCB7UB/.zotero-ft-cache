WUR-MAC: Energy efficient Wakeup Receiver based MAC Protocol
S. Mahlknecht, M. Spinola Durante
Institute of Computer Technology Vienna University of Technology
Vienna, Austria {mahlknecht,spinola}@ict.tuwien.ac.at
Abstract: This paper discusses WUR-MAC, a medium-access control (MAC) protocol suited for wireless nodes equipped with a Wakeup Receiver (WUR). Unlike other protocols, the WUR-MAC takes advantage of the WUR ultra-low power listening mode leaving it permanently active to wait for incoming requests. Due to the ultra low power nature of these radio receivers, energy consumption and latency can be optimized at the same time. Energy consumption of the combined physical and MAC layer of a WUR based design is compared to efficient schedule based low power MAC protocols using the same main underlying transceiver without a wakeup radio receiver. WUR-MAC is based on proven MAC concepts but avoids complicated algorithms that are needed to synchronize nodes in traditional WSNs. Simulation results show that with typically low traffic, the average power consumption of schedule-based MACs is significantly higher than by using WUR-MAC only in the case where very low power Wakeup Receivers (<40 µW always on) are used. Delay is improved in any case due to the always on nature of the Wakeup Receiver.
Keywords: Wireless Sensor Networks; Wireless Mobile Ad-hoc Networks; Ultra-Low-Power MAC protocol; Wakeup Receiver

1. INTRODUCTION
A large number of MAC protocols have been proposed in recent years taking into consideration an underlying radio hardware which is found in state of the art sensor nodes like ZigBee compliant solutions.
A wakeup receiver (WUR) not found in commercial products so far, is a very low power radio receiver used in wireless sensor networks (WSN) to detect an incoming wireless wakeup request that activates the node upon an address match. In this way network latency is reduced, without sacrificing energy consumption as this is the case with state of the art receivers that have to be periodically turned on in order to listen to the channel. The WUR is typically always on, so it can detect an incoming wakeup signal at any time. The concept of a wakeup receiver has first been proposed in 2001 by Rabaey at al. [1] and real world chip implementations have only been reported in 2007 [2] and in 2008 [3] at UC Berkeley. The papers show that the always-on power consumption is in the order of 50-100 µW. In our department at the Vienna University of Technology a wakeup receiver has been developed within the PAWIS [4] project and the current results (still to be published) show that even lower power consumption figures at a reasonable sensitivity are possible. WUR-MAC is designed with these receiver capabilities in mind.

sleep

Main

serial bus Transceiver

CPU

interrupt

Wakeup

channel free serial bus

Receiver

Fig. 1. Node Architecture
More powerful radio receivers (in terms of bandwidth, robustness, frequency selectivity etc.) used in the 2.4 GHz ISM band have power consumptions figures of typically 1040 mW in receive or transmit mode (0 dBm). For this reason all WSN MAC protocols try to reduce energy consumption by introducing sleep modes for the transceiver and strategies to reduce power consumption based on efficient synchronization methods. All of these MAC protocols trade energy for delay, which for many applications may cause unacceptable delays. WUR-MAC which relies on the novel dual radio implementation (wakeup and main radio) of the physical layer, can overcome this limitation by providing energy efficiency and low latency at the same time. At our best knowledge no MAC protocol has been analyzed and mapped to an underlying real world hardware containing a combination of a main transceiver and a WUR.

2. MAC PROTOCOLS PROBLEM ANALYSIS
The main idea many low-power MAC protocols have in common is the idea of synchronizing the clocks of the nodes and then using a defined schedule to start the communication.
In low traffic multi-hop sensor networks the receiver of a sensor node should be turned off most of the time to save energy. However, to be contacted by a neighboring node, the receiver must be turned on. Existing solutions try to solve this problem by different means of synchronization using methods such as preamble sampling, or scheduled wakeups with periodic synchronizations, and trading off delay for power consumption. A node reduces its power consumption by activating the main transceiver periodically with a low duty cycle, such that the power consumption of the transceiver is reduced by the factor Ton/Tperiod. Using low duty cycles results in power consumption approximating to the value in inactive mode that can be around 10 µW in transceivers such as the CC2400 [6]. We have analyzed many of the low level communication protocols and found that MAC protocols greatly affect the overall power consumption of a sensor node and need to be tuned to the underlying physical layer in order to achieve greatest energy savings [5]. One main drawback of current MAC protocols (among those mentioned in the preceding sections) is that the idle listening power can be arbitrarily lowered for the sake of hop-to-hop delay that increases linearly with the lowering of the duty cycle. Considering applications such as environmental monitoring or building automation, where hundreds of nodes are deployed over a large area, the communication to a sink node has a possibly high hop-count. Traditional MAC would set the wake-up timer to several seconds, hypothetically prolonging node life to several years, but the hop-to-hop delay would grow unacceptably and a lot of energy would be needed for the synchronization.
Analyzing the idle listening problem in more detail, there are two main energy wasting factors that have to be optimized. The first factor, at the receiving side, is the waste of energy by periodic listening. This is a strategy widely used in energy efficient MAC protocols. Second, the energy wasted on the transmitter when trying to hit a receiver’s on-window. In most cases, the receiver is not perfectly synchronized to the neighboring node; this is especially true for low duty cycle data, where transmissions between neighboring nodes occur rarely. The consequence is that even though a best estimate of the receivers on time is taken, the sender needs to anticipate the transmission in order to hit the receiver’s window. This leads to additional energy wasted especially when clocks are not very accurate or time between transmissions are very long.
An ultra low power and distributed access protocol has been proposed by Zhong et. al [1] in the PicoRadio project. To reach ultra low power consumption, the waste of energy due to idle listening is solved by switching off the main radio when not receiving, or transmitting, and implementing a second very low bit rate "wakeup radio" that is running at 100 % duty cycle, and expected to consume only 1 µW of power, however this power consumption figure did not prove to be feasible so far. The wakeup radio listens to the wakeup

messages and turns on the main receiver only when required. The publication does not provide information on estimated power consumption of sensor nodes. The WUR-MAC is based on the same multi-channel principle but avoids CSMA access strategy by using the information provided from the WUR RTS/CTS packets.
An alternative approach using two radios is used by the Sparse Topology and Energy Management (STEM, [9]) technique, which was proposed by Schugers et al. in 2002. As in duty cycled MAC protocols, the receiver periodically listens to the channel, but in addition, the wake-up phase and the transfer phase are decoupled through the use of two separate radios to reduce the interference problem of aggressive wake-up. However both radios are high power radios and power consumption is not reduced.
The IEEE 802.15.4 standard [8] describes a MAC and a physical (PHY) layer for wireless sensor networks. In a multi-hop environment, the physical+MAC combination is not as energy efficient as compared the protocols using higher bit-rate transceivers and better synchronization techniques such as [7,8] to name only a few of them.
The CSMA-MPS protocol [7] developed at our department tries to capture inefficiencies found in the above mentioned protocols and to rely on a more efficient underlying radio transceiver. CSMA-MPS is optimized for low energy consumption by a very efficient wakeup mechanism stopping the preamble transmission if not synchronized as soon as the receive window is hit. This is done by alternating transmits and receives during the preamble and allows shorter wakeup times if nodes are not synchronized any more. Another difference to previous proposals and related to power consumption is the use of radio transceivers with a high over the air bit rate of 1 Mbps and short transmit and receive turnaround times. This enables the proposed protocol to operate much more efficiently as compared to low to medium bit-rate transceivers used in traditional sensor networks. Comparison to WUR-MAC will therefore be done with CSMA-MPS as one typical candidate among a number of very energy efficient MAC proposals, which due to the sheer number cannot be discussed here.
3. WUR BASED MAC APPROACH
Taking advantage of the latest research results in WUR hardware, the proposed protocol is energy efficient only by using a very low power WUR receiver which basically reduces idle listening of the main transceiver to a minimum avoiding any synchronization of main transmitter and receiver by the always on nature of the WUR. The main idea is to use the WUR channel to signalize channel reservation (i.e. RTS/CTS mechanism) and the main transceiver only for data, resulting in much better bandwidth usage of the main transceiver (and hence less collisions) that is active only when it is necessarily needed, i.e. when communication occurs. This mechanism can be seen as a remote control to activate the main transceiver on a remote node. The WURMAC send operation acts in different ways based on the destination address which can be of a particular node or a broadcasted packet. Both point-to-point and broadcast

communications have the channel access (CA) strategy in common. This strategy is completely based on the WUR and avoids using the main transceiver as carrier sense channel, that is as power consuming as normal receive operation. The CA therefore realizes a virtual carrier sense used to prevent packet collision. Figure 2 shows the different activity of the WUR and main transceiver of two nodes involved in communication.
3.1 Wakeup Frame Format
The wakeup procedure consists of a RTS/CTS packet exchange on the wakeup channel which has its own frame format of Logical Link Layer (LLC) not used for data exchange purposes. The Idle mode refers to the low power listening mode of the WUR while for the main transceiver it denotes a lower power state not transmitting or receiving but with the oscillator still turned on. During sleep mode also the oscillator is turned off and the transceiver consumes virtually no power. CA is the channel access slot which determines if the wakeup channel is free.

3.2 Channel access strategy
The WUR-MAC has to check if the wakeup channel is free before starting a wakeup. The channel free (CF) status information is made available by the WUR on a continuous basis and is asserted (high) as long as it has not detected an incoming preamble of a wakeup packet. The channel is free only if CF is asserted for at least Tunc only then a request-tosend (RTS) packet is sent after some random time. If the CF bit is deasserted at anytime when it is read, the WUR-MAC waits for the fixed packet duration (Tpre+Twpd+Tdec) and then checks the again the bit until it is asserted. Each RTS packet contains information at which main transceiver’s channel communication is proposed. The destination node answers with a definitive channel, which is either the proposed, or another one chosen randomly between a subgroup of available channels (See details in Section 3.5). This causes the main transceiver of the nodes to turn on at the given channel for data communication. This information is only needed for multichannel main transceivers (i.e. IEEE802.15.4, IEEE802.15.1) and reduces the probability of collisions to a minimum so that direct access to the channel can be started without any further CSMA protocol.

3.3 Point-to-point communication

For a known destination, the source will transmit a WUR RTS packet that contains the non broadcast destination address after the CA was successful. The destination, which is in sleep mode (or any other mode that does not use the main radio), reacts on interrupt if the address in the WUR packet matches its own or the broadcast. The WUR packet does not contain the source address therefore the destination sends a clear-to-send (CTS) with its own address as destination. After the previous RTS, the source’s WUR has been programmed to react on the address of the destination. If

Fig. 2. Transceivers and WUR states during point-to-point communication
The reason why an RTS-CTS is implemented on the WUR channel is for channel selection purposes, as it is explained in the next paragraphs.

Fig. 3. . WUR Frame Format for RTS and CTS

The RTS/CTS frame format is composed of a preamble, an address, a channel information for the main transceiver (if multiple channels are available), and some forward error correction (FEC) as shown in Figure 3.

Fig. 4. Message Sequence Chart (MSC)
the CTS is received within a timeout, the source starts to send the data packet on the main channel without any further delay. After this the roles are inverted and the destination sends an immediate Ack only or piggyback data and Ack to

the source (e.g. when the source node inquires the temperature of the destination node). Information of additional data to be exchanged is included in the header so that the communicating nodes keep the main transceiver on as long as needed in order to avoid a wakeup messages after each data packet exchange.
3.4 Broadcast communication

130 nm CMOS process and the estimated values for the digital part if realized in the same technology. Currently the digital part is implemented on an external FPGA.
Table 1. Electrical Parameters
CC2400 WUR

When a node issues a broadcast and hence all nodes shall receive it, the protocol is simpler because no CTS packets are expected to be received from the source. After successful channel access, the source sends a WUR RTS with broadcast destination and then sends the data packet via the main channel as indicated in the wakeup packet. All destination nodes that receive the WUR packet activate the main transceiver in receive mode and wait until timeout for an incoming packet.

Supply Voltage 1.8 V

1.5 V

Irx

23 mA 7 µA

I tx

19 mA -

Isleep

1.5 µA -

RF frequency 2.40 - 2.48 GHz

Data rate

1 Mbps 100 kbps

3.5 Channel Assignment and Collisions
The RTS/CTS handshake with channel assignment prevents collisions on the main channel. When only a low number of channels are available, collisions are still likely during a burst or high load. Instead of using a carrier sense mechanism on the main channel we propose to make use of recent information from the wakeup receiver to avoid picking a channel already in use. The node sending an RTS packet has the information of which main channel was used by a neighboring node during the last communication by reading it from the WUR which captures each incoming RTS/CTS packet. The appropriate channel is then chosen randomly between the remaining channels Due to the hidden node problem, this still does not mean the channel is also a good choice for the receiving node. The node sending a CTS packet can confirm the channel proposed in the RTS packet or propose a new one using the same strategy to choose a channel as the sender of the RTS packet. There is still the probability that this alternative proposal does cause a possible collision on the sender side, but in order to avoid another handshake the sender may simply delay communication on the main channel in the rare case the alternative channel picked in the CTS packet may cause potential collisions at the sender.
4. CASE STUDY
The following case study compares an advanced scheduling MAC protocol such as CSMA-MPS [7] to the WUR-MAC. The case study compares only CSMA-MPS as this protocol is already compared to other efficient MAC Protocols in [5, 10] As reference for the main channel of the physical layer TI’s CC2400 is taken. It is a good reference as it reflects a multichannel very agile low power transceiver with high bit rate reducing on time to a minimum.
The key parameters of this transceiver and the WUR developed at our department are summarized in the preceding table. The current supply of the WUR (7µA) is the sum of measured values of the analog WUR implementation on a

The simulation is done evaluating the power consumption of a single node when receiving/transmitting at the defined rate on the horizontal axis. As the duty cycle and the overall bandwidth utilization is very low (also due to the agile multichannel 1Mbps transceiver) neighboring nodes do not significantly affect the overall simulation results The simulation computes the average power consumption (Pavg) in relation to the number of messages forwarded and newly introduced into the network for a given time period. The ratio of forwarding and self-generated packets has been fixed to 10:1. The data rate for RTS/CTS is chosen to be 100 kbps reflecting the actual capability of WUR receivers of current research projects. The length of the overall wakeup frame (RTS and CTS) is set to 88 bits and the length of the data packet is set to 32 bit preamble plus 80 bits of data at 1 Mbps. The power consumption of the WUR-MAC is the sum of a constant base (the sleep power of the CC2400 and the power of the WUR in active mode) and the power needed for communication. The calculations take into account the raw send and receive times, but also the times needed to start and change mode of the transceiver. The CSMA-MPS has a fixed duty cycle and wakes up periodically by Tw. For each wakeup only one packet can be sent or received limiting the maximum data throughput. Because synchronization takes into account the worst-case clock drift, CSMA-MPS consumes more transmit energy because the preamble length is calculated using a longer window depending on the time elapsed from the last communication.
CSMA-MPS performs better when frequently communicating because it can count on the implicit synchronization and does not need energy for RTS/CTS handshake. However collisions are not simulated as typical very low data rate is assumed, however collisions increase when the packet rate reaches an order of 1/Tw. In contrast WUR-MAC gets into significant collisions only at even higher data rate as the wakeup channel is a 100% ON channel accepting requests at any time. At typical low bandwidth communication, delay for WUR-MAC is closely related to length of the communication (RTS/CTS, Data/Ack), whereas a scheduling MAC is bound to the wakeup period (Tw),

which is one or two orders of magnitude longer if significant savings in energy are to be achieved. For instance Tw= 500ms the average delay when not synchronized in CSMA-MPS is 250ms whereas for WUR-MAC at the above given packet sizes is about 6ms.

implemented in an FPGA as one component of a smart transceiver platform developed in the course of the EU Funded Project Chosen.
REFERENCES

.
10,0E-3
Pave (W)
1,0E-3

WUR-MAC CSMA-MPS Tw=100ms CSMA-MPS Tw=500ms CSMA-MPS Tw=1000ms

1 L. C. Zhong, R. Shah, C. Guo, and J. Rabaey, An Ultra-Low Power And Distributed Access Protocol For Broadband Wireless Sensor Networks , IEEE Broadband Wireless Summit, Las Vegas, May 2001
2 N. Pletcher, et al., A 65µW, 1.9 GHz RF to Digital Baseband Wakeup Receiver for Wireless Sensor Nodes, Proc. IEEE Custom Integrated Circuits Conference, pp. 539-542, Sept. 2007.

100,0E-6

3 N. Pletcher, S. Gambini, Jan M. Rabaey, A 2GHz 52µW Wake-Up Receiver with -72dBm Sensitivity Using Uncertain-IF Architecture, Conference Proceedings, IEEE International Solid-State Circuits Conference, February 2008, San Francisco, CA.

10,0E-6 |packet/day |packet/hour

|packet/minute

10,0E-6 100,0E-6 1,0E-3 10,0E-3 100,0E-3

Fig. 5. Average power consumption

1,0E+0 Pa1c0k,e0tEs+/0s

As can be seen in Fig. 5 the lower power consumption is achieved only when the Wakeup Radio hardware has power consumption lower than 40 µW for networks that can tolerate about 1 s hop-to-hop delay. When delay shall not exceed 100 ms the Wakeup Radio can consume up to 300 µW still being lower power than CSMA-MPS without Wakeup radio. When the packet rate increases and reaches more than one packet per second, the power consumption of the WUR architecture reaches the one of the CSMA-MPS as the RTS/CTS overhead becomes more visible in WUR-MAC. At the same time the better synchronization of the CSMA-MPS lowers the energy overhead for communication establishment.

5. CONCLUSION
WUR-MAC has been designed to reflect the new physical layer topology and tries to efficiently map MAC functionality to the hardware. As in any MAC protocol, the energy efficiency can only be considered together with underlying radio hardware. Based on state of the art power consumption figures it proves to achieve lower power consumption for sensor networks with low data throughput avoiding any synchronization and schedule based duty cycling of the main transceiver, making the communication protocol more applicable. Furthermore low hop-to-hop delay and high bandwidth availability is realized without raising the overall average power consumption. For now WUR-MAC can only be employed in networks with fairly short point-to-point range as the wakeup radio sensitivity cannot compete with the main radio sensitivity, but there are a number of applications where range requirements are only of a few meters, making WUR-MAC together with an appropriate WUR receiver applicable. In the future WUR-MAC will be

4 S. Mahlknecht, J. Glaser, T. Herndl, PAWiS: towards a power aware system architecture for a soc/sip wireless sensor and actor node implementation, 6th IFAC International Conference on Fieldbus Systems and their Applications
5 S. Mahlknecht, Energy-Self-Sufficient Wireless Sensor Networks for Home and Building Environment, Institute of Computer Technology, Vienna University of Technology, Dissertation, 2004
6 Texas Instruments, CC2400: Low-Cost and LowPower Single-Chip 2.4 GHz ISM Band Transceiver with Extensive Hardware Features, Available: http://focus.ti.com/docs/prod/folders/print/cc2400.ht ml
7 S. Mahlknecht, M. Böck: CSMA-MPS: A Minimum Preamble Sampling MAC Protocol for Low Power Wireless Sensor Networks; IEEE International Workshop on Factory Communication Systems (WFCS2004), Wien; in Proceedings pp. 73 - 80.
8 Standard for part 15.4: Wireless medium access control (MAC) and physical layer (PHY) specifications for low rate wireless personal area networks (WPAN), IEEE Std 802.15.4, IEEE, New York, NY, 2003
9 Curt Schurgers, Valsios Tsiatsis, Saurabh ganeriwal, Mani Sirvastava, “Optimizing sensor networks in the Energy-Latency-Density Design Space”, IEEE Transactions on mobile computing, Vol. 1 No. 1, Jan 2002.
10 C. Tonsing: Energy-Efficient MAC Protocol for WSN, Master Dissertation, University of Pretoria, Faculty of Engineering, Built Environment and Information Technology, 2008.

